<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Emacs on Microsoft Windows</title>
<!-- 2017-01-20 sex 22:45 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="description" content="Emacs programming and customization."
 />
<meta  name="keywords" content="emacs, shell, eshell, windows, microsoft, cmd.exe" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link href="theme/style2.css" rel="stylesheet">

<script type="text/javascript" src="theme/org-info.js">
/**
 *
 * @source: theme/org-info.js
 *
 * @licstart  The following is the entire license notice for the
 *  JavaScript code in theme/org-info.js.
 *
 * Copyright (C) 2012-2013 Free Software Foundation, Inc.
 *
 *
 * The JavaScript code in this tag is free software: you can
 * redistribute it and/or modify it under the terms of the GNU
 * General Public License (GNU GPL) as published by the Free Software
 * Foundation, either version 3 of the License, or (at your option)
 * any later version.  The code is distributed WITHOUT ANY WARRANTY;
 * without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.
 *
 * As additional permission under GNU GPL version 3 section 7, you
 * may distribute non-source (e.g., minimized or compacted) forms of
 * that code without the copy of the GNU GPL normally required by
 * section 4, provided you include this license notice and a URL
 * through which recipients can access the Corresponding Source.
 *
 * @licend  The above is the entire license notice
 * for the JavaScript code in theme/org-info.js.
 *
 */
</script>

<script type="text/javascript">

/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/

<!--/*--><![CDATA[/*><!--*/
org_html_manager.set("TOC_DEPTH", "3");
org_html_manager.set("LINK_HOME", "");
org_html_manager.set("LINK_UP", "");
org_html_manager.set("LOCAL_TOC", "1");
org_html_manager.set("VIEW_BUTTONS", "0");
org_html_manager.set("MOUSE_HINT", "underline");
org_html_manager.set("FIXED_TOC", "0");
org_html_manager.set("TOC", "1");
org_html_manager.set("VIEW", "showall");
org_html_manager.setup();  // activate after the parameters are set
/*]]>*///-->
</script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/javascript" src="http://orgmode.org/mathjax/MathJax.js"></script>
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
    MathJax.Hub.Config({
        // Only one of the two following lines, depending on user settings
        // First allows browser-native MathML display, second forces HTML/CSS
        //  config: ["MMLorHTML.js"], jax: ["input/TeX"],
            jax: ["input/TeX", "output/HTML-CSS"],
        extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js",
                     "TeX/noUndefined.js"],
        tex2jax: {
            inlineMath: [ ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"], ["\\begin{displaymath}","\\end{displaymath}"] ],
            skipTags: ["script","noscript","style","textarea","pre","code"],
            ignoreClass: "tex2jax_ignore",
            processEscapes: false,
            processEnvironments: true,
            preview: "TeX"
        },
        showProcessingMessages: true,
        displayAlign: "center",
        displayIndent: "2em",

        "HTML-CSS": {
             scale: 100,
             availableFonts: ["STIX","TeX"],
             preferredFont: "TeX",
             webFont: "TeX",
             imageFont: "TeX",
             showMathMenu: true,
        },
        MMLorHTML: {
             prefer: {
                 MSIE:    "MML",
                 Firefox: "MML",
                 Opera:   "HTML",
                 other:   "HTML"
             }
        }
    });
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Emacs on Microsoft Windows</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. Emacs on Microsoft Windows</a>
<ul>
<li><a href="#sec-1-1">1.1. Overview</a></li>
<li><a href="#sec-1-2">1.2. Getting Emacs and Useful tools</a>
<ul>
<li><a href="#sec-1-2-1">1.2.1. Getting Emacs</a></li>
<li><a href="#sec-1-2-2">1.2.2. Getting Unix utilities</a></li>
</ul>
</li>
<li><a href="#sec-1-3">1.3. Set Environments Variables</a>
<ul>
<li><a href="#sec-1-3-1">1.3.1. Set HOME</a></li>
<li><a href="#sec-1-3-2">1.3.2. Set PATH</a></li>
</ul>
</li>
<li><a href="#sec-1-4">1.4. Unix utilities</a></li>
<li><a href="#sec-1-5">1.5. Environment Variables in Emacs</a></li>
<li><a href="#sec-1-6">1.6. Eshell</a>
<ul>
<li><a href="#sec-1-6-1">1.6.1. Overview</a></li>
<li><a href="#sec-1-6-2">1.6.2. Screenshots</a></li>
<li><a href="#sec-1-6-3">1.6.3. Demonstrations</a></li>
</ul>
</li>
<li><a href="#sec-1-7">1.7. Powershell</a></li>
</ul>
</li>
</ul>
</div>
</div>
<a href="index.html">Top</a>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Emacs on Microsoft Windows</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> Overview</h3>
<div class="outline-text-3" id="text-1-1">
<p>
<b>Why Emacs ?</b> 
</p>

<p>
Emacs provides many useful tools for Windows developers or anyone that
have to use Windows for professional reasons or use Windows at work
such as:
</p>

<ul class="org-ul">
<li><span class="underline">Powerful terminal emulator</span>: Emacs can be a powerful terminal
emulator for Windows and a outstanding replacement for cmd.exe
terminal emulator because it has history, multi line history and
multi line input and tiling windows where it is possible to split
the Emacs window and run a repl and edit a file on the same
window. Unlike cmd.exe Emacs can also run multiple REPLs in the
same window.
</li>

<li><span class="underline">Run any shell</span>: Emacs can run any shell application like Python,
IPython, Powershell, cmd.exe, bash, C# shell, F# and so on.
</li>

<li><span class="underline">Eshell</span>: Eshell is unix-like shell implemented in Elisp providing
many unix commands like ls, mv, cp, rm without any external
dependencies and it is also highly integrated to Emacs allowing the
user to call elisp functions, browser directories, open files
(visit buffer).
</li>

<li><span class="underline">Dired mode</span>: Dired mode allows fast directory navigation and to
run commands or apply shell commands on files like md5sum, rm -rf,
git add and so on.
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2"><span class="section-number-3">1.2</span> Getting Emacs and Useful tools</h3>
<div class="outline-text-3" id="text-1-2">
</div><div id="outline-container-sec-1-2-1" class="outline-4">
<h4 id="sec-1-2-1"><span class="section-number-4">1.2.1</span> Getting Emacs</h4>
<div class="outline-text-4" id="text-1-2-1">
<p>
Emacs 32 bits
</p>

<ul class="org-ul">
<li><a href="https://ftp.gnu.org/gnu/emacs/windows/">https://ftp.gnu.org/gnu/emacs/windows/</a>
</li>
</ul>

<p>
Emacs 64 bits - 64-Bit GNU Emacs for MS Windows with optimization. 
</p>

<ul class="org-ul">
<li><a href="https://sourceforge.net/projects/emacsbinw64/">https://sourceforge.net/projects/emacsbinw64/</a>
</li>
</ul>

<p>
Install using Chocolately Package Manager 
</p>

<ul class="org-ul">
<li><a href="https://chocolatey.org/packages?q=emacs">https://chocolatey.org/packages?q=emacs</a> 
</li>
</ul>

<p>
Emacs 64 bits unnoficial
</p>

<ul class="org-ul">
<li><a href="https://chocolatey.org/packages/emacs64">https://chocolatey.org/packages/emacs64</a>
</li>
</ul>

<div class="org-src-container">

<pre class="src src-sh">choco install emacs64
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-2-2" class="outline-4">
<h4 id="sec-1-2-2"><span class="section-number-4">1.2.2</span> Getting Unix utilities</h4>
<div class="outline-text-4" id="text-1-2-2">
<p>
Git for Windows provides many Unix utilities ported for Windows like
awk, cat, ls, chown, grep, find and etc.
</p>

<ul class="org-ul">
<li><a href="https://git-scm.com/download/win">https://git-scm.com/download/win</a>
</li>
</ul>

<pre class="example">
c:/Program Files/Git/usr/bin $ ls -l *.exe
-rwxrwxrwx   1 Administrators None        65017 2016-03-18 16:40 [.exe
-rwxrwxrwx   1 Administrators None        28991 2016-03-18 16:40 arch.exe
-rwxrwxrwx   1 Administrators None       581408 2015-05-21  2015 awk.exe
-rwxrwxrwx   1 Administrators None        37712 2016-03-18 16:40 base32.exe
-rwxrwxrwx   1 Administrators None        37712 2016-03-18 16:40 base64.exe
-rwxrwxrwx   1 Administrators None        30078 2016-03-18 16:40 basename.exe
-rwxrwxrwx   1 Administrators None      2063362 2016-07-13 16:00 bash.exe
-rwxrwxrwx   1 Administrators None        89618 2014-11-04  2014 bunzip2.exe
-rwxrwxrwx   1 Administrators None        89618 2014-11-04  2014 bzcat.exe
-rwxrwxrwx   1 Administrators None        89618 2014-11-04  2014 bzip2.exe
-rwxrwxrwx   1 Administrators None        14686 2014-11-04  2014 bzip2recover.exe
-rwxrwxrwx   1 Administrators None        74003 2016-03-01 17:15 captoinfo.exe
-rwxrwxrwx   1 Administrators None        51896 2016-03-18 16:40 cat.exe
-rwxrwxrwx   1 Administrators None        55848 2016-03-18 16:40 chcon.exe

...

-rwxrwxrwx   1 Administrators None       128615 2016-03-18 16:40 vdir.exe
-rwxrwxrwx   1 Administrators None      2335971 2016-04-09 11:08 view.exe
-rwxrwxrwx   1 Administrators None      2335971 2016-04-09 11:08 vim.exe
-rwxrwxrwx   1 Administrators None      2335971 2016-04-09 11:08 vimdiff.exe
-rwxrwxrwx   1 Administrators None        42100 2016-03-18 16:40 wc.exe
-rwxrwxrwx   1 Administrators None        29553 2015-07-20  2015 which.exe
-rwxrwxrwx   1 Administrators None        63429 2016-03-18 16:40 who.exe
-rwxrwxrwx   1 Administrators None        28054 2016-03-18 16:40 whoami.exe
-rwxrwxrwx   1 Administrators None       975360 2016-05-16 14:32 winpty-agent.exe
-rwxrwxrwx   1 Administrators None        41984 2016-05-16 14:32 winpty-debugserver.exe
-rwxrwxrwx   1 Administrators None       747008 2016-05-16 14:32 winpty.exe
-rwxrwxrwx   1 Administrators None        64058 2016-01-20 15:17 xargs.exe
-rwxrwxrwx   1 Administrators None        25299 2016-03-29 14:28 xmlwf.exe
-rwxrwxrwx   1 Administrators None        18954 2016-04-09 11:08 xxd.exe
-rwxrwxrwx   1 Administrators None        28580 2016-03-18 16:40 yes.exe
-rwxrwxrwx   1 Administrators None       173708 2014-11-04  2014 zipinfo.exe
</pre>

<p>
GNU Make is an useful build-automation tool and can be got from:
</p>

<ul class="org-ul">
<li><a href="https://chocolatey.org/packages/make/3.81.4">https://chocolatey.org/packages/make/3.81.4</a>
</li>
</ul>

<pre class="example">
$ choco install make
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3"><span class="section-number-3">1.3</span> Set Environments Variables</h3>
<div class="outline-text-3" id="text-1-3">
</div><div id="outline-container-sec-1-3-1" class="outline-4">
<h4 id="sec-1-3-1"><span class="section-number-4">1.3.1</span> Set HOME</h4>
<div class="outline-text-4" id="text-1-3-1">
<p>
The HOME environment variable that has the default value
<span class="underline">/home/&lt;username&gt;)</span> on Linux sets the user's directory path.
</p>

<p>
This variable, which is equivalent to  _%USERPROFILE% _(<code>C:\\Users\&lt;username&gt;</code> ) 
is expected to be set by many Unix applications ported to Windows and it
also makes directory browser in Emacs and shells easier. 
</p>

<div class="org-src-container">

<pre class="src src-bat">C:\Users\arch&gt;echo %<span class="org-variable-name">USERPROFILE</span>%
C:\Users\arch
</pre>
</div>

<p>
It can be set permanently by using the commmand below on cmd.exe shell.
</p>

<div class="org-src-container">

<pre class="src src-bat">setx HOME %<span class="org-variable-name">USERPROFILE</span>%
</pre>
</div>

<p>
To test if the variable is set. Open a new cmd.exe shell and type:
</p>

<div class="org-src-container">

<pre class="src src-bat">C:\Users\arch&gt;echo %<span class="org-variable-name">HOME</span>%
C:\Users\arch
</pre>
</div>

<p>
<b>It allows to browser Windows directories as:</b>
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<tbody>
<tr>
<td class="left">~</td>
<td class="left">C:\Users\arch</td>
</tr>

<tr>
<td class="left">~/Desktop</td>
<td class="left">C:\Users\arch\Documents</td>
</tr>

<tr>
<td class="left">~/.emacs.d</td>
<td class="left">C:\Users\arch\.emacs.d</td>
</tr>
</tbody>
</table>


<p>
<b>It also allows the commands:</b>
</p>

<p>
To open file <span class="underline">~/.emac.d/init.el</span>  (C:\Users\arch\.emacs.d\init.el)
</p>

<ul class="org-ul">
<li>C-x C-f find-file ~/.emac.d/init.el 
</li>
</ul>

<p>
To open directory (C:\Users\arch\Desktop)
</p>

<ul class="org-ul">
<li>C-x C-d ~/Desktop 
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1-3-2" class="outline-4">
<h4 id="sec-1-3-2"><span class="section-number-4">1.3.2</span> Set PATH</h4>
<div class="outline-text-4" id="text-1-3-2">
<p>
Executables located in directories listed in PATH environment variable
can be invoked without its full path like ls, echo and who in
Unix-like OS or ipconfig, arp and whoami in Windows.
</p>

<div class="org-src-container">

<pre class="src src-bat">C:\Users\arch\bin&gt;echo %<span class="org-variable-name">PATH</span>%
C:\ProgramData\Oracle\Java\javapath;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem...
</pre>
</div>

<p>
By adding the directory ~/bin or C:\Users\&lt;user&gt;\bin to PATH variable
it makes easir to call command line applications from this directory
without specifing its full path from Emacs or shell (cmd.exe). It can
be done with:
</p>

<ul class="org-ul">
<li>Add the directory C:\Users\&lt;user&gt;\bin to %PATH% enviroment variable: 
</li>
</ul>

<div class="org-src-container">

<pre class="src src-bat">setx <span class="org-builtin">PATH</span> <span class="org-string">"%PATH%;%USERPROFILE%\bin"</span>
</pre>
</div>

<p>
It makes easeir to call C:\Users\&lt;user&gt;\bin\curl.exe from any
directory. Instead of write its full path the user can just run <code>$
curl.exe</code> or <code>$ curl</code>.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4"><span class="section-number-3">1.4</span> Unix utilities</h3>
<div class="outline-text-3" id="text-1-4">
<p>
You can bash install with Chocolately package manager or download GIT
version control app that comes bundled with bash and Unix utilities
like grep, mv, ssh, df and dd.
</p>

<p>
Command to run Bash. Usage: M-x run-bash 
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">run-bash</span> ()
      (<span class="org-keyword">interactive</span>)
      (<span class="org-keyword">let</span> ((shell-file-name <span class="org-string">"C:\\Program Files\\Git\\bin\\bash.exe"</span>))
            (shell <span class="org-string">"*bash*"</span>)))
</pre>
</div>


<p>
Command to run cmd.exe. Usage: M-x run-cmdexe 
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">run-cmdexe</span> ()
      (<span class="org-keyword">interactive</span>)
      (<span class="org-keyword">let</span> ((shell-file-name <span class="org-string">"cmd.exe"</span>))
            (shell <span class="org-string">"*cmd.exe*"</span>)))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-5" class="outline-3">
<h3 id="sec-1-5"><span class="section-number-3">1.5</span> Environment Variables in Emacs</h3>
<div class="outline-text-3" id="text-1-5">
<p>
To run Unix utilities and other command lines apps in Emacs add to the
PATH system environment variable the path to their directories like this:
</p>


<div class="org-src-container">

<pre class="src src-elisp">(setenv  <span class="org-string">"PATH"</span> (concat

                <span class="org-comment-delimiter">;; </span><span class="org-comment">"c:/Windows/System32" ";" </span>

                 <span class="org-string">"c:/Windows/Microsoft.NET/Framework/v4.0.30319"</span> <span class="org-string">";"</span>

                 <span class="org-string">"C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319"</span> <span class="org-string">";"</span>

                 <span class="org-comment-delimiter">;; </span><span class="org-comment">Unix tools </span>
                 <span class="org-string">"C:\\Program Files\\Git\\usr\\bin"</span> <span class="org-string">";"</span>

                 <span class="org-comment-delimiter">;; </span><span class="org-comment">User binary files </span>
                 <span class="org-string">"C:\\User\\arch\\bin"</span> <span class="org-string">";"</span>

                 <span class="org-comment-delimiter">;; </span><span class="org-comment">Mono Installation.</span>
                 <span class="org-string">"c:\\Program Files\\Mono\\bin"</span> <span class="org-string">";"</span>

                 <span class="org-string">"c:\\Program Files\\Mono\\lib\\mono\\4.5"</span> <span class="org-string">";"</span>

                 (getenv <span class="org-string">"PATH"</span>)

         ))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-6" class="outline-3">
<h3 id="sec-1-6"><span class="section-number-3">1.6</span> Eshell</h3>
<div class="outline-text-3" id="text-1-6">
</div><div id="outline-container-sec-1-6-1" class="outline-4">
<h4 id="sec-1-6-1"><span class="section-number-4">1.6.1</span> Overview</h4>
<div class="outline-text-4" id="text-1-6-1">
<p>
Eshell provides many benefits to Windows users: 
</p>

<ul class="org-ul">
<li>Many unix like commands implemented on Emacs' Lisp like: mv, cp, which &#x2026;
</li>

<li>Completion
</li>

<li>History: C-c C-l 
</li>

<li>Easy copy and paste unlike cmd.exe
</li>

<li>Integration with Eamcs since it can run Emacs commands (interactive
functions) like shell commands.
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1-6-2" class="outline-4">
<h4 id="sec-1-6-2"><span class="section-number-4">1.6.2</span> Screenshots</h4>
<div class="outline-text-4" id="text-1-6-2">

<div class="figure">
<p><img src="images/eshell-windows-demo1.png" alt="eshell-windows-demo1.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-sec-1-6-3" class="outline-4">
<h4 id="sec-1-6-3"><span class="section-number-4">1.6.3</span> Demonstrations</h4>
<div class="outline-text-4" id="text-1-6-3">
</div><ol class="org-ol"><li><a id="sec-1-6-3-1" name="sec-1-6-3-1"></a>Commands and history<br  /><div class="outline-text-5" id="text-1-6-3-1">
<p>
To open the history type: C-c C-l 
</p>


<div class="figure">
<p><img src="images/eshell-windows-demo1.gif" alt="eshell-windows-demo1.gif" />
</p>
</div>
</div>
</li>

<li><a id="sec-1-6-3-2" name="sec-1-6-3-2"></a>Emacs Integration<br  /><div class="outline-text-5" id="text-1-6-3-2">
<p>
Eshell can run Emacs elisp commands (interactive functions) like
find-file, dired as ordinary shell commands like is shown above. 
</p>

<p>
The function <span class="underline">find-file</span> can be executed in eshell as shell command
<code>find-file ~/.emacs.d/init.el</code> .
</p>

<div class="org-src-container">

<pre class="src src-elisp">(find-file <span class="org-string">"~/.emacs.d/init.el"</span>)
</pre>
</div>

<p>
Some useful Elisp commands on Eshell:
</p>

<p>
Open file:
</p>

<ul class="org-ul">
<li>find-file
</li>
<li>find-file-other-window
</li>
<li>find-file-other-frame 
</li>
</ul>

<p>
Open directory:
</p>

<ul class="org-ul">
<li>dired
</li>
<li>dired-other-window 
</li>
<li>dired-other-frame
</li>
</ul>
</div>
</li>

<li><a id="sec-1-6-3-3" name="sec-1-6-3-3"></a>Asyncrhonous Commands<br  /><div class="outline-text-5" id="text-1-6-3-3">
<pre class="example">
~/Desktop $ notepad.exe &amp;
</pre>
</div>
</li>

<li><a id="sec-1-6-3-4" name="sec-1-6-3-4"></a>Copy command output to clibpoard<br  /><div class="outline-text-5" id="text-1-6-3-4">
<p>
Eshell comes with a pseudo clipboard device /dev/kill that is useful
to handle clipboard.
</p>


<p>
<b>Copy command output to clibpboard</b>
</p>

<div class="org-src-container">

<pre class="src src-sh">~/Desktop $ ipconfig.exe &gt; /dev/kill
</pre>
</div>

<p>
<b>Show clibpoard content</b>
</p>
</div>
</li>

<li><a id="sec-1-6-3-5" name="sec-1-6-3-5"></a>Shell Commands mixed with Emacs commands<br  /><div class="outline-text-5" id="text-1-6-3-5">
<p>
Note: split-string Is an Emacs function.
</p>

<p>
<b>Example 1:</b>
</p>

<div class="org-src-container">

<pre class="src src-sh">~/Desktop $ split-string $<span class="org-variable-name">PATH</span> <span class="org-string">";"</span> 

(<span class="org-comment-delimiter">#</span><span class="org-comment">("C:/Program Files (x86)/Microsoft SDKs/F#/4.0/Framework/v4.0" 0 59</span>
   (escaped t))
 <span class="org-comment-delimiter">#</span><span class="org-comment">("c:/Windows/System32" 0 19</span>
   (escaped t))
 <span class="org-comment-delimiter">#</span><span class="org-comment">("c:/Windows/Microsoft.NET/Framework/v4.0.30319" 0 45</span>
   (escaped t))
 <span class="org-comment-delimiter">#</span><span class="org-comment">("C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319" 0 45</span>
   (escaped t))
 <span class="org-comment-delimiter">#</span><span class="org-comment">("C:\\Program Files\\Git\\usr\\bin" 0 28</span>
   (escaped t))
 <span class="org-comment-delimiter">#</span><span class="org-comment">("C:\\User\\arch\\bin" 0 16</span>
   (escaped t))
 <span class="org-comment-delimiter">#</span><span class="org-comment">("c:\\Program Files\\Mono\\bin" 0 25</span>
   (escaped t))
 <span class="org-comment-delimiter">#</span><span class="org-comment">("c:\\Program Files\\Mono\\lib\\mono\\4.5" 0 34</span>
   (escaped t))
 <span class="org-string">""</span>)
~/Desktop $
</pre>
</div>


<p>
<b>Exmaple 2:</b>
</p>

<div class="org-src-container">

<pre class="src src-sh">~/Desktop $ for m<span class="org-keyword"> in</span> {split-string $<span class="org-variable-name">PATH</span> <span class="org-string">";"</span>} {<span class="org-builtin">echo</span> $<span class="org-variable-name">m</span>}

C:/Program Files (x86)/Microsoft SDKs/F#/4.0/Framework/v4.0
c:/Windows/System32
c:/Windows/Microsoft.NET/Framework/v4.0.30319
C:\Windows\Microsoft.NET\Framework\v4.0.30319
C:\Program Files\Git\usr\bin
C:\User\arch\bin
c:\Program Files\Mono\bin
c:\Program Files\Mono\lib\mono\4.5
~/Desktop $
</pre>
</div>


<p>
<b>Example 3:</b>
</p>

<div class="org-src-container">

<pre class="src src-sh">~/Desktop $ for m<span class="org-keyword"> in</span> $<span class="org-variable-name">load</span>-path { <span class="org-builtin">echo</span> $<span class="org-variable-name">m</span>}

e:/projects/org-wiki
~/.emacs.d/packages
c:/Users/arch/.emacs.d/elpa/csharp-mode-20160901.319
c:/Users/arch/.emacs.d/elpa/fsharp-mode-20160719.315
c:/Users/arch/.emacs.d/elpa/flycheck-20160817.321
c:/Users/arch/.emacs.d/elpa/company-quickhelp-20160211.718
c:/Users/arch/.emacs.d/elpa/company-20160730.1516
c:/Users/arch/.emacs.d/elpa/helm-anything-20141126.231
c:/Users/arch/.emacs.d/elpa/anything-20160822.1852
c:/Users/arch/.emacs.d/elpa/helm-20160824.745
...
</pre>
</div>
</div>
</li></ol>
</div>
</div>

<div id="outline-container-sec-1-7" class="outline-3">
<h3 id="sec-1-7"><span class="section-number-3">1.7</span> Powershell</h3>
<div class="outline-text-3" id="text-1-7">
<p>
This command runs Powershell on Emacs:
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">run-powershell</span> ()
  <span class="org-doc">"Run powershell"</span>
  (<span class="org-keyword">interactive</span>)
  (async-shell-command <span class="org-string">"c:/windows/system32/WindowsPowerShell/v1.0/powershell.exe -Command -"</span>
                       nil
                       nil)
  )
</pre>
</div>

<p>
Usage: M-x run-powershell. 
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2017-01-20 sex 22:45</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 25.1.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
