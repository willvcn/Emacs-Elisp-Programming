<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Elisp Snippets</title>
<!-- 2017-01-20 sex 22:45 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="description" content="Emacs programming and customization.
Lots of ELisp examples categorized by task."
 />
<meta  name="keywords" content="emacs, elisp, lisp, programming, snippets, examples, code, utilities" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link href="theme/style2.css" rel="stylesheet">

<script type="text/javascript" src="theme/org-info.js">
/**
 *
 * @source: theme/org-info.js
 *
 * @licstart  The following is the entire license notice for the
 *  JavaScript code in theme/org-info.js.
 *
 * Copyright (C) 2012-2013 Free Software Foundation, Inc.
 *
 *
 * The JavaScript code in this tag is free software: you can
 * redistribute it and/or modify it under the terms of the GNU
 * General Public License (GNU GPL) as published by the Free Software
 * Foundation, either version 3 of the License, or (at your option)
 * any later version.  The code is distributed WITHOUT ANY WARRANTY;
 * without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.
 *
 * As additional permission under GNU GPL version 3 section 7, you
 * may distribute non-source (e.g., minimized or compacted) forms of
 * that code without the copy of the GNU GPL normally required by
 * section 4, provided you include this license notice and a URL
 * through which recipients can access the Corresponding Source.
 *
 * @licend  The above is the entire license notice
 * for the JavaScript code in theme/org-info.js.
 *
 */
</script>

<script type="text/javascript">

/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/

<!--/*--><![CDATA[/*><!--*/
org_html_manager.set("TOC_DEPTH", "3");
org_html_manager.set("LINK_HOME", "");
org_html_manager.set("LINK_UP", "");
org_html_manager.set("LOCAL_TOC", "1");
org_html_manager.set("VIEW_BUTTONS", "0");
org_html_manager.set("MOUSE_HINT", "underline");
org_html_manager.set("FIXED_TOC", "0");
org_html_manager.set("TOC", "1");
org_html_manager.set("VIEW", "showall");
org_html_manager.setup();  // activate after the parameters are set
/*]]>*///-->
</script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Elisp Snippets</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. Elisp Snippets</a>
<ul>
<li><a href="#sec-1-1">1.1. Strings</a>
<ul>
<li><a href="#sec-1-1-1">1.1.1. Concatenate strings</a></li>
<li><a href="#sec-1-1-2">1.1.2. Join Strings by Separator</a></li>
<li><a href="#sec-1-1-3">1.1.3. Split String</a></li>
<li><a href="#sec-1-1-4">1.1.4. Split String with quotes</a></li>
<li><a href="#sec-1-1-5">1.1.5. Replace Strings</a></li>
<li><a href="#sec-1-1-6">1.1.6. Regex</a></li>
</ul>
</li>
<li><a href="#sec-1-2">1.2. S-expressions</a>
<ul>
<li><a href="#sec-1-2-1">1.2.1. Parse s-expressions</a></li>
<li><a href="#sec-1-2-2">1.2.2. Evaluate s-expressions</a></li>
</ul>
</li>
<li><a href="#sec-1-3">1.3. Clipboard (Kill-ring)&#xa0;&#xa0;&#xa0;<span class="tag"><span class="elisp">elisp</span>&#xa0;<span class="clipboard">clipboard</span>&#xa0;<span class="kill">kill</span>&#xa0;<span class="ring">ring</span></span></a>
<ul>
<li><a href="#sec-1-3-1">1.3.1. Copy string to clipboard</a></li>
<li><a href="#sec-1-3-2">1.3.2. Paste string from clipboard</a></li>
<li><a href="#sec-1-3-3">1.3.3. Copy buffer file name to clibpoard</a></li>
<li><a href="#sec-1-3-4">1.3.4. Copy buffer directory to clibpoard</a></li>
<li><a href="#sec-1-3-5">1.3.5. Copy buffer content to clipboard</a></li>
</ul>
</li>
<li><a href="#sec-1-4">1.4. Elisp</a>
<ul>
<li><a href="#sec-1-4-1">1.4.1. Load an Elisp file</a></li>
<li><a href="#sec-1-4-2">1.4.2. Load all elisp files of a directory</a></li>
<li><a href="#sec-1-4-3">1.4.3. Add directory to load path</a></li>
<li><a href="#sec-1-4-4">1.4.4. Switch and Create the Scratch Buffer</a></li>
<li><a href="#sec-1-4-5">1.4.5. Eval String in Clipboard</a></li>
<li><a href="#sec-1-4-6">1.4.6. Extract Function Documentation&#xa0;&#xa0;&#xa0;<span class="tag"><span class="elisp">elisp</span></span></a></li>
</ul>
</li>
<li><a href="#sec-1-5">1.5. Common Lisp Emulation Library</a>
<ul>
<li><a href="#sec-1-5-1">1.5.1. Reduce (fold left) function</a></li>
</ul>
</li>
<li><a href="#sec-1-6">1.6. Buffer and regions</a>
<ul>
<li><a href="#sec-1-6-1">1.6.1. Save buffer</a></li>
<li><a href="#sec-1-6-2">1.6.2. Get buffer content as string</a></li>
<li><a href="#sec-1-6-3">1.6.3. Get selected text as string</a></li>
<li><a href="#sec-1-6-4">1.6.4. Creating a scratch buffer for Programming Languages</a></li>
</ul>
</li>
<li><a href="#sec-1-7">1.7. IO - Input and Output</a>
<ul>
<li><a href="#sec-1-7-1">1.7.1. Input - Read User Input</a></li>
<li><a href="#sec-1-7-2">1.7.2. Output</a></li>
</ul>
</li>
<li><a href="#sec-1-8">1.8. Shell Commands / Interacting with external applications</a>
<ul>
<li><a href="#sec-1-8-1">1.8.1. Related Documentation</a></li>
<li><a href="#sec-1-8-2">1.8.2. Synchronous Shell Commands</a></li>
<li><a href="#sec-1-8-3">1.8.3. Pipe a region to external command&#xa0;&#xa0;&#xa0;<span class="tag"><span class="terminal">terminal</span>&#xa0;<span class="shell">shell</span>&#xa0;<span class="command">command</span>&#xa0;<span class="pipe">pipe</span>&#xa0;<span class="interface">interface</span></span></a></li>
<li><a href="#sec-1-8-4">1.8.4. Launch apps in Asynchronous mode</a></li>
<li><a href="#sec-1-8-5">1.8.5. Run asynchronous commands piping the output to a buffer</a></li>
<li><a href="#sec-1-8-6">1.8.6. Run a ncurses / terminal app inside Emacs</a></li>
<li><a href="#sec-1-8-7">1.8.7. Run apps in external terminal emulator&#xa0;&#xa0;&#xa0;<span class="tag"><span class="terminal">terminal</span>&#xa0;<span class="shell">shell</span>&#xa0;<span class="os">os</span>&#xa0;<span class="command">command</span></span></a></li>
<li><a href="#sec-1-8-8">1.8.8. Launch applicatiosn from Emacs</a></li>
<li><a href="#sec-1-8-9">1.8.9. Send regions, commands and buffer to M-x shell repl.</a></li>
</ul>
</li>
<li><a href="#sec-1-9">1.9. File</a>
<ul>
<li><a href="#sec-1-9-1">1.9.1. Test if file or directory exists</a></li>
<li><a href="#sec-1-9-2">1.9.2. Expand file name</a></li>
<li><a href="#sec-1-9-3">1.9.3. Read file to string</a></li>
<li><a href="#sec-1-9-4">1.9.4. Open file to edit</a></li>
<li><a href="#sec-1-9-5">1.9.5. Open file to edit silently</a></li>
<li><a href="#sec-1-9-6">1.9.6. Edit File as Root&#xa0;&#xa0;&#xa0;<span class="tag"><span class="utils">utils</span>&#xa0;<span class="edit">edit</span></span></a></li>
</ul>
</li>
<li><a href="#sec-1-10">1.10. Directory&#xa0;&#xa0;&#xa0;<span class="tag"><span class="directory">directory</span></span></a>
<ul>
<li><a href="#sec-1-10-1">1.10.1. Open directory</a></li>
<li><a href="#sec-1-10-2">1.10.2. Create directory</a></li>
<li><a href="#sec-1-10-3">1.10.3. List directory</a></li>
</ul>
</li>
<li><a href="#sec-1-11">1.11. Dired mode snippets&#xa0;&#xa0;&#xa0;<span class="tag"><span class="directory">directory</span>&#xa0;<span class="dired">dired</span></span></a>
<ul>
<li><a href="#sec-1-11-1">1.11.1. Overview</a></li>
<li><a href="#sec-1-11-2">1.11.2. Copy path of file at point</a></li>
<li><a href="#sec-1-11-3">1.11.3. Paste a file from clibpboard</a></li>
<li><a href="#sec-1-11-4">1.11.4. Create empty file (touch)</a></li>
<li><a href="#sec-1-11-5">1.11.5. Open multiple marked files</a></li>
<li><a href="#sec-1-11-6">1.11.6. Close multiple marked files</a></li>
<li><a href="#sec-1-11-7">1.11.7. Open a file with default system application&#xa0;&#xa0;&#xa0;<span class="tag"><span class="dired">dired</span>&#xa0;<span class="file">file</span>&#xa0;<span class="open">open</span>&#xa0;<span class="system">system</span></span></a></li>
<li><a href="#sec-1-11-8">1.11.8. Close all dired buffers</a></li>
<li><a href="#sec-1-11-9">1.11.9. Browse bookmarked directories&#xa0;&#xa0;&#xa0;<span class="tag"><span class="dired">dired</span>&#xa0;<span class="directory">directory</span>&#xa0;<span class="helm">helm</span>&#xa0;<span class="browse">browse</span></span></a></li>
<li><a href="#sec-1-11-10">1.11.10. Filter dired buffer by file extensions</a></li>
<li><a href="#sec-1-11-11">1.11.11. Filter dired buffer by regex</a></li>
<li><a href="#sec-1-11-12">1.11.12. Open directory at point with Microsoft Explorer in Windows OS.</a></li>
</ul>
</li>
<li><a href="#sec-1-12">1.12. Text Manipulation</a>
<ul>
<li><a href="#sec-1-12-1">1.12.1. Text alignment</a></li>
<li><a href="#sec-1-12-2">1.12.2. Join Multiple Lines</a></li>
</ul>
</li>
<li><a href="#sec-1-13">1.13. Emacs Introspection</a>
<ul>
<li><a href="#sec-1-13-1">1.13.1. User init file</a></li>
<li><a href="#sec-1-13-2">1.13.2. User Emacs Directory</a></li>
<li><a href="#sec-1-13-3">1.13.3. Enviroment Variables</a></li>
<li><a href="#sec-1-13-4">1.13.4. Get current Operating System</a></li>
<li><a href="#sec-1-13-5">1.13.5. Test if Emacs is running in terminal or in window system</a></li>
</ul>
</li>
<li><a href="#sec-1-14">1.14. Web Browser&#xa0;&#xa0;&#xa0;<span class="tag"><span class="http">http</span>&#xa0;<span class="web">web</span>&#xa0;<span class="browser">browser</span></span></a>
<ul>
<li><a href="#sec-1-14-1">1.14.1. Browse Url</a></li>
<li><a href="#sec-1-14-2">1.14.2. Browser Url setting the web browser</a></li>
<li><a href="#sec-1-14-3">1.14.3. Search Web sites with Emacs</a></li>
<li><a href="#sec-1-14-4">1.14.4. Browser Inside Emacs</a></li>
</ul>
</li>
<li><a href="#sec-1-15">1.15. Http Requests&#xa0;&#xa0;&#xa0;<span class="tag"><span class="http">http</span>&#xa0;<span class="request">request</span>&#xa0;<span class="url">url</span>&#xa0;<span class="network">network</span></span></a>
<ul>
<li><a href="#sec-1-15-1">1.15.1. Download File&#xa0;&#xa0;&#xa0;<span class="tag"><span class="http">http</span>&#xa0;<span class="web">web</span>&#xa0;<span class="download">download</span></span></a></li>
<li><a href="#sec-1-15-2">1.15.2. url-retrieve-synchronously&#xa0;&#xa0;&#xa0;<span class="tag"><span class="http">http</span>&#xa0;<span class="web">web</span>&#xa0;<span class="download">download</span>&#xa0;<span class="sync">sync</span></span></a></li>
<li><a href="#sec-1-15-3">1.15.3. Download a file interactively&#xa0;&#xa0;&#xa0;<span class="tag"><span class="http">http</span>&#xa0;<span class="web">web</span>&#xa0;<span class="download">download</span>&#xa0;<span class="file">file</span></span></a></li>
<li><a href="#sec-1-15-4">1.15.4. Download a file and display it on a buffer&#xa0;&#xa0;&#xa0;<span class="tag"><span class="http">http</span>&#xa0;<span class="web">web</span>&#xa0;<span class="buffer">buffer</span>&#xa0;<span class="clipboard">clipboard</span></span></a></li>
<li><a href="#sec-1-15-5">1.15.5. Http and Post Request&#xa0;&#xa0;&#xa0;<span class="tag"><span class="utils">utils</span>&#xa0;<span class="connections">connections</span>&#xa0;<span class="http">http</span></span></a></li>
</ul>
</li>
<li><a href="#sec-1-16">1.16. Packages&#xa0;&#xa0;&#xa0;<span class="tag"><span class="package">package</span>&#xa0;<span class="install">install</span>&#xa0;<span class="library">library</span></span></a>
<ul>
<li><a href="#sec-1-16-1">1.16.1. Test if package is installed</a></li>
<li><a href="#sec-1-16-2">1.16.2. Install a package if it is not installed</a></li>
<li><a href="#sec-1-16-3">1.16.3. Install a single-file package from URL</a></li>
</ul>
</li>
<li><a href="#sec-1-17">1.17. Helm Snippets&#xa0;&#xa0;&#xa0;<span class="tag"><span class="framework">framework</span>&#xa0;<span class="library">library</span>&#xa0;<span class="helm">helm</span></span></a>
<ul>
<li><a href="#sec-1-17-1">1.17.1. Switch between buffers in same directory</a></li>
<li><a href="#sec-1-17-2">1.17.2. Browser Recent files</a></li>
<li><a href="#sec-1-17-3">1.17.3. Browser Recent directories</a></li>
<li><a href="#sec-1-17-4">1.17.4. Launch ansync shell command with helm</a></li>
<li><a href="#sec-1-17-5">1.17.5. Switch between buffers associated with files</a></li>
<li><a href="#sec-1-17-6">1.17.6. Switch between Emacs major modes</a></li>
<li><a href="#sec-1-17-7">1.17.7. Open a list of web sites</a></li>
<li><a href="#sec-1-17-8">1.17.8. Interface Makefile</a></li>
</ul>
</li>
<li><a href="#sec-1-18">1.18. Persistence</a>
<ul>
<li><a href="#sec-1-18-1">1.18.1. Save and Reload Current Session</a></li>
<li><a href="#sec-1-18-2">1.18.2. Save and Restore Current Window Configuration</a></li>
</ul>
</li>
<li><a href="#sec-1-19">1.19. Non categorized</a>
<ul>
<li><a href="#sec-1-19-1">1.19.1. Save the scratch buffer and reload every Emacs startup</a></li>
<li><a href="#sec-1-19-2">1.19.2. Code Navigation with Occur&#xa0;&#xa0;&#xa0;<span class="tag"><span class="edit">edit</span></span></a></li>
<li><a href="#sec-1-19-3">1.19.3. Quick edit and reload Emacs Configuration File.&#xa0;&#xa0;&#xa0;<span class="tag"><span class="elisp">elisp</span>&#xa0;<span class="customization">customization</span></span></a></li>
<li><a href="#sec-1-19-4">1.19.4. Refresh / Revert buffer without confirmation.</a></li>
<li><a href="#sec-1-19-5">1.19.5. Create a menu with all color themes available</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-2">2. IELM - Inferior Emacs Lisp Mode</a>
<ul>
<li><a href="#sec-2-1">2.1. Change Prompt</a></li>
<li><a href="#sec-2-2">2.2. Clear IELM shell</a></li>
<li><a href="#sec-2-3">2.3. Send Region to IELM</a></li>
<li><a href="#sec-2-4">2.4. Set other window's buffer as working buffer</a></li>
<li><a href="#sec-2-5">2.5. Start IELM in other window setting the working buffer to current buffer</a></li>
<li><a href="#sec-2-6">2.6. Launch IELM in other frame</a></li>
</ul>
</li>
<li><a href="#sec-3">3. Emacs Server and Client</a></li>
<li><a href="#sec-4">4. Org-mode</a>
<ul>
<li><a href="#sec-4-1">4.1. Code Block Templates</a></li>
<li><a href="#sec-4-2">4.2. Custom Protocols</a>
<ul>
<li><a href="#sec-4-2-1">4.2.1. Open directory with dired mode</a></li>
<li><a href="#sec-4-2-2">4.2.2. Open directory with system file manager</a></li>
<li><a href="#sec-4-2-3">4.2.3. Man page</a></li>
<li><a href="#sec-4-2-4">4.2.4. Elisp Documentation</a></li>
</ul>
</li>
<li><a href="#sec-4-3">4.3. Settings</a>
<ul>
<li><a href="#sec-4-3-1">4.3.1. General Settings</a></li>
<li><a href="#sec-4-3-2">4.3.2. Code Block - Org-babel</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-5">5. Selected Gists and Source Codes</a>
<ul>
<li><a href="#sec-5-1">5.1. Gists</a></li>
<li><a href="#sec-5-2">5.2. Source Codes</a></li>
</ul>
</li>
</ul>
</div>
</div>
<a href="index.html">Top</a>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Elisp Snippets</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> Strings</h3>
<div class="outline-text-3" id="text-1-1">
</div><div id="outline-container-sec-1-1-1" class="outline-4">
<h4 id="sec-1-1-1"><span class="section-number-4">1.1.1</span> Concatenate strings</h4>
<div class="outline-text-4" id="text-1-1-1">
<div class="org-src-container">

<pre class="src src-elisp">&gt; (concat <span class="org-string">"hello"</span> <span class="org-string">" world"</span>)
<span class="org-string">"hello world"</span>

&gt; (concat <span class="org-string">"hello"</span> <span class="org-string">" world"</span> <span class="org-string">" elisp "</span>)
<span class="org-string">"hello world elisp "</span>

&gt; (apply #'concat '(<span class="org-string">"hello"</span> <span class="org-string">" world "</span> <span class="org-string">" elisp "</span>))
<span class="org-string">"hello world  elisp "</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-1-2" class="outline-4">
<h4 id="sec-1-1-2"><span class="section-number-4">1.1.2</span> Join Strings by Separator</h4>
<div class="outline-text-4" id="text-1-1-2">
<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">join</span> (sep lst)
   (mapconcat 'identity lst sep))

ELISP&gt; (join <span class="org-string">","</span> '(<span class="org-string">"1.232"</span> <span class="org-string">"300"</span>  <span class="org-string">"500"</span>))
<span class="org-string">"1.232,300,500"</span>

ELISP&gt; (join <span class="org-string">", "</span> '(<span class="org-string">"1.232"</span> <span class="org-string">"300"</span>  <span class="org-string">"500"</span>))
<span class="org-string">"1.232, 300, 500"</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-1-3" class="outline-4">
<h4 id="sec-1-1-3"><span class="section-number-4">1.1.3</span> Split String</h4>
<div class="outline-text-4" id="text-1-1-3">
<div class="org-src-container">

<pre class="src src-elisp">&gt; (split-string  <span class="org-string">"100,200,300,400"</span> <span class="org-string">","</span>)
(<span class="org-string">"100"</span> <span class="org-string">"200"</span> <span class="org-string">"300"</span> <span class="org-string">"400"</span>)

&gt; (split-string (getenv <span class="org-string">"PATH"</span>) <span class="org-string">":"</span>)
(<span class="org-string">"/usr/local/sbin"</span> <span class="org-string">"/usr/local/bin"</span> <span class="org-string">"/usr/bin"</span> ...)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-1-4" class="outline-4">
<h4 id="sec-1-1-4"><span class="section-number-4">1.1.4</span> Split String with quotes</h4>
<div class="outline-text-4" id="text-1-1-4">
<div class="org-src-container">

<pre class="src src-elisp">&gt; (split-string-and-unquote <span class="org-string">"/bin/app -x -y -z   \"/home/user/some name with space/etc\" -k cmd "</span>)

(<span class="org-string">"/bin/app"</span> <span class="org-string">"-x"</span> <span class="org-string">"-y"</span> <span class="org-string">"-z"</span> <span class="org-string">"/home/user/some name with space/etc"</span> <span class="org-string">"-k"</span> <span class="org-string">"cmd"</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-1-1-5" class="outline-4">
<h4 id="sec-1-1-5"><span class="section-number-4">1.1.5</span> Replace Strings</h4>
</div>
<div id="outline-container-sec-1-1-6" class="outline-4">
<h4 id="sec-1-1-6"><span class="section-number-4">1.1.6</span> Regex</h4>
</div>
</div>
<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2"><span class="section-number-3">1.2</span> S-expressions</h3>
<div class="outline-text-3" id="text-1-2">
</div><div id="outline-container-sec-1-2-1" class="outline-4">
<h4 id="sec-1-2-1"><span class="section-number-4">1.2.1</span> Parse s-expressions</h4>
<div class="outline-text-4" id="text-1-2-1">
<div class="org-src-container">

<pre class="src src-elisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">Exaluate with M-x eval-print-last-sexp</span>

&gt; (read   <span class="org-string">"(mapc (lambda (p) (insert p) (insert \"\n\"))</span>
<span class="org-string">               (buffer-list))</span>
<span class="org-string">        "</span>)

(mapc (<span class="org-keyword">lambda</span> (p) (insert p) (insert <span class="org-string">"</span>
<span class="org-string">"</span>)) (buffer-list))


&gt; (read <span class="org-string">"(+ 1 2 3 4)"</span>)
(+ 1 2 3 4)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-2-2" class="outline-4">
<h4 id="sec-1-2-2"><span class="section-number-4">1.2.2</span> Evaluate s-expressions</h4>
<div class="outline-text-4" id="text-1-2-2">
<div class="org-src-container">

<pre class="src src-elisp">&gt; (eval (read <span class="org-string">"(+ 1 2 3 4)"</span> ))
10

&gt; (eval '(+ 1 2 3 4))
10
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3"><span class="section-number-3">1.3</span> Clipboard (Kill-ring)&#xa0;&#xa0;&#xa0;<span class="tag"><span class="elisp">elisp</span>&#xa0;<span class="clipboard">clipboard</span>&#xa0;<span class="kill">kill</span>&#xa0;<span class="ring">ring</span></span></h3>
<div class="outline-text-3" id="text-1-3">
</div><div id="outline-container-sec-1-3-1" class="outline-4">
<h4 id="sec-1-3-1"><span class="section-number-4">1.3.1</span> Copy string to clipboard</h4>
<div class="outline-text-4" id="text-1-3-1">
<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">clipboard/set</span> (astring)
  <span class="org-doc">"Copy a string to clipboard"</span>

   (<span class="org-keyword">with-temp-buffer</span>
    (insert astring)
    (clipboard-kill-region (point-min) (point-max))))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-3-2" class="outline-4">
<h4 id="sec-1-3-2"><span class="section-number-4">1.3.2</span> Paste string from clipboard</h4>
<div class="outline-text-4" id="text-1-3-2">
<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">clipboard/get</span> ()

    <span class="org-doc">"Return the content of clipboard as string"</span>

    (<span class="org-keyword">interactive</span>)

    (<span class="org-keyword">with-temp-buffer</span>

      (clipboard-yank)

      (buffer-substring-no-properties (point-min) (point-max))))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-3-3" class="outline-4">
<h4 id="sec-1-3-3"><span class="section-number-4">1.3.3</span> Copy buffer file name to clibpoard</h4>
<div class="outline-text-4" id="text-1-3-3">
<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">buffer/copy-file-name</span> ()
  (<span class="org-keyword">interactive</span>)
  (clipboard/set (buffer-file-name)))

<span class="org-comment-delimiter">;; </span><span class="org-comment">Eval using M-x eval-print-last-sexp</span>
<span class="org-comment-delimiter">;;</span>
&gt; (buffer/copy-file-name)
nil

&gt; (insert (clipboard/get))
/home/arch/projects/emacs/Emacs_Snippets.org
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-3-4" class="outline-4">
<h4 id="sec-1-3-4"><span class="section-number-4">1.3.4</span> Copy buffer directory to clibpoard</h4>
<div class="outline-text-4" id="text-1-3-4">
<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">buffer/copy-path</span> ()
  (<span class="org-keyword">interactive</span>)
  (clipboard/set (file-name-directory (buffer-file-name)))
  (message <span class="org-string">"Copied file path to clipboard"</span>)
  )

<span class="org-comment-delimiter">;; </span><span class="org-comment">Eval using M-x eval-print-last-sexp</span>
<span class="org-comment-delimiter">;;</span>
&gt; (buffer/copy-path)
<span class="org-string">"Copied file path to clipboard"</span>


&gt; (clipboard/get)
<span class="org-string">"/home/arch/projects/emacs/"</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-3-5" class="outline-4">
<h4 id="sec-1-3-5"><span class="section-number-4">1.3.5</span> Copy buffer content to clipboard</h4>
<div class="outline-text-4" id="text-1-3-5">
<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">buffer/copy-content</span> ()
  <span class="org-doc">"</span>
<span class="org-doc">  Copy buffer content to clibpoard</span>
<span class="org-doc">   Usage: M-x buffer/copy-content</span>
<span class="org-doc">  "</span>
  (<span class="org-keyword">interactive</span>)
  (clipboard/set  (buffer-substring-no-properties
                   (point-min)
                   (point-max)
                   )))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4"><span class="section-number-3">1.4</span> Elisp</h3>
<div class="outline-text-3" id="text-1-4">
</div><div id="outline-container-sec-1-4-1" class="outline-4">
<h4 id="sec-1-4-1"><span class="section-number-4">1.4.1</span> Load an Elisp file</h4>
<div class="outline-text-4" id="text-1-4-1">
<p>
Load an elisp source file *.el.
</p>

<div class="org-src-container">

<pre class="src src-elisp">(load-file <span class="org-string">"~/.emacs.d/tools.el"</span>)
</pre>
</div>

<p>
Load an byte-compiled (*.elc) elisp file.
</p>

<div class="org-src-container">

<pre class="src src-elisp">(load-file <span class="org-string">"~/.emacs.d/tools.elc"</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-4-2" class="outline-4">
<h4 id="sec-1-4-2"><span class="section-number-4">1.4.2</span> Load all elisp files of a directory</h4>
<div class="outline-text-4" id="text-1-4-2">
<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">load-dir</span> (path)
  <span class="org-doc">"</span>
<span class="org-doc">  Load all elisp files (*.el) of a directory</span>

<span class="org-doc">  Usage: (load-dir &lt;path&gt;)</span>

<span class="org-doc">  Example: (load-dir \"~/.emacs.d/custom\")</span>

<span class="org-doc">  "</span>
  (mapc #'load (directory-files path t <span class="org-string">"\\.el$"</span>)))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-4-3" class="outline-4">
<h4 id="sec-1-4-3"><span class="section-number-4">1.4.3</span> Add directory to load path</h4>
<div class="outline-text-4" id="text-1-4-3">
<p>
It adds a directory containing Emacs packages (&lt;package name&gt;.el) to
the load path. The user can load packages by adding the code <code>(require '&lt;package&gt;)</code>
to the file init.el.
</p>

<div class="org-src-container">

<pre class="src src-elisp">(add-to-list 'load-path <span class="org-string">"~/.emacs.d/custom"</span>)

<span class="org-comment-delimiter">;; </span><span class="org-comment">package -&gt; ~/.emacs.d/custom/package.el</span>
<span class="org-comment-delimiter">;;</span>
(<span class="org-keyword">require</span> '<span class="org-constant">package</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-1-4-4" class="outline-4">
<h4 id="sec-1-4-4"><span class="section-number-4">1.4.4</span> Switch and Create the Scratch Buffer</h4>
<div class="outline-text-4" id="text-1-4-4">
<p>
This function switches and crates the scratch buffer if it doesn't
exist or was deleted. Usage: M-x scratch.
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">scratch</span> ()
  <span class="org-doc">"</span>
<span class="org-doc">   Switches to scratch buffer and creates</span>
<span class="org-doc">   it if it doesn't exist.</span>

<span class="org-doc">   Usage: M-x scratch</span>

<span class="org-doc">   This function is useful to Elisp developers.</span>

<span class="org-doc">   Suggestion:</span>
<span class="org-doc">        Add (defalias 's #'scratch) to the init file.</span>
<span class="org-doc">        You can switch to the scratch buffer with &gt; M-x s</span>
<span class="org-doc">   "</span>

  (<span class="org-keyword">interactive</span>)

  (<span class="org-keyword">let</span> ((buf (get-buffer-create <span class="org-string">"*scratch*"</span>)))

    (switch-to-buffer buf)
    (lisp-interaction-mode)
    ))

(<span class="org-keyword">defalias</span> '<span class="org-function-name">s</span> #'scratch)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-4-5" class="outline-4">
<h4 id="sec-1-4-5"><span class="section-number-4">1.4.5</span> Eval String in Clipboard</h4>
<div class="outline-text-4" id="text-1-4-5">
<p>
It only works on Linux and requires Xclip to be installed, but with a few changes can be tweaked to work in another Os.
</p>

<div class="org-src-container">

<pre class="src src-elisp">ELISP&gt; (<span class="org-keyword">defun</span> <span class="org-function-name">eval-string</span> (str) (eval (read str)))
eval-string

ELISP&gt; (<span class="org-keyword">defun</span> <span class="org-function-name">eval-xclip</span> () (eval-string (shell-command-to-string <span class="org-string">"xclip -o"</span>)))
eval-xclip

<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;;  </span><span class="org-comment">Copy the following line in this comment block</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;;      </span><span class="org-comment">(message "Loading my copypaste file...")</span>

ELISP&gt; (eval-xclip)
<span class="org-string">"Loading my copypaste file..."</span>
ELISP&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-4-6" class="outline-4">
<h4 id="sec-1-4-6"><span class="section-number-4">1.4.6</span> Extract Function Documentation&#xa0;&#xa0;&#xa0;<span class="tag"><span class="elisp">elisp</span></span></h4>
<div class="outline-text-4" id="text-1-4-6">
<p>
Source: <a href="http://kitchingroup.cheme.cmu.edu/blog/2014/10/17/Generate-emacs-lisp-documentation/">Generate emacs-lisp documentation</a>
Primitives:
</p>

<div class="org-src-container">

<pre class="src src-elisp">ELISP&gt;
ELISP&gt; (<span class="org-keyword">defun</span> <span class="org-function-name">sample-function</span> (a b c)
           <span class="org-doc">"Function Docstring"</span>
         (+ a (* 5 b) (* 3 c)))


<span class="org-comment-delimiter">;; </span><span class="org-comment">Extract Documentation</span>
<span class="org-comment-delimiter">;;</span>
ELISP&gt; (documentation 'sample-function)
<span class="org-string">"Function Docstring"</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Extract Code</span>
<span class="org-comment-delimiter">;;</span>
ELISP&gt; (symbol-function 'sample-function)
(<span class="org-keyword">lambda</span>
  (a b c)
  <span class="org-doc">"Function Docstring"</span>
  (+ a
     (* 5 b)
     (* 3 c)))

<span class="org-comment-delimiter">;; </span><span class="org-comment">Extract Arguments</span>
ELISP&gt; (help-function-arglist 'sample-function)
(a b c)
</pre>
</div>

<p>
Final Code
</p>

<div class="org-src-container">

<pre class="src src-elisp">(fun2org 'sample-function)
    <span class="org-string">"** sample-function (a b c)\nFunction Docstring\n\n#+BEGIN_SRC emacs-lisp\n(lambda (a b c) \"Function Docstring\" (+ a (* 5 b) (* 3 c)))\n#+END_SRC\n"</span>
    ELISP&gt;
    ELISP&gt; (<span class="org-keyword">defun</span> <span class="org-function-name">fun2org</span> (function-symbol)
      (<span class="org-keyword">let</span> ((args (help-function-arglist function-symbol))
            (doc  (documentation function-symbol))
            (code (symbol-function function-symbol)))
        (print (format <span class="org-string">"** %s %s</span>
<span class="org-string">    %s</span>

<span class="org-string">    #+BEGIN_SRC emacs-lisp</span>
<span class="org-string">    %S</span>

<span class="org-string">    "</span> function-symbol args doc code)))) <span class="org-comment-delimiter">;; </span><span class="org-comment">End of fun2org</span>
</pre>
</div>


<div class="org-src-container">

<pre class="src src-elisp">ELISP&gt; (fun2org 'sample-function)

<span class="org-string">"** sample-function (a b c)</span>
<span class="org-string">Function Docstring</span>

<span class="org-string"> (lambda (a b c) \"Function Docstring\" (+ a (* 5 b) (* 3 c)))</span>
<span class="org-string">"</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-1-5" class="outline-3">
<h3 id="sec-1-5"><span class="section-number-3">1.5</span> Common Lisp Emulation Library</h3>
<div class="outline-text-3" id="text-1-5">
</div><div id="outline-container-sec-1-5-1" class="outline-4">
<h4 id="sec-1-5-1"><span class="section-number-4">1.5.1</span> Reduce (fold left) function</h4>
<div class="outline-text-4" id="text-1-5-1">
</div><ol class="org-ol"><li><a id="sec-1-5-1-1" name="sec-1-5-1-1"></a>Build a number from a list of digits<br  /><div class="outline-text-5" id="text-1-5-1-1">
<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">require</span> '<span class="org-constant">cl</span>)

ELISP&gt; (cl-reduce (<span class="org-keyword">lambda</span> (acc x) (+ (* 10 acc) x)) '(1 2 3 4 5 6) <span class="org-builtin">:initial-value</span> 0)
123456 (#o361100, #x1e240)
</pre>
</div>
</div>
</li>

<li><a id="sec-1-5-1-2" name="sec-1-5-1-2"></a>Test if all values of a list are true<br  /><div class="outline-text-5" id="text-1-5-1-2">
<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">require</span> '<span class="org-constant">cl</span>)

ELISP&gt; (cl-reduce (<span class="org-keyword">lambda</span> (acc x) (<span class="org-keyword">and</span> acc x)) '(t nil t t t f) <span class="org-builtin">:initial-value</span> t)
nil
ELISP&gt; (cl-reduce (<span class="org-keyword">lambda</span> (acc x) (<span class="org-keyword">and</span> acc x)) '(t t t t t f) <span class="org-builtin">:initial-value</span> t)
f
ELISP&gt; (cl-reduce (<span class="org-keyword">lambda</span> (acc x) (<span class="org-keyword">and</span> acc x)) '(t t t t t t) <span class="org-builtin">:initial-value</span> t)
t

(<span class="org-keyword">defun</span> <span class="org-function-name">all-p</span> (bool-list)
   <span class="org-doc">"Tests if all values of bool-list are true (not nil)"</span>
   (cl-reduce (<span class="org-keyword">lambda</span> (acc x) (<span class="org-keyword">and</span> acc x)) bool-list <span class="org-builtin">:initial-value</span> t))


ELISP&gt; (all-p '(t t t))
t
ELISP&gt; (all-p '(t nil t))
nil
</pre>
</div>
</div>
</li>

<li><a id="sec-1-5-1-3" name="sec-1-5-1-3"></a>Test if at least one value of a list is true<br  /><div class="outline-text-5" id="text-1-5-1-3">
<div class="org-src-container">

<pre class="src src-elisp">ELISP&gt; (cl-reduce (<span class="org-keyword">lambda</span> (acc x) (<span class="org-keyword">and</span> acc x)) '(t t t t t t) <span class="org-builtin">:initial-value</span> t)
t
ELISP&gt; (cl-reduce (<span class="org-keyword">lambda</span> (acc x) (<span class="org-keyword">or</span> acc x)) '(t t t t t t) <span class="org-builtin">:initial-value</span> nil)
t
ELISP&gt; (cl-reduce (<span class="org-keyword">lambda</span> (acc x) (<span class="org-keyword">or</span> acc x)) '(nil nil nil t t nil) <span class="org-builtin">:initial-value</span> nil)
t
ELISP&gt; (cl-reduce (<span class="org-keyword">lambda</span> (acc x) (<span class="org-keyword">or</span> acc x)) '(nil nil nil nil nil nil) <span class="org-builtin">:initial-value</span> nil)
nil
ELISP&gt; ()

(<span class="org-keyword">defun</span> <span class="org-function-name">some-p</span> (bool-list)
   <span class="org-doc">"Tests if at least one value bool-list is true (not nil)"</span>
   (cl-reduce (<span class="org-keyword">lambda</span> (acc x) (<span class="org-keyword">or</span> acc x)) bool-list <span class="org-builtin">:initial-value</span> nil))

ELISP&gt; (some-p '(t t t t))
t
ELISP&gt; (some-p '(nil t nil nil))
t
ELISP&gt; (some-p '(nil nil nil nil))
nil
</pre>
</div>
</div>
</li></ol>
</div>
</div>

<div id="outline-container-sec-1-6" class="outline-3">
<h3 id="sec-1-6"><span class="section-number-3">1.6</span> Buffer and regions</h3>
<div class="outline-text-3" id="text-1-6">
</div><div id="outline-container-sec-1-6-1" class="outline-4">
<h4 id="sec-1-6-1"><span class="section-number-4">1.6.1</span> Save buffer</h4>
<div class="outline-text-4" id="text-1-6-1">
<div class="org-src-container">

<pre class="src src-elisp">(save-buffer)
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-1-6-2" class="outline-4">
<h4 id="sec-1-6-2"><span class="section-number-4">1.6.2</span> Get buffer content as string</h4>
<div class="outline-text-4" id="text-1-6-2">
<p>
Returns the content of a buffer referencend by its name or the buffer
object.
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">buffer-content</span> (<span class="org-type">&amp;optional</span> buffer-or-name)
    (<span class="org-keyword">with-current-buffer</span> (<span class="org-keyword">if</span> buffer-or-name buffer-or-name (current-buffer))
      (buffer-substring-no-properties (point-min) (point-max)  )))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-6-3" class="outline-4">
<h4 id="sec-1-6-3"><span class="section-number-4">1.6.3</span> Get selected text as string</h4>
<div class="outline-text-4" id="text-1-6-3">
<p>
Returns the selected text of the current buffer.
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">get-selection</span> ()
  <span class="org-doc">"Get the text selected in current buffer as string"</span>
  (<span class="org-keyword">interactive</span>)
  (buffer-substring-no-properties (region-beginning) (region-end)))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-6-4" class="outline-4">
<h4 id="sec-1-6-4"><span class="section-number-4">1.6.4</span> Creating a scratch buffer for Programming Languages</h4>
<div class="outline-text-4" id="text-1-6-4">
<p>
This function creates a Python scratch buffer like elisp <code>*scratch*</code>
which allows the user to play with Python without creating any
file. It is possible to run 
</p>

<p>
It can be easily changed to work with other languages like ruby by
replacing python-mode to ruby-mode.
</p>

<p>
<b>Python Scratch buffer</b>
</p>

<p>
Usage: <span class="underline">M-x python/scratch</span>
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">python/scratch</span> ()
  (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">let</span> (
          <span class="org-comment-delimiter">;; </span><span class="org-comment">Creates a new buffer object.    </span>
         (buf (get-buffer-create <span class="org-string">"*python-scratch*"</span>))
         )
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Executes functions that would change the current buffer at</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">buffer buf </span>
     (<span class="org-keyword">with-current-buffer</span> buf
       <span class="org-comment-delimiter">;;; </span><span class="org-comment">Set the new buffer to scratch mode </span>
       (python-mode)
       <span class="org-comment-delimiter">;;; </span><span class="org-comment">Pop to scratch buffer </span>
       (pop-to-buffer buf)
       )))
</pre>
</div>

<p>
<b>Shell (bash, sh) scratch buffer</b>
</p>

<p>
Usage: M-x sh/scratch
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">sh/scratch</span> ()
  (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">let</span> (
          <span class="org-comment-delimiter">;; </span><span class="org-comment">Creates a new buffer object.    </span>
         (buf (get-buffer-create <span class="org-string">"*sh-scratch*"</span>))
         )
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Executes functions that would change the current buffer at</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">buffer buf </span>
     (<span class="org-keyword">with-current-buffer</span> buf
       <span class="org-comment-delimiter">;;; </span><span class="org-comment">Set the new buffer to scratch mode </span>
       (sh-mode) 
       <span class="org-comment-delimiter">;;; </span><span class="org-comment">Pop to scratch buffer </span>
       (pop-to-buffer buf)
       )))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-1-7" class="outline-3">
<h3 id="sec-1-7"><span class="section-number-3">1.7</span> IO - Input and Output</h3>
<div class="outline-text-3" id="text-1-7">
</div><div id="outline-container-sec-1-7-1" class="outline-4">
<h4 id="sec-1-7-1"><span class="section-number-4">1.7.1</span> Input - Read User Input</h4>
<div class="outline-text-4" id="text-1-7-1">
</div><ol class="org-ol"><li><a id="sec-1-7-1-1" name="sec-1-7-1-1"></a>Prompt functions<br  /><div class="outline-text-5" id="text-1-7-1-1">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Function</th>
<th scope="col" class="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">read-string</td>
<td class="left">Read input as string</td>
</tr>

<tr>
<td class="left">read-file-name</td>
<td class="left">Read input as file name</td>
</tr>

<tr>
<td class="left">read-directory-name</td>
<td class="left">Read input as path to directory</td>
</tr>

<tr>
<td class="left">read-regexp</td>
<td class="left">Read input as regular expression</td>
</tr>

<tr>
<td class="left">read-passwd</td>
<td class="left">Read password</td>
</tr>

<tr>
<td class="left">read-shell-command</td>
<td class="left">Read a shell command.</td>
</tr>

<tr>
<td class="left">read-command</td>
<td class="left">Read an M-x elisp command returning a symbol.</td>
</tr>

<tr>
<td class="left">read-envvar-name</td>
<td class="left">Read environment variable</td>
</tr>

<tr>
<td class="left">read-key</td>
<td class="left">Read a key from the keyboard.</td>
</tr>

<tr>
<td class="left">read-key-sequence</td>
<td class="left">Read a sequence of keystrokes and return as a string or vector.</td>
</tr>

<tr>
<td class="left">read-number</td>
<td class="left">Read a numeric value</td>
</tr>

<tr>
<td class="left">read-regexp</td>
<td class="left">Read regular expression returning it as string.</td>
</tr>

<tr>
<td class="left">&#xa0;</td>
<td class="left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</li>

<li><a id="sec-1-7-1-2" name="sec-1-7-1-2"></a>Read string<br  /><div class="outline-text-5" id="text-1-7-1-2">
<div class="org-src-container">

<pre class="src src-elisp">&gt; (read-string <span class="org-string">"prompt &gt; "</span>) <span class="org-comment-delimiter">;; </span><span class="org-comment">M-x eval-print-last-sexp</span>
<span class="org-string">"user enter some string in minibuffer"</span>
</pre>
</div>

<p>
Ask the user for a string and insert in the buffer
</p>

<div class="org-src-container">

<pre class="src src-elisp">&gt; (insert (concat <span class="org-string">"\n"</span> (read-string <span class="org-string">" prompt &gt; "</span> ))) <span class="org-comment-delimiter">;; </span><span class="org-comment">M-x eval-last-sexp</span>
user enter a message in the minibuffer
</pre>
</div>
</div>
</li>

<li><a id="sec-1-7-1-3" name="sec-1-7-1-3"></a>Read file name<br  /><div class="outline-text-5" id="text-1-7-1-3">
<p>
Reads a file name from the user and gives auto completion. Enter tab
to autocomplete the file name.
</p>

<div class="org-src-container">

<pre class="src src-elisp">&gt; (read-file-name <span class="org-string">"Enter a file name: "</span>) <span class="org-comment-delimiter">;; </span><span class="org-comment">M-x eval-print-last-sexp</span>
<span class="org-string">"/etc/fstab"</span>
</pre>
</div>
</div>
</li>

<li><a id="sec-1-7-1-4" name="sec-1-7-1-4"></a>Read file name and insert at point<br  /><div class="outline-text-5" id="text-1-7-1-4">
<p>
Opens a prompt that asks for the path in the minibuffer with
completion and inserts the path at the current point.
</p>

<ul class="org-ul">
<li>Usage: M-x insert-path
</li>
</ul>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">insert-path</span> ()
  <span class="org-doc">"</span>
<span class="org-doc">   Opens a prompt that asks for the path</span>
<span class="org-doc">   in the minibuffer with completion</span>
<span class="org-doc">   and inserts the path at the current</span>
<span class="org-doc">   point.</span>

<span class="org-doc">   Usage: M-x insert-path</span>

<span class="org-doc">   "</span>
  (<span class="org-keyword">interactive</span>)
  (insert  (read-file-name <span class="org-string">"file &gt; "</span>)))
</pre>
</div>
</div>
</li>

<li><a id="sec-1-7-1-5" name="sec-1-7-1-5"></a>Read a directory path<br  /><div class="outline-text-5" id="text-1-7-1-5">
<div class="org-src-container">

<pre class="src src-elisp">&gt; (read-directory-name <span class="org-string">"Enter a directory: "</span>) <span class="org-comment-delimiter">;; </span><span class="org-comment">M-x eval-print-last-sexp</span>
<span class="org-string">"/var/log"</span>
</pre>
</div>
</div>
</li></ol>
</div>
<div id="outline-container-sec-1-7-2" class="outline-4">
<h4 id="sec-1-7-2"><span class="section-number-4">1.7.2</span> Output</h4>
<div class="outline-text-4" id="text-1-7-2">
</div><ol class="org-ol"><li><a id="sec-1-7-2-1" name="sec-1-7-2-1"></a>Message<br  /><div class="outline-text-5" id="text-1-7-2-1">
<p>
Display a message at the bottom of the screen.
</p>

<div class="org-src-container">

<pre class="src src-elisp">(message <span class="org-string">"A message to the user"</span>)
</pre>
</div>


<div class="figure">
<p><img src="images/emacs_message.png" alt="emacs_message.png" />
</p>
</div>
</div>
</li>

<li><a id="sec-1-7-2-2" name="sec-1-7-2-2"></a>Print<br  /></li>
<li><a id="sec-1-7-2-3" name="sec-1-7-2-3"></a>Princ<br  /></li>
<li><a id="sec-1-7-2-4" name="sec-1-7-2-4"></a>Message box<br  /><div class="outline-text-5" id="text-1-7-2-4">
<p>
Display a message, in a dialog box if possible. If a dialog box is not
available, use the echo area.
</p>

<div class="org-src-container">

<pre class="src src-elisp">(message-box <span class="org-string">"Emacs Alert. Time to drink a coffee!"</span>)
</pre>
</div>


<div class="figure">
<p><img src="images/emacs_messagebox.png" alt="emacs_messagebox.png" />
</p>
</div>
</div>
</li>

<li><a id="sec-1-7-2-5" name="sec-1-7-2-5"></a>Tooltip<br  /><div class="outline-text-5" id="text-1-7-2-5">
<p>
Show a tooltip
</p>

<div class="org-src-container">

<pre class="src src-elisp">(tooltip-show <span class="org-string">"An Emacs tooltip"</span>)
</pre>
</div>


<div class="figure">
<p><img src="images/emacs_show_tooltip.png" alt="emacs_show_tooltip.png" />
</p>
</div>
</div>
</li></ol>
</div>
</div>
<div id="outline-container-sec-1-8" class="outline-3">
<h3 id="sec-1-8"><span class="section-number-3">1.8</span> Shell Commands / Interacting with external applications</h3>
<div class="outline-text-3" id="text-1-8">
</div><div id="outline-container-sec-1-8-1" class="outline-4">
<h4 id="sec-1-8-1"><span class="section-number-4">1.8.1</span> Related Documentation</h4>
<div class="outline-text-4" id="text-1-8-1">
<p>
[C-h-f] &lt;name of function&gt;
</p>

<ul class="org-ul">
<li><a href="(describe-function%20'shell-command)">shell-command</a>
</li>

<li>async-shell-command
</li>

<li>start-process
</li>

<li>call-process
</li>

<li>shell-command-to-string
</li>

<li>shell-command-on-region
</li>

<li>getenv
</li>

<li>setenv
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1-8-2" class="outline-4">
<h4 id="sec-1-8-2"><span class="section-number-4">1.8.2</span> Synchronous Shell Commands</h4>
<div class="outline-text-4" id="text-1-8-2">
</div><ol class="org-ol"><li><a id="sec-1-8-2-1" name="sec-1-8-2-1"></a>Display output of shell command<br  /><div class="outline-text-5" id="text-1-8-2-1">
<div class="org-src-container">

<pre class="src src-elisp">(shell-command <span class="org-string">"uname -a"</span>) <span class="org-comment-delimiter">;; </span><span class="org-comment">M-x eval-last-sexp</span>
</pre>
</div>


<div class="figure">
<p><img src="images/emacs_shell_command_output.png" alt="emacs_shell_command_output.png" />
</p>
</div>
</div>
</li>

<li><a id="sec-1-8-2-2" name="sec-1-8-2-2"></a>Display output of shell command in another frame&#xa0;&#xa0;&#xa0;<span class="tag"><span class="shell">shell</span>&#xa0;<span class="command">command</span>&#xa0;<span class="frame">frame</span></span><br  /><div class="outline-text-5" id="text-1-8-2-2">
<p>
Display PCI cards in another frame.
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">with-selected-frame</span> (make-frame)
  (shell-command <span class="org-string">"lspci"</span>))
</pre>
</div>
</div>
</li>

<li><a id="sec-1-8-2-3" name="sec-1-8-2-3"></a>Shell Command To String&#xa0;&#xa0;&#xa0;<span class="tag"><span class="shell">shell</span>&#xa0;<span class="string">string</span></span><br  /><div class="outline-text-5" id="text-1-8-2-3">
<div class="org-src-container">

<pre class="src src-elisp">&gt; (shell-command-to-string <span class="org-string">"uname -a"</span>)  <span class="org-comment-delimiter">;; </span><span class="org-comment">M-x eval-print-last-sexp</span>
<span class="org-string">"Linux localhost 4.7.0-1-ARCH #1 SMP PREEMPT Mon Aug 8 22:05:58 CEST 2016 x86_64 GNU/Linux</span>
<span class="org-string">"</span>

&gt; (insert (format <span class="org-string">"\nKernel version %s "</span> (shell-command-to-string <span class="org-string">"uname -r"</span>))) <span class="org-comment-delimiter">;; </span><span class="org-comment">M-x eval-last-sexp</span>

Kernel version 4.7.0-1-ARCH
 nil

(<span class="org-keyword">defun</span> <span class="org-function-name">insert-debug-info</span> ()
  (<span class="org-keyword">interactive</span>)

  (insert (concat <span class="org-string">"Kernel version : "</span>) (shell-command-to-string <span class="org-string">"uname -r"</span>))
  (insert (concat <span class="org-string">"Linux distribution : "</span>) (shell-command-to-string <span class="org-string">"cat /etc/issue"</span>))
  (insert (concat <span class="org-string">"Gcc version :"</span>) (shell-command-to-string <span class="org-string">"gcc --version | grep GCC"</span>))
  )
<span class="org-comment-delimiter">;; </span><span class="org-comment">M-x insert-debug-info</span>

Kernel version : 4.7.0-1-ARCH
Linux distribution : Arch Linux \r (\l)

Gcc version <span class="org-builtin">:gcc</span> (GCC) 6.1.1 20160802
</pre>
</div>
</div>
</li>

<li><a id="sec-1-8-2-4" name="sec-1-8-2-4"></a>Shell Command Wrappers<br  /><div class="outline-text-5" id="text-1-8-2-4">
<p>
The function shell-command-to-lines runs a shell command and returns
the output lines. This function is useful to create shell command
wrappers over Unix shell commands like find.
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">shell-command-to-lines</span> (command)
  (remove-if-not  (<span class="org-keyword">lambda</span> (s) (/= (length s) 0))
                  (split-string
                   (shell-command-to-string command) <span class="org-string">"\n"</span>)))


ELISP&gt; (mapc #'princ (shell-command-to-lines <span class="org-string">"ls /var/log"</span>))
btmpfailloghttpdjournallastlogoldpacman.logsambaspeech-dispatcherwtmpXorg.0.logXorg.0.log.old
(<span class="org-string">"btmp"</span> <span class="org-string">"faillog"</span> <span class="org-string">"httpd"</span> <span class="org-string">"journal"</span> <span class="org-string">"lastlog"</span> <span class="org-string">"old"</span> <span class="org-string">"pacman.log"</span> <span class="org-string">"samba"</span> <span class="org-string">"speech-dispatcher"</span> <span class="org-string">"wtmp"</span> <span class="org-string">"Xorg.0.log"</span> <span class="org-string">"Xorg.0.log.old"</span>)

ELISP&gt; (mapc (<span class="org-keyword">lambda</span> (p) (princ p) (princ <span class="org-string">"\n"</span>)) (shell-command-to-lines <span class="org-string">"ls /var/log"</span>))
btmp
faillog
httpd
journal
lastlog
old
pacman.log
samba
speech-dispatcher
wtmp
Xorg.0.log
Xorg.0.log.old
</pre>
</div>

<p>
Example: Shell command wrapper find
</p>

<div class="org-src-container">

<pre class="src src-elisp">ELISP&gt; (mapc (<span class="org-keyword">lambda</span> (p) (princ p) (princ <span class="org-string">"\n"</span>))  (shell-command-to-lines <span class="org-string">"find ~/.local/share/ -name \"*.desktop\""</span>))
/home/arch/.local/share/xfce4/helpers/custom-WebBrowser.desktop
/home/arch/.local/share/applications/userapp-mono-IAJQMY.desktop
/home/arch/.local/share/applications/userapp-sh-9VFBMY.desktop
/home/arch/.local/share/applications/userapp-em-FLD8LY.desktop
/home/arch/.local/share/applications/userapp-mpv-FLQ9LY.desktop
/home/arch/.local/share/applications/userapp-Firefox-SOBHMY.desktop

(<span class="org-keyword">defun</span> <span class="org-function-name">search-files</span> (directory pattern)
  (shell-command-to-lines
   (format <span class="org-string">"find %s -name '%s'"</span>
           directory
           pattern)))

ELISP&gt; (search-files <span class="org-string">"~/.local"</span> <span class="org-string">"*.desktop"</span>) <span class="org-comment-delimiter">;; </span><span class="org-comment">Output changed to fit in the screen</span>
(<span class="org-string">"/home/arch/.local/share/xfce4/helpers/custom-WebBrowser.desktop"</span>
<span class="org-string">"/home/arch/.local/share/applications/userapp-mono-IAJQMY.desktop"</span>
<span class="org-string">"/home/arch/.local/share/applications/userapp-sh-9VFBMY.desktop"</span>
<span class="org-string">"/home/arch/.local/share/applications/userapp-em-FLD8LY.desktop"</span>
...
)


ELISP&gt; (mapc (<span class="org-keyword">lambda</span> (p) (princ p) (princ <span class="org-string">"\n"</span>)) (search-files <span class="org-string">"~/.local"</span> <span class="org-string">"*.desktop"</span>))

/home/arch/.local/share/xfce4/helpers/custom-WebBrowser.desktop
/home/arch/.local/share/applications/userapp-mono-IAJQMY.desktop
/home/arch/.local/share/applications/userapp-sh-9VFBMY.desktop
/home/arch/.local/share/applications/userapp-em-FLD8LY.desktop
/home/arch/.local/share/applications/userapp-mpv-FLQ9LY.desktop
/home/arch/.local/share/applications/userapp-Firefox-SOBHMY.desktop
</pre>
</div>
</div>
</li></ol>
</div>

<div id="outline-container-sec-1-8-3" class="outline-4">
<h4 id="sec-1-8-3"><span class="section-number-4">1.8.3</span> Pipe a region to external command&#xa0;&#xa0;&#xa0;<span class="tag"><span class="terminal">terminal</span>&#xa0;<span class="shell">shell</span>&#xa0;<span class="command">command</span>&#xa0;<span class="pipe">pipe</span>&#xa0;<span class="interface">interface</span></span></h4>
<div class="outline-text-4" id="text-1-8-3">
</div><ol class="org-ol"><li><a id="sec-1-8-3-1" name="sec-1-8-3-1"></a>Pipe buffer or region to external command<br  /><div class="outline-text-5" id="text-1-8-3-1">
<p>
Pipes the buffer content to external command and print the output in
the buffer <code>*Shell Command Output*</code>. The command <code>$ wc -l</code> counts the
number of line of the current file.
</p>

<div class="org-src-container">

<pre class="src src-elisp">&gt; (shell-command-on-region (point-min) (point-max) <span class="org-string">"wc -l"</span>) <span class="org-comment-delimiter">;; </span><span class="org-comment">M-x eval-last-sexp</span>
</pre>
</div>

<p>
Pipes the buffer content to external command <code>$wc -l</code> and get the
output as a string.
</p>

<div class="org-src-container">

<pre class="src src-elisp">&gt; (<span class="org-keyword">with-output-to-string</span>  <span class="org-comment-delimiter">;; </span><span class="org-comment">M-x eval-print-last-sexp</span>
      (shell-command-on-region (point-min) (point-max) <span class="org-string">"wc -l"</span>))
<span class="org-string">""</span>

(<span class="org-keyword">defun</span> <span class="org-function-name">pipe-region-to-command</span> (pmin pmax command)
  (<span class="org-keyword">interactive</span>)

  (shell-command-on-region
   pmin
   pmax
   command
   <span class="org-string">"*shell-output*"</span>
   )

  (<span class="org-keyword">let</span> (
        (output  (<span class="org-keyword">with-current-buffer</span> <span class="org-string">"*shell-output*"</span>
                    (buffer-substring-no-properties (point-min) (point-max))))
        )

    (kill-buffer <span class="org-string">"*shell-output*"</span>)
    output
    )
  )


&gt; (pipe-region-to-command (point-min) (point-max) <span class="org-string">"wc -l"</span>) <span class="org-comment-delimiter">;; </span><span class="org-comment">M-x eval-print-last-sexp</span>
<span class="org-string">"1515</span>
<span class="org-string">"</span>
</pre>
</div>
</div>
</li>

<li><a id="sec-1-8-3-2" name="sec-1-8-3-2"></a>Apply an external command to buffer<br  /><div class="outline-text-5" id="text-1-8-3-2">
<p>
The command below will pipe the buffer <code>*scratch*</code> to the command =$
sed 's/foo.*/bar/g'= which replaces all values of foo for bar.
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">with-current-buffer</span> <span class="org-string">"*scratch*"</span>
    (shell-command-on-region (point-min) (point-max) <span class="org-string">"sed 's/foo.*/bar/g'"</span> <span class="org-string">"*shell-output*"</span> t )

) <span class="org-comment-delimiter">;; </span><span class="org-comment">M-x eval-last-sexp</span>
</pre>
</div>

<p>
Before the form evaluation
</p>


<div class="figure">
<p><img src="images/shell-on-region-before.png" alt="shell-on-region-before.png" />
</p>
</div>

<p>
After the form evaluation.
</p>


<div class="figure">
<p><img src="images/shell-on-region-after.png" alt="shell-on-region-after.png" />
</p>
</div>
</div>
</li>

<li><a id="sec-1-8-3-3" name="sec-1-8-3-3"></a>Function to apply an external command to buffer<br  /><div class="outline-text-5" id="text-1-8-3-3">
<p>
Usage: M-x shell-command-on-buffer Enter: sed 's/defun/defn/g' eplaces
all defun words by defn.
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">shell-command-on-buffer</span> (<span class="org-type">&amp;optional</span> command)
  <span class="org-doc">"Apply a shell command in the current buffer and replace it by the command output.</span>

<span class="org-doc">   Example:</span>
<span class="org-doc">            - Interactive usage:  M-x shell-command-on-buffer Enter: sed 's/defun/defn/g'.</span>
<span class="org-doc">                                  replaces all defun words by defn.</span>

<span class="org-doc">            - (shell-command-on-buffer \"sed 's/defun/defn/g'\")</span>
<span class="org-doc">  "</span>

  (<span class="org-keyword">interactive</span>)

  (shell-command-on-region (point-min)
                           (point-max)
                           (<span class="org-keyword">if</span> command command (read-string <span class="org-string">"Cmd on buffer: "</span>))
                           <span class="org-string">"*shell-output*"</span>
                           t
                           )
  )
</pre>
</div>
</div>
</li>

<li><a id="sec-1-8-3-4" name="sec-1-8-3-4"></a>Insert line number in all lines of a buffer using ruby<br  /><div class="outline-text-5" id="text-1-8-3-4">
<p>
Enter M-x <span class="underline">shell-command-on-buffer</span> and then $ ruby -ne 'printf("-%6s%s", $., $_)'
</p>

<div class="org-src-container">

<pre class="src src-ruby">ruby -ne <span class="org-string">'printf("-%6s%s", $., $_)'</span>
</pre>
</div>

<p>
Before running the command:
</p>


<div class="figure">
<p><img src="images/shell-ruby-on-buffer-before.png" alt="shell-ruby-on-buffer-before.png" />
</p>
</div>

<p>
After running the command:
</p>


<div class="figure">
<p><img src="images/shell-ruby-on-buffer-after.png" alt="shell-ruby-on-buffer-after.png" />
</p>
</div>
</div>
</li>

<li><a id="sec-1-8-3-5" name="sec-1-8-3-5"></a>Ruby command on buffer<br  /><div class="outline-text-5" id="text-1-8-3-5">
<p>
This function applies a ruby batch command on the buffer.
</p>

<p>
See also: <a href="http://reference.jumpingmonkey.org/programming_languages/ruby/ruby-one-liners.html">Ruby One-Liners</a>
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">ruby-on-buffer</span> (<span class="org-type">&amp;optional</span> command)
  <span class="org-doc">"</span>
<span class="org-doc">   Applies a ruby command on buffer</span>

<span class="org-doc">   Example: The command will number each line of the current buffer.</span>

<span class="org-doc">            1. M-x ruby-on-buffer</span>
<span class="org-doc">            2. type: 'printf(\"%6s%s\", $., $_)' without quotes.</span>
<span class="org-doc">   "</span>
  (<span class="org-keyword">interactive</span>)

  (shell-command-on-buffer
   (format <span class="org-string">"ruby -ne '%s'"</span>
           (<span class="org-keyword">if</span> command
               command
             (read-string <span class="org-string">"ruby cmd &gt;"</span>)))))
</pre>
</div>


<div class="figure">
<p><img src="images/ruby-command-on-buffer.png" alt="ruby-command-on-buffer.png" />
</p>
</div>
</div>
</li>

<li><a id="sec-1-8-3-6" name="sec-1-8-3-6"></a>Ruby regex on buffer<br  /><div class="outline-text-5" id="text-1-8-3-6">
<p>
Emacs regexp islimited and doesn't have lookahead like perl or ruby
regex. This command can extend the functionality of Emacs regex using
ruby. This function applies a ruby regex on the buffer.
</p>

<p>
Usage: M-x ruby-gsub-on-buffer
</p>

<p>
See also: <a href="http://reference.jumpingmonkey.org/programming_languages/ruby/ruby-one-liners.html">Ruby One-Liners</a>
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">ruby-gsub-on-buffer</span> (<span class="org-type">&amp;optional</span> regexp)
   <span class="org-doc">"</span>
<span class="org-doc">   Applies ruby regex, the command $ ruby -pe 'gsub(regexp)'</span>
<span class="org-doc">   on the current buffer.</span>

<span class="org-doc">   Usage M-x ruby-gsub-on-buffer</span>
<span class="org-doc">         (ruby-gsub-on-buffer &lt;regexp&gt;)</span>

<span class="org-doc">   Example: The Command replace all occurrences</span>
<span class="org-doc">            of 'defun' by 'defn'.</span>

<span class="org-doc">            1. M-x ruby-gsub-on-buffer</span>
<span class="org-doc">            2. Type /defun/,\"defn\"</span>

<span class="org-doc">   "</span>
   (<span class="org-keyword">interactive</span>)

   (shell-regexp-on-buffer
    (format <span class="org-string">"ruby -pe 'gsub(%s)'"</span>
           (<span class="org-keyword">if</span> regexp
               regexp
             (read-string <span class="org-string">"ruby regex: "</span>)))))
</pre>
</div>
</div>
</li></ol>
</div>

<div id="outline-container-sec-1-8-4" class="outline-4">
<h4 id="sec-1-8-4"><span class="section-number-4">1.8.4</span> Launch apps in Asynchronous mode</h4>
</div>
<div id="outline-container-sec-1-8-5" class="outline-4">
<h4 id="sec-1-8-5"><span class="section-number-4">1.8.5</span> Run asynchronous commands piping the output to a buffer</h4>
<div class="outline-text-4" id="text-1-8-5">
</div><ol class="org-ol"><li><a id="sec-1-8-5-1" name="sec-1-8-5-1"></a>Ping a host<br  /><div class="outline-text-5" id="text-1-8-5-1">
<ul class="org-ul">
<li><code>(start-process NAME BUFFER PROGRAM &amp;rest PROGRAM-ARGS</code>
</li>
</ul>

<p>
Usage: M-x ping-host or (ping-host &lt;hostname&gt;)
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">ping-host</span> (<span class="org-type">&amp;optional</span> hostname)
  <span class="org-doc">"</span>
<span class="org-doc">  Ping a hostname.</span>

<span class="org-doc">  Usage:</span>
<span class="org-doc">        - Interactive: M-x ping-host</span>
<span class="org-doc">        - Command:     (ping-host &lt;hostname&gt;)</span>

<span class="org-doc">  Example: (ping-host \"www.google.com\")</span>
<span class="org-doc">           (ping-host \"192.168.0.1\")</span>
<span class="org-doc">  "</span>
  (<span class="org-keyword">interactive</span>)

  (<span class="org-keyword">let</span>
      (
       (hostname- (<span class="org-keyword">if</span> hostname hostname (read-string <span class="org-string">"host to ping: "</span>)))
       )

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-selected-frame (make-frame)</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">;;</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; Process name:    ping</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; Process buffer: *ping*</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; Command:         ping &lt;hostname&gt;</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">;;</span>

    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(start-process "ping" "*ping*" "ping" hostname-)</span>

    <span class="org-comment-delimiter">;;   </span><span class="org-comment">)</span>

    (start-process <span class="org-string">"ping"</span> <span class="org-string">"*ping*"</span> <span class="org-string">"ping"</span> hostname-)
    (switch-to-buffer-other-frame <span class="org-string">"*ping*"</span>)
    ))
</pre>
</div>


<div class="figure">
<p><img src="images/emacs_shell_ping_hostname.png" alt="emacs_shell_ping_hostname.png" />
</p>
</div>
</div>
</li>

<li><a id="sec-1-8-5-2" name="sec-1-8-5-2"></a>Tracerote a host<br  /><div class="outline-text-5" id="text-1-8-5-2">
<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">traceroute-host</span> (<span class="org-type">&amp;optional</span> hostname)
  <span class="org-doc">"</span>
<span class="org-doc">  Ping a hostname.</span>

<span class="org-doc">  Usage:</span>
<span class="org-doc">        - Interactive: M-x traceroute-host [Enter the hostname]</span>
<span class="org-doc">        - Command:     (traceroute-host &lt;hostname&gt;)</span>

<span class="org-doc">  Example: (traceroute-host \"www.yahoo.co.uk\")</span>

<span class="org-doc">  "</span>
  (<span class="org-keyword">interactive</span>)

  (<span class="org-keyword">let</span>
      (
       (hostname- (<span class="org-keyword">if</span> hostname hostname (read-string <span class="org-string">"host to traceroute: "</span>)))
       )

    (start-process <span class="org-string">"traceroute"</span> <span class="org-string">"*traceroute*"</span> <span class="org-string">"traceroute"</span> hostname-)
    (switch-to-buffer-other-frame <span class="org-string">"*traceroute*"</span>)
    ))
</pre>
</div>
</div>
</li></ol>
</div>

<div id="outline-container-sec-1-8-6" class="outline-4">
<h4 id="sec-1-8-6"><span class="section-number-4">1.8.6</span> Run a ncurses / terminal app inside Emacs</h4>
<div class="outline-text-4" id="text-1-8-6">
<p>
Run linux htop (task manager) inside Emacs:
</p>

<div class="org-src-container">

<pre class="src src-elisp">(term <span class="org-string">"htop"</span>) <span class="org-comment-delimiter">;; </span><span class="org-comment">C-x C-e or M-x eval-last-sexp</span>
</pre>
</div>


<div class="figure">
<p><img src="images/emacs_ncurses_term.png" alt="emacs_ncurses_term.png" />
</p>
</div>
</div>
</div>
<div id="outline-container-sec-1-8-7" class="outline-4">
<h4 id="sec-1-8-7"><span class="section-number-4">1.8.7</span> Run apps in external terminal emulator&#xa0;&#xa0;&#xa0;<span class="tag"><span class="terminal">terminal</span>&#xa0;<span class="shell">shell</span>&#xa0;<span class="os">os</span>&#xa0;<span class="command">command</span></span></h4>
<div class="outline-text-4" id="text-1-8-7">
<p>
Some Linux ncurses-based applications like Htop, Top, Nmtui (Network
Manager's terminal UI) doesn't work well running in Emacs terminal
emulator <code>M-x term</code> or <code>M-x ansi-term</code>. The solution is run the
command from Emacs and send to an external terminal emulator.
</p>

<p>
<b>Read a command in launch in terminal</b>
</p>

<p>
This command uses xfce4-terminal but it can be changed to any other
terminal emulator.
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">run-terminal</span> ()
  <span class="org-doc">"Launch application in a terminal emulator."</span>
  (<span class="org-keyword">interactive</span>)
  (start-process
   <span class="org-string">"termx"</span>
   nil
   <span class="org-comment-delimiter">;; </span><span class="org-comment">Change this for your terminal.</span>
   <span class="org-string">"xfce4-terminal"</span> <span class="org-string">"-e"</span> (read-shell-command <span class="org-string">"Shell: "</span>)
   ))
</pre>
</div>

<p>
<b>Launch specific commands</b>
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">shell-command-in-terminal</span> (command)
  (start-process
   <span class="org-string">"termx"</span>
   nil
   <span class="org-comment-delimiter">;; </span><span class="org-comment">Change this for your terminal.</span>
   <span class="org-string">"xfce4-terminal"</span> <span class="org-string">"-e"</span> command
   ))
</pre>
</div>

<p>
To launch htop:
</p>

<div class="org-src-container">

<pre class="src src-elisp">(shell-command-in-terminal <span class="org-string">"htop"</span>)
</pre>
</div>

<p>
To launch nmtui:
</p>

<div class="org-src-container">

<pre class="src src-elisp">(shell-command-in-terminal <span class="org-string">"nmtui"</span>)
</pre>
</div>

<p>
Command <code>M-x htop</code> to launch htop.
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">htop</span> ()
  <span class="org-doc">"Launch htop task manager."</span>
  (<span class="org-keyword">interactive</span>)
  (shell-command-in-terminal <span class="org-string">"htop"</span>))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-1-8-8" class="outline-4">
<h4 id="sec-1-8-8"><span class="section-number-4">1.8.8</span> Launch applicatiosn from Emacs</h4>
<div class="outline-text-4" id="text-1-8-8">
<p>
This command asks the user a shell command providing tab completion
and launches an asynchronous process (it doesn't freeze Emacs). Unlike
asynchronous-shell-command this command doesn't create a new
buffer. It is useful to launch desktop GUI applications from Emacs
like Firefox, terminal emulator, file mangers and so on.
</p>

<p>
Note: In order to this command find the app the directory of the app
must be in the $PATH variable. 
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">shell-launch</span> ()
  <span class="org-doc">"Launch a process without creating a buffer. It is useful to launch apps from Emacs."</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">let*</span> ((cmd-raw  (read-shell-command <span class="org-string">"Launch command: "</span>))
         (cmd-args (split-string-and-unquote cmd-raw))
         (cmd      (car cmd-args))       <span class="org-comment-delimiter">;; </span><span class="org-comment">program that will run</span>
         (args     (cdr cmd-args)))     <span class="org-comment-delimiter">;; </span><span class="org-comment">command arguments</span>
    (apply #'start-process `(,cmd
                             nil
                             ,cmd ,@args
                             ))))
</pre>
</div>

<p>
This comamnd can be bound to a keybiding with the code bellow that
bidns the key combination SUPER (Windows Key) + 8.
</p>

<div class="org-src-container">

<pre class="src src-elisp">(global-set-key (kbd <span class="org-string">"s-8"</span>) #'shell-launch)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-8-9" class="outline-4">
<h4 id="sec-1-8-9"><span class="section-number-4">1.8.9</span> Send regions, commands and buffer to M-x shell repl.</h4>
<div class="outline-text-4" id="text-1-8-9">
<ul class="org-ul">
<li><span class="underline">M-x shell/buffer-repl</span> This command deletes all other windows and
splits the current frame into two windows one containing a M-x
shell (bash) repl and the other a shell-script scratch buffer
(sh-mode).
</li>

<li><span class="underline">M-x shell/buffer-repl-frame</span> Like the shell/buffer-repl, but shell
and the scratch buffer are displayed in new frame.
</li>
</ul>


<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">shell/buffer-repl</span> ()
  <span class="org-doc">"Create "</span>
  (<span class="org-keyword">interactive</span>)

  (delete-other-windows)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Split window vertically</span>
  (split-window-right)

  <span class="org-comment-delimiter">;;; </span><span class="org-comment">Run shell (bash on Linux)</span>
  (shell)

  <span class="org-comment-delimiter">;;; </span><span class="org-comment">Creates a scratch-shell buffer on other half of window</span>
  (<span class="org-keyword">let</span> ((buf (get-buffer-create <span class="org-string">"*shell-buffer*"</span>)))
    (<span class="org-keyword">with-current-buffer</span> buf
      (sh-mode)
      (pop-to-buffer buf))))

(<span class="org-keyword">defun</span> <span class="org-function-name">shell/buffer-repl-frame</span> ()
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">with-selected-frame</span> (make-frame)
    (shell/buffer-repl)))
</pre>
</div>


<p>
This functions are useful to send regions, lines and regions to <code>M-x shell</code> repl
from a shell-buffer or shell scratch buffer to the repl.
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">shell/send-region</span> ()
  <span class="org-doc">"Send selected text to M-x shell repl."</span>
  (<span class="org-keyword">interactive</span>)
  (comint-send-region (get-buffer-process <span class="org-string">"*shell*"</span> )
                      (region-beginning) (region-end))
  (comint-send-string (get-buffer-process <span class="org-string">"*shell*"</span> ) <span class="org-string">"\n"</span>))

(<span class="org-keyword">defun</span> <span class="org-function-name">shell/insert-region</span> ()
  <span class="org-doc">"Insert selected text into M-x shell repl and run it."</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">let</span> ((text (buffer-substring-no-properties (region-beginning)
                                              (region-end)
                                              )))
  (<span class="org-keyword">with-current-buffer</span> <span class="org-string">"*shell*"</span>
    (insert text)
    (comint-send-input)
    )))


(<span class="org-keyword">defun</span> <span class="org-function-name">shell/send-line</span> ()
  <span class="org-doc">"Send current line to M-x shell repl."</span>
  (<span class="org-keyword">interactive</span>)
  (comint-send-region (get-buffer-process <span class="org-string">"*shell*"</span>)
                      (line-beginning-position)
                      (line-end-position)
                      )
  (comint-send-string (get-buffer-process <span class="org-string">"*shell*"</span> ) <span class="org-string">"\n"</span>))


(<span class="org-keyword">defun</span> <span class="org-function-name">shell/insert-line</span> ()
  <span class="org-doc">"Insert current line to M-x shell repl."</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">let</span> ((line (buffer-substring-no-properties
               (line-beginning-position)
               (line-end-position)
               )))
  (<span class="org-keyword">with-current-buffer</span> <span class="org-string">"*shell*"</span>
    (insert line)
    (comint-send-input)
    )))


(<span class="org-keyword">defun</span> <span class="org-function-name">shell/execute-line</span> ()
  <span class="org-doc">"Execute current line as shell command."</span>
  (<span class="org-keyword">interactive</span>)
  (shell-command
   (buffer-substring (line-beginning-position)
                     (line-end-position))))

(<span class="org-keyword">defun</span> <span class="org-function-name">shell/execute-region</span> ()
  <span class="org-doc">"Execute current region as shell command."</span>
  (<span class="org-keyword">interactive</span>)
  (shell-command
   (buffer-substring (region-beginning)
                     (region-end))))

(<span class="org-keyword">defun</span> <span class="org-function-name">shell/insert-buffer</span> ()
  <span class="org-doc">"Insert all buffer content into M-x shell repl and run it."</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">let</span> ((text (buffer-substring-no-properties (point-min)
                                              (point-max)
                                              )))
  (<span class="org-keyword">with-current-buffer</span> <span class="org-string">"*shell*"</span>
    (insert text)
    (comint-send-input)
    )))
</pre>
</div>


<p>
Example:
</p>

<ol class="org-ol">
<li>User runs M-x shell/buffer-repl-frame. It will open a frame like
in the picture bellow.
</li>
</ol>


<ol class="org-ol">
<li>User select the region with some code and runs <span class="underline">M-x shell/insert-region</span>.
It will send the current region to the shell repl and display the
output, in this case the content of root directory.
</li>
</ol>


<div class="figure">
<p><img src="images/faf2389f-7c67-43fb-af0a-125f1c1d28eb.png" alt="faf2389f-7c67-43fb-af0a-125f1c1d28eb.png" />
</p>
<p><span class="figure-number">Figure 12:</span> Example of M-x shell/buffer-repl-frame.</p>
</div>


<div class="figure">
<p><img src="images/shell-demo2.gif" alt="shell-demo2.gif" />
</p>
<p><span class="figure-number">Figure 13:</span> Demonstration of M-x shell/buffer-repl-frame and shell/insert-region</p>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-1-9" class="outline-3">
<h3 id="sec-1-9"><span class="section-number-3">1.9</span> File</h3>
<div class="outline-text-3" id="text-1-9">
</div><div id="outline-container-sec-1-9-1" class="outline-4">
<h4 id="sec-1-9-1"><span class="section-number-4">1.9.1</span> Test if file or directory exists</h4>
<div class="outline-text-4" id="text-1-9-1">
<div class="org-src-container">

<pre class="src src-elisp">&gt; (file-exists-p <span class="org-string">"/var/log/pacman.log"</span>) <span class="org-comment-delimiter">;; </span><span class="org-comment">M-x eval-print-last-sexp</span>
t

&gt; (file-exists-p <span class="org-string">"/var/log/pcaman.log.err"</span>)
nil
 <span class="org-comment-delimiter">;;</span>
&gt; (file-exists-p <span class="org-string">"/var/log"</span>)
t
 <span class="org-comment-delimiter">;;</span>
&gt; (file-exists-p <span class="org-string">"/var/log-dont-exists"</span>)
nil
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-9-2" class="outline-4">
<h4 id="sec-1-9-2"><span class="section-number-4">1.9.2</span> Expand file name</h4>
<div class="outline-text-4" id="text-1-9-2">
<div class="org-src-container">

<pre class="src src-elisp">ELISP&gt; (expand-file-name <span class="org-string">"~"</span>)
<span class="org-string">"/home/arch"</span>

ELISP&gt; (expand-file-name <span class="org-string">"~/.emacs.d/init.el"</span>)
<span class="org-string">"/home/arch/.emacs.d/init.el"</span>

ELISP&gt; (expand-file-name <span class="org-string">"."</span>)
<span class="org-string">"/home/arch/projects/emacs"</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-9-3" class="outline-4">
<h4 id="sec-1-9-3"><span class="section-number-4">1.9.3</span> Read file to string</h4>
<div class="outline-text-4" id="text-1-9-3">
<p>
The Emacs API doesn't provide a straightforward way to read file
directly to a string. The only way to perform this taks is using a
temporary buffer.
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">read-file</span> (filename)
  (<span class="org-keyword">with-temp-buffer</span>
    (insert-file-contents filename)
    (buffer-substring-no-properties (point-min) (point-max))))

ELISP&gt; (read-file <span class="org-string">"/etc/host.conf"</span>)
<span class="org-string">"#\n# /etc/host.conf\n#\n\norder hosts,bind\nmulti on\n\n# End of file\n"</span>

ELISP&gt; (princ (read-file <span class="org-string">"/etc/host.conf"</span>))
#
# /etc/host.conf
#

order hosts,bind
multi on

# End of file
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-9-4" class="outline-4">
<h4 id="sec-1-9-4"><span class="section-number-4">1.9.4</span> Open file to edit</h4>
<div class="outline-text-4" id="text-1-9-4">
</div><ol class="org-ol"><li><a id="sec-1-9-4-1" name="sec-1-9-4-1"></a>Open file to edit in current window<br  /><div class="outline-text-5" id="text-1-9-4-1">
<div class="org-src-container">

<pre class="src src-elisp">&gt; (find-file <span class="org-string">"/etc/fstab"</span>)
</pre>
</div>
</div>
</li>

<li><a id="sec-1-9-4-2" name="sec-1-9-4-2"></a>Open file to edit in anther window<br  /><div class="outline-text-5" id="text-1-9-4-2">
<div class="org-src-container">

<pre class="src src-elisp">(find-file-other-window <span class="org-string">"/etc/fstab"</span>)
</pre>
</div>
</div>
</li>

<li><a id="sec-1-9-4-3" name="sec-1-9-4-3"></a>Open file to edit in anther frame<br  /><div class="outline-text-5" id="text-1-9-4-3">
<div class="org-src-container">

<pre class="src src-elisp">(find-file-other-frame <span class="org-string">"/etc/fstab"</span>)
</pre>
</div>
</div>
</li></ol>
</div>

<div id="outline-container-sec-1-9-5" class="outline-4">
<h4 id="sec-1-9-5"><span class="section-number-4">1.9.5</span> Open file to edit silently</h4>
<div class="outline-text-4" id="text-1-9-5">
<p>
Function: find-file-nonselect
</p>

<p>
Emacs Documentation: Read file FILENAME into a buffer and return the
buffer.If a buffer exists visiting FILENAME, return that one, but
verify that the file has not changed since visited or saved. The
buffer is not selected, just returned to the caller.
</p>

<p>
Open a file and returns a buffer:
</p>

<div class="org-src-container">

<pre class="src src-elisp">&gt; (<span class="org-keyword">setq</span> b1 (find-file-noselect <span class="org-string">"~/.bashrc"</span>))
#&lt;buffer .bashrc&gt;

&gt; b1
#&lt;buffer .bashrc&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-9-6" class="outline-4">
<h4 id="sec-1-9-6"><span class="section-number-4">1.9.6</span> Edit File as Root&#xa0;&#xa0;&#xa0;<span class="tag"><span class="utils">utils</span>&#xa0;<span class="edit">edit</span></span></h4>
<div class="outline-text-4" id="text-1-9-6">
<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">open-as-root</span> (filename)
  (<span class="org-keyword">interactive</span>)
  (find-file (concat <span class="org-string">"/sudo:root@localhost:"</span>  filename)))


<span class="org-comment-delimiter">;; </span><span class="org-comment">Example:</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">ELISP&gt; (open-as-root "/etc/host.conf")</span>
<span class="org-comment-delimiter">;;</span>


<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Open an already opened buffer as root</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">M-x open-buffer-as-root</span>
<span class="org-comment-delimiter">;;</span>
(<span class="org-keyword">defun</span> <span class="org-function-name">open-buffer-as-root</span> ()
 (<span class="org-keyword">interactive</span>)
 (<span class="org-keyword">let</span>
     (
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Get the current buffer file name</span>
      (filename (buffer-file-name (current-buffer)))
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Get the current file name</span>
      (bufname  (buffer-name (current-buffer)))
     )
   (<span class="org-keyword">progn</span>
  (kill-buffer bufname)         <span class="org-comment-delimiter">;; </span><span class="org-comment">Kill current buffer</span>
  (open-as-root filename))))    <span class="org-comment-delimiter">;; </span><span class="org-comment">Open File as root</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-1-10" class="outline-3">
<h3 id="sec-1-10"><span class="section-number-3">1.10</span> Directory&#xa0;&#xa0;&#xa0;<span class="tag"><span class="directory">directory</span></span></h3>
<div class="outline-text-3" id="text-1-10">
</div><div id="outline-container-sec-1-10-1" class="outline-4">
<h4 id="sec-1-10-1"><span class="section-number-4">1.10.1</span> Open directory</h4>
<div class="outline-text-4" id="text-1-10-1">
</div><ol class="org-ol"><li><a id="sec-1-10-1-1" name="sec-1-10-1-1"></a>Open directory in current window<br  /><div class="outline-text-5" id="text-1-10-1-1">
<div class="org-src-container">

<pre class="src src-elisp">(dired <span class="org-string">"/var/log"</span>)
</pre>
</div>
</div>
</li>

<li><a id="sec-1-10-1-2" name="sec-1-10-1-2"></a>Open directory in another window<br  /><div class="outline-text-5" id="text-1-10-1-2">
<div class="org-src-container">

<pre class="src src-elisp">(dired-other-window <span class="org-string">"/var/log"</span>)
</pre>
</div>
</div>
</li>

<li><a id="sec-1-10-1-3" name="sec-1-10-1-3"></a>Open directory in another frame<br  /><div class="outline-text-5" id="text-1-10-1-3">
<div class="org-src-container">

<pre class="src src-elisp">(dired-other-frame <span class="org-string">"/var/log"</span>)
</pre>
</div>


<div class="figure">
<p><img src="images/emacs_dired_frame_open_dir.png" alt="emacs_dired_frame_open_dir.png" />
</p>
</div>
</div>
</li></ol>
</div>

<div id="outline-container-sec-1-10-2" class="outline-4">
<h4 id="sec-1-10-2"><span class="section-number-4">1.10.2</span> Create directory</h4>
</div>
<div id="outline-container-sec-1-10-3" class="outline-4">
<h4 id="sec-1-10-3"><span class="section-number-4">1.10.3</span> List directory</h4>
<div class="outline-text-4" id="text-1-10-3">
<p>
Get directory content
</p>

<div class="org-src-container">

<pre class="src src-elisp">ELISP&gt; (directory-files <span class="org-string">"/var/log"</span>)

(<span class="org-string">"."</span> <span class="org-string">".."</span> <span class="org-string">"Xorg.0.log"</span> <span class="org-string">"Xorg.0.log.old"</span> ... )
</pre>
</div>

<p>
Print the directory content in elisp shell IEML.
</p>

<div class="org-src-container">

<pre class="src src-elisp">ELISP&gt; (mapc #'(lambda (p) (princ (concat <span class="org-string">"\n"</span> p)))
               (directory-files <span class="org-string">"/var/log"</span>) )

.
..
Xorg.0.log
Xorg.0.log.old
btmp
faillog
httpd
journal
lastlog
old
pacman.log
samba
speech-dispatcher
wtmp
</pre>
</div>


<p>
Get directory content with absolute file name.
</p>

<div class="org-src-container">

<pre class="src src-elisp">ELISP&gt; (directory-files <span class="org-string">"/var/log"</span> t)
(<span class="org-string">"/var/log/."</span> <span class="org-string">"/var/log/.."</span> <span class="org-string">"/var/log/Xorg.0.log"</span> <span class="org-string">"/var/log/Xorg.0.log.old"</span> ... )

ELISP&gt; (mapc #'(lambda (p) (princ (concat <span class="org-string">"\n"</span> p)))
               (directory-files <span class="org-string">"/var/log"</span> t ))

/var/log/.
/var/log/..
/var/log/Xorg.0.log
/var/log/Xorg.0.log.old
/var/log/btmp
...
</pre>
</div>

<p>
List files of a specific extension:
</p>

<div class="org-src-container">

<pre class="src src-elisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">Files ending with *.conf</span>

ELISP&gt; (directory-files <span class="org-string">"/etc/"</span> nil <span class="org-string">"\\.conf"</span>)
(<span class="org-string">"asound.conf"</span> <span class="org-string">"dhcpcd.conf"</span> <span class="org-string">"fuse.conf"</span> <span class="org-string">"gai.conf"</span> ...)

ELISP&gt; (directory-files <span class="org-string">"/etc/"</span> t <span class="org-string">"\\.conf"</span>)
(<span class="org-string">"/etc/asound.conf"</span> <span class="org-string">"/etc/dhcpcd.conf"</span> <span class="org-string">"/etc/fuse.conf"</span>  ...)

ELISP&gt; (directory-files <span class="org-string">"/etc/"</span> t <span class="org-string">"\\.cfg"</span>)
(<span class="org-string">"/etc/rc_maps.cfg"</span> <span class="org-string">"/etc/vdpau_wrapper.cfg"</span>)

ELISP&gt; (directory-files <span class="org-string">"/etc/"</span> nil <span class="org-string">"\\.cfg"</span>)
(<span class="org-string">"rc_maps.cfg"</span> <span class="org-string">"vdpau_wrapper.cfg"</span>)
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-1-11" class="outline-3">
<h3 id="sec-1-11"><span class="section-number-3">1.11</span> Dired mode snippets&#xa0;&#xa0;&#xa0;<span class="tag"><span class="directory">directory</span>&#xa0;<span class="dired">dired</span></span></h3>
<div class="outline-text-3" id="text-1-11">
</div><div id="outline-container-sec-1-11-1" class="outline-4">
<h4 id="sec-1-11-1"><span class="section-number-4">1.11.1</span> Overview</h4>
<div class="outline-text-4" id="text-1-11-1">
<p>
The dired mode is the mode used by Emacs to browser directories.
</p>

<p>
See also: <a href="https://www.reddit.com/r/emacs/comments/4agkye/how_do_you_customize_dired/">How do you customize dired?</a>
</p>

<p>
Source: <a href="https://gist.github.com/hiroina/4702961">hiroina/.emacs</a>
</p>
</div>
</div>

<div id="outline-container-sec-1-11-2" class="outline-4">
<h4 id="sec-1-11-2"><span class="section-number-4">1.11.2</span> Copy path of file at point</h4>
<div class="outline-text-4" id="text-1-11-2">
<ul class="org-ul">
<li>Copy path of file at point.
</li>
</ul>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">dired-copy-path</span> ()
  <span class="org-doc">"In dired, copy file path to kill-buffer.  At 2nd time it copy current directory to kill-buffer."</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">let</span> (path)
    (<span class="org-keyword">setq</span> path (dired-file-name-at-point))
        (<span class="org-keyword">if</span> (string= path (current-kill 0 1)) (<span class="org-keyword">setq</span> path (dired-current-directory)))
    (message path)
    (kill-new path)
  )
)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-11-3" class="outline-4">
<h4 id="sec-1-11-3"><span class="section-number-4">1.11.3</span> Paste a file from clibpboard</h4>
<div class="outline-text-4" id="text-1-11-3">
<p>
This command pastes a file which path is stored in clibpoard.
</p>

<p>
Usage:
</p>

<ol class="org-ol">
<li>Copy file from clibpoard with Emacs or from system's default file
manager.
</li>

<li>M-x  dired-paste-file-from-clipboard
</li>
</ol>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">dired-paste-file-from-clipboard</span> ()
  <span class="org-doc">"Paste a file from clpboard to current directory."</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">flet</span> ((clipboard-get ()
                        (<span class="org-keyword">with-temp-buffer</span>
                           (clipboard-yank)
                           (buffer-substring-no-properties
                            (point-min)
                            (point-max)))))

    (copy-file (clipboard-get) <span class="org-string">"."</span>)
    (revert-buffer)))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-11-4" class="outline-4">
<h4 id="sec-1-11-4"><span class="section-number-4">1.11.4</span> Create empty file (touch)</h4>
<div class="outline-text-4" id="text-1-11-4">
<ul class="org-ul">
<li>Create empty file at current directory opened in dired mode.
</li>
</ul>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">dired-touch</span> ()
  <span class="org-doc">"Creates empty file at current directory."</span>
  (<span class="org-keyword">interactive</span>)

  (append-to-file <span class="org-string">""</span> nil (read-string <span class="org-string">"New file: "</span>))
  (<span class="org-keyword">if</span> (equal major-mode 'dired-mode)

      (revert-buffer)
      ))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-11-5" class="outline-4">
<h4 id="sec-1-11-5"><span class="section-number-4">1.11.5</span> Open multiple marked files</h4>
<div class="outline-text-4" id="text-1-11-5">
<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">dired-open-files</span> (files)
  <span class="org-doc">"</span>
<span class="org-doc">  Open all marked files in dired mode with m.</span>

<span class="org-doc">  Usage:</span>
<span class="org-doc">        1. Mark the files with m</span>
<span class="org-doc">        2. M-x dired-open-files</span>
<span class="org-doc">  "</span>
  (<span class="org-keyword">interactive</span>  (list (dired-get-marked-files)) )

  (mapc #'find-file files)

  )
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-11-6" class="outline-4">
<h4 id="sec-1-11-6"><span class="section-number-4">1.11.6</span> Close multiple marked files</h4>
<div class="outline-text-4" id="text-1-11-6">
<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">setq</span> lexical-binding t)

(<span class="org-keyword">defun</span> <span class="org-function-name">compose</span> (fn1 fn2)
  (<span class="org-keyword">let</span> ((lexical-binding t))

    (<span class="org-keyword">lambda</span> (x)
       (funcall fn2 (funcall fn1 x))
    )
  ))

(<span class="org-keyword">defun</span> <span class="org-function-name">dired-close-files</span> (files)

  (<span class="org-keyword">interactive</span>  (list (dired-get-marked-files)) )

  (mapc (compose #'get-file-buffer #'kill-buffer) files)

  )
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-11-7" class="outline-4">
<h4 id="sec-1-11-7"><span class="section-number-4">1.11.7</span> Open a file with default system application&#xa0;&#xa0;&#xa0;<span class="tag"><span class="dired">dired</span>&#xa0;<span class="file">file</span>&#xa0;<span class="open">open</span>&#xa0;<span class="system">system</span></span></h4>
<div class="outline-text-4" id="text-1-11-7">
<p>
Usage. Select a file in dired mode and enter <code>M-x dired-xdg</code>
</p>

<p>
Function: xdg-open. Open any file with system's default
application.
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">xdg-open</span> (filename)
    <span class="org-doc">"Open a file FILENAME with default system application.</span>
<span class="org-doc">  This function is operating system independent."</span>
    (<span class="org-keyword">cl-case</span> system-type

      <span class="org-comment-delimiter">;;; </span><span class="org-comment">Linux</span>
      (gnu/linux      (<span class="org-keyword">let</span> ((process-connection-type  nil))

                        (start-process
                            <span class="org-string">"proc"</span>
                            nil
                                          <span class="org-comment-delimiter">;; </span><span class="org-comment">Command</span>
                            <span class="org-string">"xdg-open"</span> (expand-file-name filename))))

      <span class="org-comment-delimiter">;;; </span><span class="org-comment">Free BSD OS</span>
      (gnu/kfreebsd    (<span class="org-keyword">let</span> ((process-connection-type  nil))

                        (start-process
                            <span class="org-string">"proc"</span>
                            nil
                                          <span class="org-comment-delimiter">;; </span><span class="org-comment">Command</span>
                            <span class="org-string">"xdg-open"</span> (expand-file-name filename))))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Mac OSX - (Not tested )</span>
      (darwing        (start-process
                       <span class="org-string">"proc"</span>
                       nil
                       <span class="org-comment-delimiter">;; </span><span class="org-comment">Command</span>
                       <span class="org-string">"open"</span> (concat  (expand-file-name filename))))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Windows 7, 8, 10 - Kernel NT</span>
      (windows-nt   (start-process
                     <span class="org-string">"proc"</span>
                     nil
                     <span class="org-comment-delimiter">;; </span><span class="org-comment">Command</span>
                     <span class="org-string">"cmd"</span>  <span class="org-string">"/C"</span>  <span class="org-string">"start"</span> <span class="org-string">""</span> (expand-file-name filename)
                      )

         )))
</pre>
</div>

<p>
Function: dired-xdg
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">dired-xdg</span> ()
  <span class="org-doc">"Open file at point with systems' default app.</span>
<span class="org-doc">Usage: In the dired mode select a file and type M-x dired-xdg</span>
<span class="org-doc">to execute the file with the system default app.</span>
<span class="org-doc">    "</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">with-current-buffer</span>
        (xdg-open (dired-get-filename))))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-11-8" class="outline-4">
<h4 id="sec-1-11-8"><span class="section-number-4">1.11.8</span> Close all dired buffers</h4>
<div class="outline-text-4" id="text-1-11-8">
<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">dired-close-all</span> ()
  <span class="org-doc">"Close all dired buffers."</span>
  (<span class="org-keyword">interactive</span>)
  (mapc (<span class="org-keyword">lambda</span> (buf)
          (<span class="org-keyword">if</span> (equal (buffer-local-value 'major-mode buf)
                     'dired-mode)
          (kill-buffer buf)))

        (buffer-list)))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-11-9" class="outline-4">
<h4 id="sec-1-11-9"><span class="section-number-4">1.11.9</span> Browse bookmarked directories&#xa0;&#xa0;&#xa0;<span class="tag"><span class="dired">dired</span>&#xa0;<span class="directory">directory</span>&#xa0;<span class="helm">helm</span>&#xa0;<span class="browse">browse</span></span></h4>
<div class="outline-text-4" id="text-1-11-9">
<p>
The function <code>M-x dired-bookmarks</code> opens a helm menu where the user
can select its favorites directories. It provides quick directory
navigation.
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defvar</span> <span class="org-variable-name">dired-bookmarks-path-list</span>
  '(<span class="org-string">"~"</span>
    <span class="org-string">"~/Desktop"</span>
    <span class="org-string">"~/Downloads"</span>
    <span class="org-string">"~/Documents"</span>
    <span class="org-string">"~/Documents/projects"</span>
    <span class="org-string">"~/Documents/wiki"</span>
    <span class="org-string">"/tmp"</span>
    <span class="org-comment-delimiter">;</span><span class="org-comment">"/mnt/transfer"</span>
    <span class="org-string">"/var/log"</span>
    <span class="org-string">"/etc"</span>
    <span class="org-string">"/etc/init.d"</span>
    <span class="org-string">"~/.config"</span>
    <span class="org-string">"~/.local"</span>
    <span class="org-string">"~/.local/share"</span>
    <span class="org-string">"~/.emacs.d"</span>
    ))

(<span class="org-keyword">defun</span> <span class="org-function-name">dired-bookmarks</span> ()
  <span class="org-doc">"Open a directory by selecting it in Helm menu."</span>
  (<span class="org-keyword">interactive</span>)
  (helm
   <span class="org-builtin">:prompt</span> <span class="org-string">"Bookmarks: "</span>
   <span class="org-builtin">:sources</span>  `((
                (name       . <span class="org-string">"Bookmark: "</span>)
                (candidates . dired-bookmarks-path-list)
                (action     . dired)
                ))))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-11-10" class="outline-4">
<h4 id="sec-1-11-10"><span class="section-number-4">1.11.10</span> Filter dired buffer by file extensions</h4>
<div class="outline-text-4" id="text-1-11-10">
<p>
Usage: 
</p>

<ol class="org-ol">
<li>M-x dired/filter-extension
</li>

<li>Enter the extensions to filter separated by space like: 'html js ccp'
</li>

<li>It will only show files matching this extensions. To view all files
type g.
</li>
</ol>


<div class="org-src-container">

<pre class="src src-elisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">dired/filter-extension</span> ()
    <span class="org-doc">"Filter dired buffer by file extensions.</span>
<span class="org-doc">  Usage: </span>
<span class="org-doc">1. M-x dired/filter-extension </span>
<span class="org-doc">2. Enter the file extensions separated by space like: exe dll </span>

<span class="org-doc">It will only show files ending with extensions *.exe and *.dll. </span>
<span class="org-doc">To show all files of dired buffer again type 'g'."</span>
    (<span class="org-keyword">interactive</span>)
    (dired-mark-files-regexp
     (mapconcat 'identity 
                (mapcar (<span class="org-keyword">lambda</span> (ext) (format <span class="org-string">"\\.%s$"</span> ext))
                        (split-string (read-string <span class="org-string">"Extension:  "</span>)))
                <span class="org-string">"\</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">"</span>
                ))
    (dired-toggle-marks)
    (dired-do-kill-lines))
</pre>
</div>

<p>
The key (') quote can be used to invoke this command:
</p>

<div class="org-src-container">

<pre class="src src-elisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">Filter files by extension </span>
(define-key dired-mode-map <span class="org-string">"'"</span> #'dired/filter-extension)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-11-11" class="outline-4">
<h4 id="sec-1-11-11"><span class="section-number-4">1.11.11</span> Filter dired buffer by regex</h4>
<div class="outline-text-4" id="text-1-11-11">
<p>
This command only displays files matching the given regex (Emacs' regex). 
</p>

<p>
Example: By entering M-x dired/filter '\.pdf$' without quotes it will
only show file names ending with .pdf. To display all files again type 'g'.
</p>


<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">dired/filter</span> ()
  <span class="org-doc">"Show only files which name matches a regex."</span>
  (<span class="org-keyword">interactive</span>)
  (dired-mark-files-regexp (read-regexp <span class="org-string">"Regex: "</span>))
  (dired-toggle-marks)
  (dired-do-kill-lines))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-11-12" class="outline-4">
<h4 id="sec-1-11-12"><span class="section-number-4">1.11.12</span> Open directory at point with Microsoft Explorer in Windows OS.</h4>
<div class="outline-text-4" id="text-1-11-12">
<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">dired-exec-explorer</span> ()
  <span class="org-doc">"In dired, execute Explorer"</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">let</span> (path)
    (<span class="org-keyword">setq</span> path (dired-file-name-at-point))
    (<span class="org-keyword">setq</span> path (replace-regexp-in-string <span class="org-string">"~"</span> <span class="org-string">"c:/home"</span> path))
    (<span class="org-keyword">setq</span> path (replace-regexp-in-string <span class="org-string">"/"</span> <span class="org-string">"\\\\"</span> path))
    (message path)
    <span class="org-comment-delimiter">;</span><span class="org-comment">(kill-new path)</span>
    (start-process <span class="org-string">"explorer"</span> nil <span class="org-string">"explorer"</span> (concat <span class="org-string">"/select,"</span> path))
  )
)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-1-12" class="outline-3">
<h3 id="sec-1-12"><span class="section-number-3">1.12</span> Text Manipulation</h3>
<div class="outline-text-3" id="text-1-12">
</div><div id="outline-container-sec-1-12-1" class="outline-4">
<h4 id="sec-1-12-1"><span class="section-number-4">1.12.1</span> Text alignment</h4>
<div class="outline-text-4" id="text-1-12-1">
<p>
Source: <a href="http://www.svjatoslav.eu/notes/init.html">Init file</a> - www.svjatoslav.eu
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">align-to-colon</span> (begin end)
  <span class="org-doc">"Align region to colon (:) signs"</span>
  (<span class="org-keyword">interactive</span> <span class="org-string">"r"</span>)

  (align-regexp begin end
                (<span class="org-keyword">rx</span> (group (zero-or-more (syntax whitespace))) <span class="org-string">":"</span>) 1 1 ))

(<span class="org-keyword">defun</span> <span class="org-function-name">align-to-comma</span> (begin end)
  <span class="org-doc">"Align region to comma signs"</span>
  (<span class="org-keyword">interactive</span> <span class="org-string">"r"</span>)
  (align-regexp begin end
                (<span class="org-keyword">rx</span> <span class="org-string">","</span> (group (zero-or-more (syntax whitespace))) ) 1 1 ))


(<span class="org-keyword">defun</span> <span class="org-function-name">align-to-equals</span> (begin end)
  <span class="org-doc">"Align region to equal signs"</span>
  (<span class="org-keyword">interactive</span> <span class="org-string">"r"</span>)
  (align-regexp begin end
                (<span class="org-keyword">rx</span> (group (zero-or-more (syntax whitespace))) <span class="org-string">"="</span>) 1 1 ))

(<span class="org-keyword">defun</span> <span class="org-function-name">align-to-hash</span> (begin end)
  <span class="org-doc">"Align region to hash ( =&gt; ) signs"</span>
  (<span class="org-keyword">interactive</span> <span class="org-string">"r"</span>)
  (align-regexp begin end
                (<span class="org-keyword">rx</span> (group (zero-or-more (syntax whitespace))) <span class="org-string">"=&gt;"</span>) 1 1 ))

<span class="org-comment-delimiter">;; </span><span class="org-comment">work with this</span>
(<span class="org-keyword">defun</span> <span class="org-function-name">align-to-comma-before</span> (begin end)
  <span class="org-doc">"Align region to equal signs"</span>
  (<span class="org-keyword">interactive</span> <span class="org-string">"r"</span>)
  (align-regexp begin end
                (<span class="org-keyword">rx</span> (group (zero-or-more (syntax whitespace))) <span class="org-string">","</span>) 1 1 ))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-12-2" class="outline-4">
<h4 id="sec-1-12-2"><span class="section-number-4">1.12.2</span> Join Multiple Lines</h4>
<div class="outline-text-4" id="text-1-12-2">
<p>
From: <a href="https://gist.github.com/jidaikobo-shibata/ee6b2f8ef659ed58605d">jidaikobo-shibata/join-multi-lines-to-one.el</a>
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">join-multi-lines-to-one</span> ()
  <span class="org-doc">"Join multi lines."</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">let</span> ((beg (region-beginning))
        (end (region-end))
        strings)
    (goto-char beg)
    (back-to-indentation)
    (<span class="org-keyword">setq</span> beg (point))
    (goto-char end)
    (goto-char (- (point) 1))
    (end-of-line)
    (<span class="org-keyword">setq</span> end (point))
    (<span class="org-keyword">setq</span> strings (buffer-substring-no-properties beg end))
    (<span class="org-keyword">setq</span> strings (replace-regexp-in-string <span class="org-string">"\n</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">^&gt;+ *</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">^[\t&#12288; ]+"</span> <span class="org-string">" "</span> strings))
    (<span class="org-keyword">setq</span> strings (replace-regexp-in-string <span class="org-string">" +"</span> <span class="org-string">" "</span> strings))
    (delete-region beg end)
    (insert strings)
(goto-char beg)))
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-1-13" class="outline-3">
<h3 id="sec-1-13"><span class="section-number-3">1.13</span> Emacs Introspection</h3>
<div class="outline-text-3" id="text-1-13">
</div><div id="outline-container-sec-1-13-1" class="outline-4">
<h4 id="sec-1-13-1"><span class="section-number-4">1.13.1</span> User init file</h4>
<div class="outline-text-4" id="text-1-13-1">
<div class="org-src-container">

<pre class="src src-elisp">ELISP&gt; user-init-file
<span class="org-string">"/home/arch/.emacs.d/init.el"</span>

ELISP&gt; (expand-file-name user-init-file)
<span class="org-string">"/home/arch/.emacs.d/init.el"</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-13-2" class="outline-4">
<h4 id="sec-1-13-2"><span class="section-number-4">1.13.2</span> User Emacs Directory</h4>
<div class="outline-text-4" id="text-1-13-2">
<div class="org-src-container">

<pre class="src src-elisp">ELISP&gt; user-emacs-directory
<span class="org-string">"~/.emacs.d/"</span>

ELISP&gt; (expand-file-name user-emacs-directory)
<span class="org-string">"/home/arch/.emacs.d/"</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-13-3" class="outline-4">
<h4 id="sec-1-13-3"><span class="section-number-4">1.13.3</span> Enviroment Variables</h4>
</div>
<div id="outline-container-sec-1-13-4" class="outline-4">
<h4 id="sec-1-13-4"><span class="section-number-4">1.13.4</span> Get current Operating System</h4>
</div>
<div id="outline-container-sec-1-13-5" class="outline-4">
<h4 id="sec-1-13-5"><span class="section-number-4">1.13.5</span> Test if Emacs is running in terminal or in window system</h4>
<div class="outline-text-4" id="text-1-13-5">
<p>
The variable <span class="underline">window-system</span> is the name of window system through
which the selected frame is displayed.
</p>

<p>
Its value is a symbol:
</p>

<ul class="org-ul">
<li>nil for a termcap frame (a character-only terminal)
</li>
<li>'x' for an Emacs frame that is really an X window
</li>
<li>'w32' for an Emacs frame that is a window on MS-Windows display
</li>
<li>'ns' for an Emacs frame on a GNUstep or Macintosh Cocoa display
</li>
<li>'pc' for a direct-write MS-DOS frame.
</li>
</ul>


<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">test-window-system</span> ()
  (<span class="org-keyword">interactive</span>)

  (<span class="org-keyword">if</span> window-system
       (message  <span class="org-string">"Running in Window System / GUI"</span>)
       (message <span class="org-string">"Running in terminal "</span>)
       ))

<span class="org-comment-delimiter">;; </span><span class="org-comment">In GUI</span>
<span class="org-comment-delimiter">;;</span><span class="org-comment">-----------------------------</span>
&gt; (test-window-system)  <span class="org-comment-delimiter">;; </span><span class="org-comment">M-x eval-print-last-sexp</span>
<span class="org-string">"Running in Window System / GUI"</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">In Terminal</span>
<span class="org-comment-delimiter">;;</span><span class="org-comment">------------------------------</span>
&gt; (test-window-system)  <span class="org-comment-delimiter">;; </span><span class="org-comment">M-x eval-print-last-sexp</span>
<span class="org-string">"Running in terminal "</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-1-14" class="outline-3">
<h3 id="sec-1-14"><span class="section-number-3">1.14</span> Web Browser&#xa0;&#xa0;&#xa0;<span class="tag"><span class="http">http</span>&#xa0;<span class="web">web</span>&#xa0;<span class="browser">browser</span></span></h3>
<div class="outline-text-3" id="text-1-14">
</div><div id="outline-container-sec-1-14-1" class="outline-4">
<h4 id="sec-1-14-1"><span class="section-number-4">1.14.1</span> Browse Url</h4>
<div class="outline-text-4" id="text-1-14-1">
<p>
Open <a href="http://www.yandex.com">http://www.yandex.com</a> in the web browser
</p>

<div class="org-src-container">

<pre class="src src-elisp">&gt; (browse-url <span class="org-string">"http://www.yandex.com"</span>)
</pre>
</div>

<p>
Function to open Yandex.com. Usage M-x <span class="underline">open-yandex</span>
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">open-yandex</span> ()
  <span class="org-doc">"Open the web site http://www.yandex.com"</span>
  (<span class="org-keyword">interactive</span>)
  (browse-url <span class="org-string">"http://www.yandex.com"</span>)
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-14-2" class="outline-4">
<h4 id="sec-1-14-2"><span class="section-number-4">1.14.2</span> Browser Url setting the web browser</h4>
<div class="outline-text-4" id="text-1-14-2">
<p>
Open url with firefox
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">let</span> ((browse-url-browser-function 'browse-url-firefox))
  (browse-url <span class="org-string">"http://www.yandex.com"</span>))

<span class="org-comment-delimiter">;; </span><span class="org-comment">Or</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Set browser permanently</span>
(<span class="org-keyword">setq</span> browse-url-browser-function 'browse-url-firefox)
</pre>
</div>


<p>
Open url with chromium browser or chrome
</p>


<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">let</span> ((browse-url-browser-function 'browse-url-chromium))
  (browse-url <span class="org-string">"http://www.yandex.com"</span>))

<span class="org-comment-delimiter">;;; </span><span class="org-comment">Or</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Set browser permanently</span>
(<span class="org-keyword">setq</span> browse-url-browser-function 'browse-url-chromium)
</pre>
</div>


<p>
Open url with Emacs eww browser
</p>


<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">let</span> ((browse-url-browser-function 'eww-browse-url))
  (browse-url <span class="org-string">"http://www.yandex.com"</span>)

<span class="org-comment-delimiter">;;; </span><span class="org-comment">Or</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Set browser permanently</span>
(<span class="org-keyword">setq</span> browse-url-browser-function 'eww-browse-url)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-14-3" class="outline-4">
<h4 id="sec-1-14-3"><span class="section-number-4">1.14.3</span> Search Web sites with Emacs</h4>
<div class="outline-text-4" id="text-1-14-3">
</div><ol class="org-ol"><li><a id="sec-1-14-3-1" name="sec-1-14-3-1"></a>Search google<br  /><div class="outline-text-5" id="text-1-14-3-1">
<p>
Usage: M-x search-google
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">require</span> '<span class="org-constant">url-util</span>)

(<span class="org-keyword">defun</span> <span class="org-function-name">search-google</span> ()
   (<span class="org-keyword">interactive</span>)
   <span class="org-string">"Search www.google.ca"</span>
   (browse-url (format <span class="org-string">"http://www.google.ca?gws_rd=ssl#q=%s"</span> (url-encode-url (read-string <span class="org-string">"Google: "</span>)))))
</pre>
</div>
</div>
</li>

<li><a id="sec-1-14-3-2" name="sec-1-14-3-2"></a>Search a specific url site with google<br  /><div class="outline-text-5" id="text-1-14-3-2">
<p>
Usage:
</p>

<ul class="org-ul">
<li>M-x search-hackernews-with-google
</li>

<li>M-x search-reddit-with-google
</li>

<li>M-x search-stackoverflow-with-gooogle
</li>
</ul>

<div class="org-src-container">

<pre class="src src-elisp">Usage: M-x search-google

(<span class="org-keyword">require</span> '<span class="org-constant">url-util</span>)

(<span class="org-keyword">defun</span> <span class="org-function-name">search-google-url</span> (url params)
   (<span class="org-keyword">let</span> ((google-url  (format <span class="org-string">"site:%s %s"</span> url params)))
     (browse-url (format <span class="org-string">"http://www.google.ca?gws_rd=ssl#q=%s"</span> (url-encode-url google-url)))))

(search-google-url <span class="org-string">"https://news.ycombinator.com"</span> <span class="org-string">"haskell production"</span>)

(<span class="org-keyword">defun</span> <span class="org-function-name">search-hackernews-with-google</span> ()
   (<span class="org-keyword">interactive</span>)
   (search-google-url <span class="org-string">"https://news.ycombinator.com"</span> (read-string <span class="org-string">"Hnews: "</span>)))

(<span class="org-keyword">defun</span> <span class="org-function-name">search-reddit-with-google</span> ()
   (<span class="org-keyword">interactive</span>)
   (search-google-url <span class="org-string">"https://www.reddit.com"</span> (read-string <span class="org-string">"Reddit: "</span>)))

(<span class="org-keyword">defun</span> <span class="org-function-name">search-stackoverflow-with-google</span> ()
   (<span class="org-keyword">interactive</span>)
   (search-google-url <span class="org-string">"http://stackoverflow.com"</span> (read-string <span class="org-string">"S.O Search: "</span>)))
</pre>
</div>
</div>
</li>

<li><a id="sec-1-14-3-3" name="sec-1-14-3-3"></a>Search github<br  /><div class="outline-text-5" id="text-1-14-3-3">
<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">require</span> '<span class="org-constant">url-util</span>)

(<span class="org-keyword">defun</span> <span class="org-function-name">search-github</span> ()
   (<span class="org-keyword">interactive</span>)
   <span class="org-string">"Search www.google.ca"</span>
   (browse-url (format <span class="org-string">"https://github.com/search?q=%s"</span> (url-encode-url (read-string <span class="org-string">"Github Search: "</span>)))))
</pre>
</div>
</div>
</li>

<li><a id="sec-1-14-3-4" name="sec-1-14-3-4"></a>Search gisthub<br  /><div class="outline-text-5" id="text-1-14-3-4">
<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">require</span> '<span class="org-constant">url-util</span>)

(<span class="org-keyword">defun</span> <span class="org-function-name">search-gisthub</span> ()
   <span class="org-doc">"</span>
<span class="org-doc">    Search gisthub : http://gist.github.com</span>
<span class="org-doc">    Usage: M-x search-gisthub</span>
<span class="org-doc">   "</span>
   (<span class="org-keyword">interactive</span>)
   (browse-url (format <span class="org-string">"https://gist.github.com/search?p=50&amp;q=%s&amp;ref=searchresults"</span> (url-encode-url (read-string <span class="org-string">"Gisthub Search: "</span>)))))
</pre>
</div>
</div>
</li>

<li><a id="sec-1-14-3-5" name="sec-1-14-3-5"></a>Open Emacs Web Manual<br  /><div class="outline-text-5" id="text-1-14-3-5">
<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">open-emacs-manual</span> ()
  <span class="org-doc">"</span>
<span class="org-doc">  Open Emacs online Manual</span>

<span class="org-doc">  Usage: M-x open-emacs-manual</span>

<span class="org-doc">  It opens the web site: https://www.gnu.org/software/emacs/manual</span>
<span class="org-doc">  "</span>
  (<span class="org-keyword">interactive</span>)
  (browse-url <span class="org-string">"https://www.gnu.org/software/emacs/manual/"</span>))
</pre>
</div>
</div>
</li></ol>
</div>

<div id="outline-container-sec-1-14-4" class="outline-4">
<h4 id="sec-1-14-4"><span class="section-number-4">1.14.4</span> Browser Inside Emacs</h4>
<div class="outline-text-4" id="text-1-14-4">
<p>
Emacs Provides a built-in lightweight web browser eww browser that can be used to
quick access web sites in terminal or Emacs GUI.
</p>

<p>
Open a Url with eww-browser:
</p>

<ul class="org-ul">
<li><code>M-x eww &lt;url&gt;</code>
</li>
</ul>

<div class="org-src-container">

<pre class="src src-elisp">(eww-browse-url <span class="org-string">"http://m.reddit.com/r/emacs"</span>)
</pre>
</div>

<p>
<b>Open a html file with eww-browser</b>
</p>

<ul class="org-ul">
<li><code>M-x eww-open-file &lt;file-name&gt;</code>
</li>
</ul>

<p>
It is useful to view html documentation inside Emacs.
</p>

<div class="org-src-container">

<pre class="src src-elisp">(eww-open-file <span class="org-string">"/some/html/file.html"</span>)
</pre>
</div>


<p>
<b>Key Bindings</b>
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Key Binding</th>
<th scope="col" class="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">C-h m</td>
<td class="left">Show all keybindings of eww-mode</td>
</tr>

<tr>
<td class="left">q</td>
<td class="left">Quit eww browser</td>
</tr>

<tr>
<td class="left">Return/Enter</td>
<td class="left">Open url at point</td>
</tr>

<tr>
<td class="left">Tab</td>
<td class="left">Jump to next hyperlink</td>
</tr>

<tr>
<td class="left">C-A i</td>
<td class="left">Jump to previous hyperlink</td>
</tr>

<tr>
<td class="left">Space</td>
<td class="left">Scrow Down</td>
</tr>

<tr>
<td class="left">Esc</td>
<td class="left">Scrow Up</td>
</tr>

<tr>
<td class="left">w</td>
<td class="left">Copy page Url</td>
</tr>

<tr>
<td class="left">l</td>
<td class="left">Go to previous page</td>
</tr>

<tr>
<td class="left">n</td>
<td class="left">Got to next page</td>
</tr>

<tr>
<td class="left">g</td>
<td class="left">Update/ Refresh</td>
</tr>
</tbody>
</table>




<p>
To load web sites faster use mobile url. Some suggestions:
</p>

<p>
Reddit
</p>

<ul class="org-ul">
<li><a href="http://m.reddit.com">http://m.reddit.com</a>
</li>
<li><a href="http://m.reddit.com/r/emacs">http://m.reddit.com/r/emacs</a>
</li>
</ul>

<p>
Google Search
</p>

<ul class="org-ul">
<li><code>http://www.google.com/m?q=&lt;query&gt;</code>  - Country/Culture sensitive search
</li>

<li><code>http://www.google.ca/m?q=&lt;query&gt;</code>   - Country/Culture insensitive search, always English.
</li>
</ul>


<p>
Google News:
</p>

<ul class="org-ul">
<li><a href="http://www.gooogle.com/m/news">http://www.gooogle.com/m/news</a> - Country/Culure sensitive
</li>

<li><a href="http://www.google.ca/m/news">http://www.google.ca/m/news</a> - Canada News
</li>
</ul>

<p>
Arch Linux Wiki
</p>

<ul class="org-ul">
<li><a href="http://wiki.archlinux.org/index.php/Table_of_contents">http://wiki.archlinux.org/index.php/Table_of_contents</a>
</li>
</ul>

<p>
Wikipedia
</p>

<ul class="org-ul">
<li><a href="http://en.m.wikipedia.org">http://en.m.wikipedia.org</a>
</li>
</ul>

<p>
Hackernews
</p>

<ul class="org-ul">
<li><a href="http://www.news.ycombinator.com">http://www.news.ycombinator.com</a>
</li>
</ul>

<p>
See the browser http request:
</p>

<ul class="org-ul">
<li><a href="http://www.httpbin.org/get">http://www.httpbin.org/get</a>
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-sec-1-15" class="outline-3">
<h3 id="sec-1-15"><span class="section-number-3">1.15</span> Http Requests&#xa0;&#xa0;&#xa0;<span class="tag"><span class="http">http</span>&#xa0;<span class="request">request</span>&#xa0;<span class="url">url</span>&#xa0;<span class="network">network</span></span></h3>
<div class="outline-text-3" id="text-1-15">
</div><div id="outline-container-sec-1-15-1" class="outline-4">
<h4 id="sec-1-15-1"><span class="section-number-4">1.15.1</span> Download File&#xa0;&#xa0;&#xa0;<span class="tag"><span class="http">http</span>&#xa0;<span class="web">web</span>&#xa0;<span class="download">download</span></span></h4>
<div class="outline-text-4" id="text-1-15-1">
<pre class="example">
(url-copy-file &lt;url&gt; &lt;filename&gt;)
</pre>

<div class="org-src-container">

<pre class="src src-elisp">(url-copy-file <span class="org-string">"http://www.httpbin.org/get"</span> <span class="org-string">"/tmp/output"</span>)
(find-file <span class="org-string">"/tmp/output"</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-15-2" class="outline-4">
<h4 id="sec-1-15-2"><span class="section-number-4">1.15.2</span> url-retrieve-synchronously&#xa0;&#xa0;&#xa0;<span class="tag"><span class="http">http</span>&#xa0;<span class="web">web</span>&#xa0;<span class="download">download</span>&#xa0;<span class="sync">sync</span></span></h4>
<div class="outline-text-4" id="text-1-15-2">
<pre class="example">
(url-retrieve-synchronously URL &amp;optional SILENT INHIBIT-COOKIES)
</pre>

<p>
Example:
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">with-current-buffer</span>  (url-retrieve-synchronously <span class="org-string">"http://www.httpbin.org/get"</span>)
   (buffer-substring-no-properties (point-min) (point-max)))
</pre>
</div>

<p>
Output:
</p>

<pre class="example">
HTTP/1.1 200 OK
Server: nginx
Date: Fri, 23 Sep 2016 23:44:21 GMT
Content-Type: application/json
Content-Length: 304
Connection: keep-alive
Access-Control-Allow-Origin: *
Access-Control-Allow-Credentials: true

{
  "args": {},
  "headers": {
    "Accept": "*/*",
    "Accept-Encoding": "gzip",
    "Extension": "Security/Digest Security/SSL",
    "Host": "www.httpbin.org",
    "Mime-Version": "1.0",
    "User-Agent": "URL/Emacs"
  },
  "origin": "179.176.152.199",
  "url": "http://www.httpbin.org/get"
}
</pre>
</div>
</div>

<div id="outline-container-sec-1-15-3" class="outline-4">
<h4 id="sec-1-15-3"><span class="section-number-4">1.15.3</span> Download a file interactively&#xa0;&#xa0;&#xa0;<span class="tag"><span class="http">http</span>&#xa0;<span class="web">web</span>&#xa0;<span class="download">download</span>&#xa0;<span class="file">file</span></span></h4>
<div class="outline-text-4" id="text-1-15-3">
<p>
This function downloads a file from the url copied to clipboard and
then asks the user to which file the data will be downloaded
suggesting the file name extracted from the url.
</p>

<p>
This function updates the current buffer (revert buffer) if executed
in a dired buffer (directory).
</p>

<p>
Testing the function:
</p>

<ul class="org-ul">
<li>1. Copy the url:  <a href="https://raw.githubusercontent.com/nybbles/kaggle/master/train.csv">https://raw.githubusercontent.com/nybbles/kaggle/master/train.csv</a>
</li>

<li>2. M-x download-url-to-file
</li>

<li>3. View file in current directory. <code>C-x d</code> to open it.
</li>
</ul>

<p>
Usage: <code>M-x download-url-to-file</code>
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">download-url-to-file</span> ()
  <span class="org-doc">"Download a file from a URL in the clibpoard.</span>
<span class="org-doc">This command asks the user for the url suggesting the url</span>
<span class="org-doc">stored in the clipboard and then asks the user for the file name</span>
<span class="org-doc">to be downloaded suggesting the file name extracted from the url.</span>
<span class="org-doc">"</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">let*</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Get the URL suggestion from clibpoard</span>
      ((text (<span class="org-keyword">with-temp-buffer</span>
                  (clipboard-yank)
                  (buffer-substring-no-properties (point-min)
                                                  (point-max))))
       <span class="org-comment-delimiter">;; </span><span class="org-comment">Ask the user to confirm the url</span>
       (url (read-string <span class="org-string">"Url: "</span> text)))

    (url-copy-file
     url
     <span class="org-comment-delimiter">;; </span><span class="org-comment">Get file name.</span>
     (read-file-name <span class="org-string">"File name: "</span>
                     (car  (last (split-string url <span class="org-string">"/"</span>)))))

    (<span class="org-keyword">when</span> (equal major-mode 'dired-mode)
      (revert-buffer))))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-1-15-4" class="outline-4">
<h4 id="sec-1-15-4"><span class="section-number-4">1.15.4</span> Download a file and display it on a buffer&#xa0;&#xa0;&#xa0;<span class="tag"><span class="http">http</span>&#xa0;<span class="web">web</span>&#xa0;<span class="buffer">buffer</span>&#xa0;<span class="clipboard">clipboard</span></span></h4>
<div class="outline-text-4" id="text-1-15-4">
<p>
This command reads an url from the user and download the file content
and displays it on a buffer without write a file to disk. 
</p>

<p>
Example: 
</p>

<ol class="org-ol">
<li>User copies the url: (file: <a href="http://patterns.cs.up.ac.za/examples/ch9/iterator-theory.cs">iterator-theory.cs</a>)  <code>http://patterns.cs.up.ac.za/examples/ch9/iterator-theory.cs</code> 
</li>

<li>User enters the command <code>M-x download-code-view</code> 
</li>

<li>It will suggest in a prompt the former url. User hit return.
</li>

<li>It download the code and displays it on a buffer <b>iterator-theory.cs</b>
</li>

<li>User enter the command. M-x csharp-mode that turns on the syntax hightlight.
</li>
</ol>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">download-code-view</span> ()
    <span class="org-doc">"Download a source code from url and displays it on a buffer."</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">let*</span> (
           <span class="org-comment-delimiter">;; </span><span class="org-comment">Get url from clipboard </span>
           (clipboard (<span class="org-keyword">with-temp-buffer</span>
                        (clipboard-yank)
                        (buffer-substring-no-properties (point-min)
                                                        (point-max))))
           <span class="org-comment-delimiter">;; </span><span class="org-comment">Read url and suggesting clipboard </span>
           (url      (read-string <span class="org-string">"Url: "</span> clipboard))
           (buf      (url-retrieve-synchronously url))
           <span class="org-comment-delimiter">;; </span><span class="org-comment">Tries to extract the file name from url </span>
           (filename (car  (last (split-string url <span class="org-string">"/"</span>))))         
           (bufname  (concat <span class="org-string">"*"</span> filename <span class="org-string">"*"</span>)) 
           )         
      (switch-to-buffer buf)
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Remove http header </span>
      (goto-char (point-min))
      (re-search-forward <span class="org-string">"^$"</span>)
      (delete-region (point) (point-min))
      (kill-whole-line)
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Remove \r characters or ^M</span>
      (replace-string (char-to-string 13) <span class="org-string">""</span>)
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Rename buffer to a better name </span>
      (<span class="org-keyword">with-current-buffer</span> buf
        (rename-buffer bufname))))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-15-5" class="outline-4">
<h4 id="sec-1-15-5"><span class="section-number-4">1.15.5</span> Http and Post Request&#xa0;&#xa0;&#xa0;<span class="tag"><span class="utils">utils</span>&#xa0;<span class="connections">connections</span>&#xa0;<span class="http">http</span></span></h4>
<div class="outline-text-4" id="text-1-15-5">
<p>
<a href="http://qiita.com/sanryuu/items/eed79c7b99616e769e67">Source</a>
</p>
<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">url-http-post</span> (url args)
  <span class="org-doc">"Send ARGS to URL as a POST request."</span>
  (<span class="org-keyword">let</span> (
        (response-string nil)
        (url-request-method <span class="org-string">"POST"</span>)
        (url-request-extra-headers
         '((<span class="org-string">"Content-Type"</span> . <span class="org-string">"application/x-www-form-urlencoded"</span>)))
        (url-request-data
         (mapconcat (<span class="org-keyword">lambda</span> (arg)
                      (concat (url-hexify-string (car arg))
                              <span class="org-string">"="</span>
                              (url-hexify-string (cdr arg))))
                    args
                    <span class="org-string">"&amp;"</span>)))
    (switch-to-buffer
     (url-retrieve-synchronously url))
    (goto-char (point-min))
    (re-search-forward <span class="org-string">"\n\n"</span>)
    (<span class="org-keyword">setq</span> response-string
          (buffer-substring-no-properties (point) (point-max)))
    (kill-buffer (current-buffer))
    response-string))

(<span class="org-keyword">defun</span> <span class="org-function-name">url-http-get</span> (url args)
  <span class="org-doc">"Send ARGS to URL as a GET request."</span>
  (<span class="org-keyword">let</span> (
        (response-string nil)
        (url-request-method <span class="org-string">"GET"</span>)
        (url-request-data
         (mapconcat (<span class="org-keyword">lambda</span> (arg)
                      (concat (url-hexify-string (car arg))
                              <span class="org-string">"="</span>
                              (url-hexify-string (cdr arg))))
                    args
                    <span class="org-string">"&amp;"</span>)))
    (switch-to-buffer
     (url-retrieve-synchronously
      (concat url <span class="org-string">"?"</span> url-request-data)))
    (goto-char (point-min))
    (re-search-forward <span class="org-string">"\n\n"</span>)
    (<span class="org-keyword">setq</span> response-string
          (buffer-substring-no-properties
           (point) (point-max)))
    (kill-buffer (current-buffer))
    response-string))


ELISP&gt; (princ (url-http-get <span class="org-string">"http://httpbin.org/get"</span> nil))
{
  <span class="org-string">"args"</span>: {},
  <span class="org-string">"headers"</span>: {
    <span class="org-string">"Accept"</span>: <span class="org-string">"*/*"</span>,
    <span class="org-string">"Accept-Encoding"</span>: <span class="org-string">"gzip"</span>,
    <span class="org-string">"Content-Length"</span>: <span class="org-string">"0"</span>,
    <span class="org-string">"Extension"</span>: <span class="org-string">"Security/Digest Security/SSL"</span>,
    <span class="org-string">"Host"</span>: <span class="org-string">"httpbin.org"</span>,
    <span class="org-string">"Mime-Version"</span>: <span class="org-string">"1.0"</span>,
    <span class="org-string">"User-Agent"</span>: <span class="org-string">"URL/Emacs"</span>
  },
  <span class="org-string">"origin"</span>: <span class="org-string">"167.103.159.147"</span>,
  <span class="org-string">"url"</span>: <span class="org-string">"http://httpbin.org/get"</span>
}


ELISP&gt; (princ (url-http-post <span class="org-string">"http://httpbin.org/post"</span> '((<span class="org-string">"use"</span> . <span class="org-string">"dummy"</span>)  (<span class="org-string">"pass"</span> . <span class="org-string">"something else"</span>) (<span class="org-string">"code"</span> . <span class="org-string">"pxyz0011213"</span>))))
{
  <span class="org-string">"args"</span>: {},
  <span class="org-string">"data"</span>: <span class="org-string">""</span>,
  <span class="org-string">"files"</span>: {},
  <span class="org-string">"form"</span>: {
    <span class="org-string">"code"</span>: <span class="org-string">"pxyz0011213"</span>,
    <span class="org-string">"pass"</span>: <span class="org-string">"something else"</span>,
    <span class="org-string">"use"</span>: <span class="org-string">"dummy"</span>
  },
  <span class="org-string">"headers"</span>: {
    <span class="org-string">"Accept"</span>: <span class="org-string">"*/*"</span>,
    <span class="org-string">"Accept-Encoding"</span>: <span class="org-string">"gzip"</span>,
    <span class="org-string">"Content-Length"</span>: <span class="org-string">"48"</span>,
    <span class="org-string">"Content-Type"</span>: <span class="org-string">"application/x-www-form-urlencoded"</span>,
    <span class="org-string">"Extension"</span>: <span class="org-string">"Security/Digest Security/SSL"</span>,
    <span class="org-string">"Host"</span>: <span class="org-string">"httpbin.org"</span>,
    <span class="org-string">"Mime-Version"</span>: <span class="org-string">"1.0"</span>,
    <span class="org-string">"User-Agent"</span>: <span class="org-string">"URL/Emacs"</span>
  },
  <span class="org-string">"json"</span>: null,
  <span class="org-string">"origin"</span>: <span class="org-string">"167.103.159.147"</span>,
  <span class="org-string">"url"</span>: <span class="org-string">"http://httpbin.org/post"</span>
}
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-1-16" class="outline-3">
<h3 id="sec-1-16"><span class="section-number-3">1.16</span> Packages&#xa0;&#xa0;&#xa0;<span class="tag"><span class="package">package</span>&#xa0;<span class="install">install</span>&#xa0;<span class="library">library</span></span></h3>
<div class="outline-text-3" id="text-1-16">
</div><div id="outline-container-sec-1-16-1" class="outline-4">
<h4 id="sec-1-16-1"><span class="section-number-4">1.16.1</span> Test if package is installed</h4>
<div class="outline-text-4" id="text-1-16-1">
<p>
If the package is installed returns t (true) and nil otherwise.
</p>

<ul class="org-ul">
<li><code>(package-installed-p PACKAGE &amp;optional MIN-VERSION)</code>
</li>
</ul>

<div class="org-src-container">

<pre class="src src-elisp">&gt; (package-installed-p 'helm-core)
t
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-16-2" class="outline-4">
<h4 id="sec-1-16-2"><span class="section-number-4">1.16.2</span> Install a package if it is not installed</h4>
</div>
<div id="outline-container-sec-1-16-3" class="outline-4">
<h4 id="sec-1-16-3"><span class="section-number-4">1.16.3</span> Install a single-file package from URL</h4>
<div class="outline-text-4" id="text-1-16-3">
<p>
This command install a single-file elisp package from a given URL to
source file.
</p>

<p>
Usage: 
</p>

<ol class="org-ol">
<li>Copy the url of the package file to be installed like
<a href="http://mumble.net/~campbell/emacs/paredit-beta.el">http://mumble.net/~campbell/emacs/paredit-beta.el</a> from <a href="https://www.emacswiki.org/emacs/ParEdit">EmacsWiki:Par Edit</a>.
</li>

<li>Type M-x package-install-url It will ask to confirm the URL. Then
type return and the package will be installed. 
</li>
</ol>

<p>
To find where the package was intalled type M-x find-library &lt;library-name&gt;.
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">package-install-url</span> ()
  <span class="org-doc">"Install a single-file package *.el file from Url."</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">let*</span> (
         <span class="org-comment-delimiter">;; </span><span class="org-comment">Suggest the URL stored in the clipboard</span>
         (clipboard (<span class="org-keyword">with-temp-buffer</span>
                      (clipboard-yank)
                      (buffer-substring-no-properties (point-min) (point-max))))
         <span class="org-comment-delimiter">;; </span><span class="org-comment">Ask the user to confirm the url </span>
         (url (read-string <span class="org-string">"Url: "</span> clipboard))
         )

     (<span class="org-keyword">with-current-buffer</span> (url-retrieve-synchronously url)
       (goto-char (point-min))
       (re-search-forward <span class="org-string">"^$"</span>)
       (delete-region (point) (point-min))
       (kill-whole-line)
      (package-install-from-buffer))))
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-1-17" class="outline-3">
<h3 id="sec-1-17"><span class="section-number-3">1.17</span> Helm Snippets&#xa0;&#xa0;&#xa0;<span class="tag"><span class="framework">framework</span>&#xa0;<span class="library">library</span>&#xa0;<span class="helm">helm</span></span></h3>
<div class="outline-text-3" id="text-1-17">
</div><div id="outline-container-sec-1-17-1" class="outline-4">
<h4 id="sec-1-17-1"><span class="section-number-4">1.17.1</span> Switch between buffers in same directory</h4>
<div class="outline-text-4" id="text-1-17-1">
<p>
Usage: M-x buffer/switch-in-directory
</p>

<p>
This command switches between buffer with files that are in current directory.
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">buffer/with-file-in-directory-p</span> (directory buf)
  <span class="org-doc">"Check if a buffer has file associated and is is in DIRECTORY.</span>
<span class="org-doc">Parameters:</span>
<span class="org-doc">- directory  string         - root directory </span>
<span class="org-doc">- buf        buffer object  - buffer object"</span>
  (<span class="org-keyword">and</span> (buffer-file-name buf) <span class="org-comment-delimiter">;; </span><span class="org-comment">check if buffer has a file associated </span>
       (string-prefix-p (expand-file-name directory)
                        (expand-file-name (buffer-file-name buf)
                                            ))))


(<span class="org-keyword">defun</span> <span class="org-function-name">buffer/switch-in-directory</span> ()
  <span class="org-doc">"Switch between buffers in same directory."</span>
  (<span class="org-keyword">interactive</span>)
  (helm
   <span class="org-builtin">:prompt</span> <span class="org-string">"Buffer switch: "</span>
   <span class="org-builtin">:sources</span>  `((
                (name       . <span class="org-string">"Dir: "</span>)                                 
                (candidates . ,(mapcar (<span class="org-keyword">lambda</span> (b) (cons (buffer-name b) b))
                                       <span class="org-comment-delimiter">;; </span><span class="org-comment">filter buffers not in this directory (code bellow)</span>
                                       (remove-if-not  (<span class="org-keyword">lambda</span> (b)
                                                         (buffer/with-file-in-directory-p
                                                          (<span class="org-keyword">or</span> (file-name-directory (buffer-file-name))
                                                              default-directory
                                                              )
                                                          b
                                                          ))
                                                  (buffer-list)
                                                  )))
                (action     . switch-to-buffer)
                ))))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-17-2" class="outline-4">
<h4 id="sec-1-17-2"><span class="section-number-4">1.17.2</span> Browser Recent files</h4>
<div class="outline-text-4" id="text-1-17-2">
<p>
Usage: M-x helm-recent-files
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">require</span> '<span class="org-constant">helm</span>)

(<span class="org-keyword">defun</span> <span class="org-function-name">helm-recent-files</span> ()
  (<span class="org-keyword">interactive</span>)

  (helm
   <span class="org-builtin">:prompt</span> <span class="org-string">"File: "</span>
   <span class="org-builtin">:sources</span>  `((
                (name       . <span class="org-string">"File: "</span>)
                (candidates . ,recentf-list)
                (action     . find-file)
                ))))
</pre>
</div>


<div class="figure">
<p><img src="images/helm-recent-files.png" alt="helm-recent-files.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-sec-1-17-3" class="outline-4">
<h4 id="sec-1-17-3"><span class="section-number-4">1.17.3</span> Browser Recent directories</h4>
<div class="outline-text-4" id="text-1-17-3">
<p>
Usage M-x helm-recent-dirs
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">require</span> '<span class="org-constant">helm</span>)

(<span class="org-keyword">defun</span> <span class="org-function-name">unique</span> (xs)
  <span class="org-doc">"Remove repeated elements from list xs</span>

<span class="org-doc">  Example:</span>

<span class="org-doc">  &gt; (unique '(x y a b 21 21 10 21 x y a ))</span>
<span class="org-doc">  (x y a b 21 10)</span>
<span class="org-doc">  "</span>
  (<span class="org-keyword">let</span>
    ((result nil))

    (<span class="org-keyword">dolist</span> (x xs)
      (<span class="org-keyword">if</span> (not (member x result))
          (<span class="org-keyword">push</span> x result)
        ))
    (reverse result)
    ))

(<span class="org-keyword">defun</span> <span class="org-function-name">helm-recent-dirs</span> ()
  (<span class="org-keyword">interactive</span>)

  (helm
   <span class="org-builtin">:prompt</span> <span class="org-string">"Dir: "</span>
   <span class="org-builtin">:sources</span>  `((
                (name       . <span class="org-string">"Dir: "</span>)
                (candidates . (<span class="org-keyword">lambda</span> () (unique (map #'file-name-directory recentf-list))))
                (action     . dired)
                ))))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-17-4" class="outline-4">
<h4 id="sec-1-17-4"><span class="section-number-4">1.17.4</span> Launch ansync shell command with helm</h4>
<div class="outline-text-4" id="text-1-17-4">
<p>
This piece of code gets all executables in the $PATH variable and
searche for one that matches the user input and then launches it. It
is useful to launch applications without block Emacs.
</p>

<p>
Usage: M-x helm-laucher
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">get-executables</span> ()

  <span class="org-doc">"</span>
<span class="org-doc">  Returns a list of all files available in the directories of the $PATH</span>
<span class="org-doc">  variable.</span>
<span class="org-doc">  "</span>
  (apply #'append
   (mapcar  (<span class="org-keyword">lambda</span> (p) (directory-files p t))
            (remove-if-not #'file-exists-p
                        (split-string (getenv <span class="org-string">"PATH"</span>) <span class="org-string">":"</span>)))))


(<span class="org-keyword">defun</span> <span class="org-function-name">run-async</span>  (<span class="org-type">&amp;optional</span> command)

  <span class="org-doc">"Run a shell command in asynchronous mode.</span>
<span class="org-doc">   It doesn't block Emacs while the command</span>
<span class="org-doc">   is running.</span>

<span class="org-doc">   Usage:  (run-async \"python -m http.server\")</span>
<span class="org-doc">           M-x run-async  -&gt; User enters a command.</span>
<span class="org-doc">  "</span>

  (<span class="org-keyword">interactive</span>)

  (apply #'start-process

         `(


           <span class="org-string">"proc-any"</span>          <span class="org-comment-delimiter">;; </span><span class="org-comment">We don't care about the application name</span>

           nil                 <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't name the buffer</span>

           ,@(split-string-and-unquote

              (<span class="org-keyword">if</span>  command
                   command
                   (read-string <span class="org-string">"Command: "</span>  )
                  ))

           )))

(<span class="org-keyword">defun</span> <span class="org-function-name">run-async-lst</span> (<span class="org-type">&amp;rest</span> commands)
  <span class="org-doc">"</span>
<span class="org-doc">  Run a shell command in asynchronus mode, not blocking Emacs.</span>

<span class="org-doc">  Usage:    &gt; (run-async-lst &lt;program&gt; &lt;argument 1&gt; &lt;agurment2&gt; ...)</span>
<span class="org-doc">  Example:  &gt; (run-async \"thunar\" \"/usr/share/applications\")</span>
<span class="org-doc">  "</span>
  (apply #'start-process

         `(
           <span class="org-string">"dontcare"</span>          <span class="org-comment-delimiter">;; </span><span class="org-comment">We don't care about the application name</span>
           nil                 <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't name the buffer</span>
           ,@commands

           )))


(<span class="org-keyword">defun</span> <span class="org-function-name">helm-launcher</span> ()

  <span class="org-doc">" Launches applications available in $PATH directories in</span>
<span class="org-doc">    asynchronous mode without Emacs wait for it.</span>
<span class="org-doc">    Usage M-x heml-launcher</span>
<span class="org-doc">  "</span>
  (<span class="org-keyword">interactive</span>)

  (<span class="org-keyword">let</span>
      ((data      (mapcar (<span class="org-keyword">lambda</span> (p) (cons  (file-name-nondirectory p)
                                             p
                                             ))

                          (get-executables)
                          )
        ))

   (helm
   <span class="org-builtin">:prompt</span> <span class="org-string">"Shell: "</span>
   <span class="org-builtin">:sources</span>  `((
                (name       . <span class="org-string">"Shell: "</span>)
                (candidates . ,data)
                (action     . run-async)
                )))))
</pre>
</div>



<div class="figure">
<p><img src="images/helm-app-launcher.png" alt="helm-app-launcher.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-sec-1-17-5" class="outline-4">
<h4 id="sec-1-17-5"><span class="section-number-4">1.17.5</span> Switch between buffers associated with files</h4>
<div class="outline-text-4" id="text-1-17-5">
<p>
Switch between buffers associated with files.
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">switch-file</span> ()
  <span class="org-doc">"</span>
<span class="org-doc">  Switch between buffers that are associated with files.</span>
<span class="org-doc">  Depends on helm.</span>


<span class="org-doc">  Usage: M-x switch file.</span>

<span class="org-doc">  "</span>
  (<span class="org-keyword">interactive</span>)

  (<span class="org-keyword">let</span> ((data  (mapcar (<span class="org-keyword">lambda</span> (b)  (cons (buffer-file-name b) b ))
                       (remove-if-not #'buffer-file-name (buffer-list)))))
    (helm
     <span class="org-builtin">:prompt</span> <span class="org-string">"Buffer: "</span>
     <span class="org-builtin">:sources</span>  `((
                  (name       . <span class="org-string">"File Buffers"</span>)
                  (candidates . ,data)
                  (action     . switch-to-buffer)
                  )))

    ))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-17-6" class="outline-4">
<h4 id="sec-1-17-6"><span class="section-number-4">1.17.6</span> Switch between Emacs major modes</h4>
<div class="outline-text-4" id="text-1-17-6">
<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">helm-switch-mode</span> ()
  <span class="org-doc">"</span>
<span class="org-doc">   Switch between all major programming modes available in Emacs.</span>

<span class="org-doc">   Usage: M-x helm-switch-mode</span>
<span class="org-doc">  "</span>
  (<span class="org-keyword">interactive</span>)

  (<span class="org-keyword">cl-flet</span> ((unique (xs)
                    (<span class="org-keyword">let</span>
                        ((result nil))

                      (<span class="org-keyword">dolist</span> (x xs)
                        (<span class="org-keyword">if</span> (not (member x result))
                            (<span class="org-keyword">push</span> x result)
                          ))
                      (reverse result)
                      )

                    ))

    (helm
     <span class="org-builtin">:prompt</span> <span class="org-string">"Mode: "</span>
     <span class="org-builtin">:sources</span>  `((
                  (name       . <span class="org-string">"Emacs Major Modes"</span>)

                  (candidates . ,(unique (mapcar #'symbol-name
                                                 (remove-if-not #'symbolp
                                                   (mapcar #'cdr auto-mode-alist)))))



                  (action     . ,(<span class="org-keyword">lambda</span> (m) (funcall (intern-soft m))))

                  )))
    )
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-17-7" class="outline-4">
<h4 id="sec-1-17-7"><span class="section-number-4">1.17.7</span> Open a list of web sites</h4>
<div class="outline-text-4" id="text-1-17-7">
<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">setq</span> helm-url-default-url-list

      '(
        (<span class="org-string">"google"</span> . <span class="org-string">"http://www.google.ca"</span>)
        (<span class="org-string">"yandex"</span>  . <span class="org-string">"http://www.yandex.com"</span>)
        (<span class="org-string">"reddit"</span> . <span class="org-string">"http://www.reddit.com"</span>)
        (<span class="org-string">"/r/haskell"</span>. <span class="org-string">"http://www.reddit.com/r/haskell"</span>)
        (<span class="org-string">"/r/emacs"</span> . <span class="org-string">"http://www.reddit.com/r/emacs"</span>)
        (<span class="org-string">"/r/csharp"</span> . <span class="org-string">"http://www.reddit.com/r/csharp"</span>)
        )

      )

(<span class="org-keyword">defun</span> <span class="org-function-name">helm-web</span> ()
  (<span class="org-keyword">interactive</span>)
  (helm
     <span class="org-builtin">:prompt</span> <span class="org-string">"Web Site: "</span>
     <span class="org-builtin">:sources</span>  `((
                  (name       . <span class="org-string">"Bookmarks"</span>)
                  (candidates . helm-url-default-url-list)
                  (action     . (<span class="org-keyword">lambda</span> (c) (browse-url (cdr c))) )
                  )))
  )
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-1-17-8" class="outline-4">
<h4 id="sec-1-17-8"><span class="section-number-4">1.17.8</span> Interface Makefile</h4>
<div class="outline-text-4" id="text-1-17-8">
<p>
This command extracts the build tasks from a Makefile and shows it as a
helm menu where the user can select the task to be executed. It will be
run as a asynchronous process.
</p>


<p>
Usage: M-x helm-make
</p>

<p>
Version1:
</p>

<div class="org-src-container">

<pre class="src src-elisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">Taken from: http://emacs.stackexchange.com/questions/7148/get-all-regexp-matches-in-buffer-as-a-list</span>
(<span class="org-keyword">defun</span> <span class="org-function-name">re-seq</span> (regexp string)
  <span class="org-doc">"Get a list of all regexp matches in a string"</span>
  (<span class="org-keyword">save-match-data</span>
    (<span class="org-keyword">let</span> ((pos 0)
          matches)
      (<span class="org-keyword">while</span> (string-match regexp string pos)
        (<span class="org-keyword">push</span> (match-string 0 string) matches)
        (<span class="org-keyword">setq</span> pos (match-end 0)))
      matches)))

(<span class="org-keyword">defun</span> <span class="org-function-name">helm-make</span> ()
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">let</span> ((tasks    (re-seq <span class="org-string">"^\\w+"</span>
                          (<span class="org-keyword">with-temp-buffer</span>
                            (insert-file <span class="org-string">"Makefile"</span>)
                            (buffer-substring-no-properties (point-min)
                                                            (point-max)                                                            )))))
    (helm
     <span class="org-builtin">:prompt</span> <span class="org-string">"Makefile task: "</span>
     <span class="org-builtin">:sources</span>  `((
                  (name       . <span class="org-string">"Task"</span>)
                  (candidates . ,tasks)
                  (action     . (<span class="org-keyword">lambda</span> (task)
                                  (start-process  <span class="org-string">"make"</span>
                                                  <span class="org-string">"*make*"</span>
                                                  <span class="org-string">"make"</span> task
                                                  )))
                  )))
    (switch-to-buffer <span class="org-string">"*make*"</span>)))
</pre>
</div>

<p>
Version2: Remove dependency re-seq.
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">helm-make2</span> ()
  (<span class="org-keyword">interactive</span>)

  (<span class="org-keyword">flet</span> ((re-seq2 (regexp string) (<span class="org-keyword">save-match-data</span>
                                    (<span class="org-keyword">let</span> ((pos 0)
                                          matches)
                                      (<span class="org-keyword">while</span> (string-match regexp string pos)
                                        (<span class="org-keyword">push</span> (match-string 0 string) matches)
                                        (<span class="org-keyword">setq</span> pos (match-end 0)))
                                      matches))))

    (<span class="org-keyword">let</span> ((tasks    (re-seq2 <span class="org-string">"^\\w+"</span>
                            (<span class="org-keyword">with-temp-buffer</span>
                              (insert-file <span class="org-string">"Makefile"</span>)
                              (buffer-substring-no-properties (point-min)
                                                              (point-max)                                                            )))))
      (helm
       <span class="org-builtin">:prompt</span> <span class="org-string">"Makefile task: "</span>
       <span class="org-builtin">:sources</span>  `((
                    (name       . <span class="org-string">"Task"</span>)
                    (candidates . ,tasks)
                    (action     . (<span class="org-keyword">lambda</span> (task)
                                    (start-process  <span class="org-string">"make"</span>
                                                    <span class="org-string">"*make*"</span>
                                                    <span class="org-string">"make"</span> task
                                                    )))
                    )))
      (switch-to-buffer <span class="org-string">"*make*"</span>))))
</pre>
</div>

<p>
Example: Assuming that the current directory has the Makefile with
content. The command M-x helm-make will show the tasks all, html,
browse and clean.
</p>

<div class="org-src-container">

<pre class="src src-makefile"><span class="org-makefile-targets">all</span>: html

<span class="org-makefile-targets">html</span>:
        mkdir -p dist
        emacs --batch -q -l build.el --kill
        mv dist/README.html dist/index.html
        cp -r -v images dist/images
        cp -r *.org  dist/

<span class="org-makefile-targets">browse</span>:
        firefox dist/index.html

<span class="org-makefile-targets">clean</span>:
        rm -rf dist/*.html dist/*.html~
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-1-18" class="outline-3">
<h3 id="sec-1-18"><span class="section-number-3">1.18</span> Persistence</h3>
<div class="outline-text-3" id="text-1-18">
</div><div id="outline-container-sec-1-18-1" class="outline-4">
<h4 id="sec-1-18-1"><span class="section-number-4">1.18.1</span> Save and Reload Current Session</h4>
<div class="outline-text-4" id="text-1-18-1">
<p>
Interactive Developement
</p>

<div class="org-src-container">

<pre class="src src-elisp">ELISP&gt; (<span class="org-keyword">defun</span> <span class="org-function-name">file-contents</span> (filename)
  (<span class="org-keyword">interactive</span> <span class="org-string">"fFind file: "</span>)
  (<span class="org-keyword">with-temp-buffer</span>
    (insert-file-contents filename)
    (buffer-substring-no-properties (point-min) (point-max))))
file-contents
ELISP&gt;

ELISP&gt; (<span class="org-keyword">defun</span> <span class="org-function-name">write-file</span> (filename content)
         (append-to-file content nil filename))
write-file
ELISP&gt;

ELISP&gt; (remove-if 'null (mapcar 'buffer-file-name  (buffer-list)))
(<span class="org-string">"/home/tux/.emacs.d/init.el"</span> <span class="org-string">"/sudo:root@localhost:/etc/host.conf"</span>)

ELISP&gt; (<span class="org-keyword">setq</span> session-file  <span class="org-string">"~/.emacs.d/lastsession.el"</span>)
<span class="org-string">"~/.emacs.d/lastsession.el"</span>
ELISP&gt;

ELISP&gt;
ELISP&gt; (format <span class="org-string">"(setq last-session-files '%S)"</span> (remove-if 'null (mapcar 'buffer-file-name  (buffer-list))))
<span class="org-string">"(setq last-session-files '(\"/home/tux/.emacs.d/init.el\" \"/sudo:root@localhost:/etc/host.conf\"))"</span>


ELISP&gt; (<span class="org-keyword">setq</span> code  (format <span class="org-string">"(setq last-session-files '%S)"</span> (remove-if 'null (mapcar 'buffer-file-name  (buffer-list)))))
<span class="org-string">"(setq last-session-files '(\"/home/tux/.emacs.d/init.el\" \"/sudo:root@localhost:/etc/host.conf\"))"</span>
ELISP&gt;

ELISP&gt; (<span class="org-keyword">setq</span> session-file <span class="org-string">"~/.emacs.d/lastsession.el"</span>)

ELISP&gt; (delete-file session-file)
nil

ELISP&gt; (write-file session-file code)
nil
ELISP&gt;

ELISP&gt; (file-contents session-file)
<span class="org-string">"(setq last-session-files '(\"/home/tux/.emacs.d/init.el\" \"/sudo:root@localhost:/etc/host.conf\"))"</span>
ELISP&gt;

ELISP&gt; (load-file session-file)
t
ELISP&gt; last-session-files
(<span class="org-string">"/home/tux/.emacs.d/init.el"</span> <span class="org-string">"/sudo:root@localhost:/etc/host.conf"</span>)

<span class="org-comment-delimiter">;;; </span><span class="org-comment">Open All files defined in Last Session</span>
ELISP&gt;
ELISP&gt; (mapcar 'find-file last-session-files)
(#&lt;buffer init.el&gt; #&lt;buffer host.conf&gt;)

ELISP&gt;
</pre>
</div>

<p>
Joining Everything
</p>


<p>
File: sessions.el
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">setq</span> session-file <span class="org-string">"~/.emacs.d/lastsession.el"</span>)

(<span class="org-keyword">defun</span> <span class="org-function-name">write-file</span> (filename content)
  (append-to-file content nil filename))


(<span class="org-keyword">defun</span> <span class="org-function-name">make-session-code</span> ()
     (<span class="org-keyword">interactive</span>)
     (format <span class="org-string">"(setq last-session-files '%S)"</span> (remove-if 'null (mapcar 'buffer-file-name  (buffer-list)))))


(<span class="org-keyword">defun</span> <span class="org-function-name">save-session</span> ()
    <span class="org-doc">"Save Current Session"</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">when</span> (file-exists-p session-file) (delete-file session-file))
    (write-file session-file (make-session-code)))


(<span class="org-keyword">defun</span> <span class="org-function-name">load-session</span> ()
  (<span class="org-keyword">interactive</span>)
  (load-file session-file)
  (mapcar 'find-file last-session-files)
)

(message <span class="org-string">"Reloaded"</span>)
</pre>
</div>


<p>
To save all bufffers with files:
</p>

<pre class="example">
M-x load-file ;; Enter session.el
M-x save-session
</pre>


<p>
To reload the files save in the seesion enter:
</p>

<pre class="example">
M-x load-file    ;; Enter session.el
M-x load-session ;; All previous files in the session
                 ;; saved will be opened
</pre>
</div>
</div>

<div id="outline-container-sec-1-18-2" class="outline-4">
<h4 id="sec-1-18-2"><span class="section-number-4">1.18.2</span> Save and Restore Current Window Configuration</h4>
<div class="outline-text-4" id="text-1-18-2">
<p>
Press &lt;F7&gt; to save the curren window configuration and &lt;F8&gt; to restore. The functions can also be executed with A-x save-view or A-x restore-view.
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">save-view</span> ()
  <span class="org-doc">"Save current window configuration"</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">setq</span> winconf  (current-window-configuration))
  (message <span class="org-string">"View Saved - Press to restore"</span>))

(<span class="org-keyword">defun</span> <span class="org-function-name">restore-view</span> ()
  <span class="org-doc">"Restore saved window configuration"</span>
  (<span class="org-keyword">interactive</span>)
  (set-window-configuration winconf)
  (message <span class="org-string">"View loaded"</span>))

(global-set-key (kbd <span class="org-string">"&lt;f7&gt;"</span>)  #'save-view)
(global-set-key (kbd <span class="org-string">"&lt;f8&gt;"</span>)  #'restore-view)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-1-19" class="outline-3">
<h3 id="sec-1-19"><span class="section-number-3">1.19</span> Non categorized</h3>
<div class="outline-text-3" id="text-1-19">
</div><div id="outline-container-sec-1-19-1" class="outline-4">
<h4 id="sec-1-19-1"><span class="section-number-4">1.19.1</span> Save the scratch buffer and reload every Emacs startup</h4>
<div class="outline-text-4" id="text-1-19-1">
<p>
Saves the scratch buffer to a file every times Emacs is closed.
</p>

<p>
Source: <a href="https://gist.github.com/kobapan/034d5123321b32bb68ca">scratch.el</a>
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">setq</span> scratch-buffer-file <span class="org-string">"~/.emacs.d/scratch.el"</span>)

(<span class="org-keyword">setq</span> initial-scratch-message <span class="org-string">""</span>)           <span class="org-comment-delimiter">;</span><span class="org-comment">initial message</span>
(add-hook 'kill-emacs-hook 'scratch-save)   <span class="org-comment-delimiter">;</span>
(add-hook 'window-setup-hook 'scratch-resume)<span class="org-comment-delimiter">;</span>

<span class="org-comment-delimiter">;;  </span><span class="org-comment">window-setup-hook</span>
<span class="org-comment-delimiter">;;  </span><span class="org-comment">@see info 38.1.1 Summary: Sequence of Actions at Startup</span>
(add-hook 'kill-buffer-hook<span class="org-comment-delimiter">; </span><span class="org-comment">*scratch*</span>
          (<span class="org-keyword">lambda</span> ()
            (<span class="org-keyword">if</span> (equal (buffer-name) <span class="org-string">"*scratch*"</span>) (scratch-save))))

(add-hook 'after-save-hook
          (<span class="org-keyword">lambda</span> ()
            (<span class="org-keyword">unless</span> (get-buffer <span class="org-string">"*scratch*"</span>) (scratch-resume))))


(<span class="org-keyword">defun</span> <span class="org-function-name">scratch-save</span> ()
  (<span class="org-keyword">let</span> ((buf (get-buffer <span class="org-string">"*scratch*"</span>)))
    (<span class="org-keyword">when</span> buf
      (set-buffer buf)
      (write-file scratch-buffer-file)
      (<span class="org-keyword">ignore-errors</span> (kill-buffer <span class="org-string">"scratch.el"</span>)))))

(<span class="org-keyword">defun</span> <span class="org-function-name">scratch-resume</span> ()
  <span class="org-doc">"*scratch* "</span>
  (<span class="org-keyword">interactive</span>)
  (set-buffer (get-buffer-create <span class="org-string">"*scratch*"</span>))
  (funcall initial-major-mode)
  (insert-file-contents scratch-buffer-file nil nil nil t)

  (<span class="org-keyword">ignore-errors</span> (kill-buffer <span class="org-string">".scratch"</span>)))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-1-19-2" class="outline-4">
<h4 id="sec-1-19-2"><span class="section-number-4">1.19.2</span> Code Navigation with Occur&#xa0;&#xa0;&#xa0;<span class="tag"><span class="edit">edit</span></span></h4>
<div class="outline-text-4" id="text-1-19-2">
<p>
The function <b>occur</b> is useful for code navigation and scan code
statements, this function is invoked by M-x occur.
</p>

<p>
Examples:
</p>

<p>
The function python/scan-functions will scan for all lines that starts
with def statement in a Python code and show the matching lines in the
right side.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">python/scan-functions</span> ()
  (<span class="org-keyword">interactive</span>)
  (split-window-horizontally)
  (occur <span class="org-string">"def"</span>)
  )
</pre>
</div>

<p>
Example:
</p>


<div class="figure">
<p><img src="images/occur_statement_scan.png" alt="occur_statement_scan.png" />
</p>
</div>


<p>
It can also be useful to Scan code tags like: @FIXME, @TODO, @README,
@NOTE. This fuction can be excuted by typing: <code>M-x scan-code-tags</code>
</p>

<p>
Example:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">scan-code-tags</span> ()
     <span class="org-doc">"</span>
<span class="org-doc">     Scan code tags: @TODO: , @FIXME:, @BUG:, @NOTE:</span>

<span class="org-doc">     "</span>
     (<span class="org-keyword">interactive</span>)
     (split-window-horizontally)
     (occur <span class="org-string">"@FIXME:</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">@TODO:</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">@BUG:</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">@NOTE:"</span>))
</pre>
</div>



<div class="figure">
<p><img src="images/scan_code_tags.png" alt="scan_code_tags.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-sec-1-19-3" class="outline-4">
<h4 id="sec-1-19-3"><span class="section-number-4">1.19.3</span> Quick edit and reload Emacs Configuration File.&#xa0;&#xa0;&#xa0;<span class="tag"><span class="elisp">elisp</span>&#xa0;<span class="customization">customization</span></span></h4>
<div class="outline-text-4" id="text-1-19-3">
<p>
It is useful to quick edit and reload ~/emacs.d/init.el without restart emacs. Those functions can be put in the init.el file.
</p>

<div class="org-src-container">

<pre class="src src-elisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">Usage: M-x reload-init-file</span>
<span class="org-comment-delimiter">;;</span>
(<span class="org-keyword">defun</span> <span class="org-function-name">reload-init-file</span> ()
  <span class="org-doc">"Reload init.el file"</span>
  (<span class="org-keyword">interactive</span>)
  (load user-init-file)
  (message <span class="org-string">"Reloaded init.el OK."</span>)
)

<span class="org-comment-delimiter">;; </span><span class="org-comment">Usage: M-x open-init-file</span>
<span class="org-comment-delimiter">;;</span>
(<span class="org-keyword">defun</span> <span class="org-function-name">open-init-file</span> ()
    (<span class="org-keyword">interactive</span>)
    (find-file user-init-file)
)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-19-4" class="outline-4">
<h4 id="sec-1-19-4"><span class="section-number-4">1.19.4</span> Refresh / Revert buffer without confirmation.</h4>
<div class="outline-text-4" id="text-1-19-4">
<p>
Source: <a href="http://www.emacswiki.org/emacs-en/download/misc-cmds.el">http://www.emacswiki.org/emacs-en/download/misc-cmds.el</a>
</p>


<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">refresh</span> ()
    <span class="org-doc">"Revert buffer without confirmation."</span>
    (<span class="org-keyword">interactive</span>)
    (revert-buffer t t))
</pre>
</div>

<p>
Usage:
</p>

<p>
#+END<sub>SRC</sub>
M-x refresh
#+END<sub>SRC</sub>
</p>
</div>
</div>

<div id="outline-container-sec-1-19-5" class="outline-4">
<h4 id="sec-1-19-5"><span class="section-number-4">1.19.5</span> Create a menu with all color themes available</h4>
<div class="outline-text-4" id="text-1-19-5">

<div class="figure">
<p><img src="images/colortheme_menu.png" alt="colortheme_menu.png" />
</p>
</div>

<p>
<b>Using Eval</b>
</p>

<p>
Copy and paste the code below to the scratch buffer and enter M-x eval-buffer. This code can also be put in ~/emacs.d/init.el, in the config file.
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">eval-string</span> (str) (eval (read str)))

(<span class="org-keyword">defun</span> <span class="org-function-name">make-menu-rows</span> ()
 (mapcar
   (<span class="org-keyword">lambda</span> (x)
      (format <span class="org-string">"[\"%s\" (load-theme '%s)]"</span>  (symbol-name x) (symbol-name x) ))
   (custom-available-themes))
 )


(<span class="org-keyword">defun</span> <span class="org-function-name">make-color-menu-code</span> ()
  (format
   <span class="org-string">"</span>
<span class="org-string">   (easy-menu-define djcb-menu global-map \"Color Themes\"</span>
<span class="org-string">     '(\"Color Themes\"</span>
<span class="org-string">        %s</span>
<span class="org-string">      )</span>
<span class="org-string">   )</span>
<span class="org-string">   "</span>
  (mapconcat 'identity (make-menu-rows) <span class="org-string">"\n"</span>)

  ) <span class="org-comment-delimiter">;; </span><span class="org-comment">End of format</span>
) <span class="org-comment-delimiter">;; </span><span class="org-comment">End of make-color-menu</span>



<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">"Eval is evil". It must be avoided, because, it is hard to refactor,</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">hard to debug and vulnerable to code injection on Web Apps, so a better</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">way to write it is to use Elisp macros.</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">@DONE: Change eval-string to an Elisp macro.</span>
<span class="org-comment-delimiter">;;</span>
(eval-string (make-color-menu-code))
</pre>
</div>

<p>
<b>Using Macros</b>
</p>

<p>
Developement:
</p>

<div class="org-src-container">

<pre class="src src-elisp">ELISP&gt; (custom-available-themes)
(cyberpunk adwaita deeper-blue dichromacy leuven light-blue manoj-dark misterioso tango-dark tango tsdh-dark tsdh-light wheatgrass whiteboard wombat)

ELISP&gt; (mapcar
        (<span class="org-keyword">lambda</span> (sym) `[,(symbol-name sym) (load-theme (<span class="org-keyword">quote</span> ,sym))])
        (custom-available-themes)
    )
([<span class="org-string">"adwaita"</span>
  (load-theme 'adwaita)]
 [<span class="org-string">"deeper-blue"</span>
  (load-theme 'deeper-blue)]
 [<span class="org-string">"dichromacy"</span>
  (load-theme 'dichromacy)]
 [<span class="org-string">"leuven"</span>
  (load-theme 'leuven)]
 [<span class="org-string">"light-blue"</span>
  (load-theme 'light-blue)]
 [<span class="org-string">"manoj-dark"</span>
  (load-theme 'manoj-dark)]
 [<span class="org-string">"misterioso"</span>
  (load-theme 'misterioso)]
 [<span class="org-string">"tango-dark"</span>
  (load-theme 'tango-dark)]
  ...

ELISP&gt;  (<span class="org-keyword">defun</span> <span class="org-function-name">make-menu-rows</span> ()
          (mapcar
        (<span class="org-keyword">lambda</span> (sym) `[,(symbol-name sym) (load-theme (<span class="org-keyword">quote</span> ,sym))])
        (custom-available-themes)))
make-menu-rows
ELISP&gt;
ELISP&gt; (make-menu-rows)
([<span class="org-string">"adwaita"</span>
  (load-theme 'adwaita)]
 [<span class="org-string">"deeper-blue"</span>
  (load-theme 'deeper-blue)]
 [<span class="org-string">"dichromacy"</span>
  (load-theme 'dichromacy)]
 [<span class="org-string">"leuven"</span>
  (load-theme 'leuven)]
  ...


ELISP&gt; `(<span class="org-keyword">easy-menu-define</span> djcb-menu global-map <span class="org-string">"Color Themes"</span>
          '(<span class="org-string">"Color Themes"</span>
           ,@(make-menu-rows)))
(<span class="org-keyword">easy-menu-define</span> djcb-menu global-map <span class="org-string">"Color Themes"</span>
  '(<span class="org-string">"Color Themes"</span>
    [<span class="org-string">"adwaita"</span>
     (load-theme 'adwaita)]
    [<span class="org-string">"deeper-blue"</span>
     (load-theme 'deeper-blue)]
    [<span class="org-string">"dichromacy"</span>
     (load-theme 'dichromacy)]
    [<span class="org-string">"leuven"</span>
     (load-theme 'leuven)]
    [<span class="org-string">"light-blue"</span>
     (load-theme 'light-blue)]
     ...

<span class="org-comment-delimiter">;;; </span><span class="org-comment">Now execute the generated code, the menu will pop up.</span>
<span class="org-comment-delimiter">;;;</span>

ELISP&gt; (eval `(<span class="org-keyword">easy-menu-define</span> djcb-menu global-map <span class="org-string">"Color Themes"</span>
          '(<span class="org-string">"Color Themes"</span>
           ,@(make-menu-rows))))
nil
</pre>
</div>

<p>
Final code
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">make-menu-rows</span> ()
          (mapcar
        (<span class="org-keyword">lambda</span> (sym) `[,(symbol-name sym) (load-theme (<span class="org-keyword">quote</span> ,sym))])
        (custom-available-themes)))


(<span class="org-keyword">defmacro</span> <span class="org-function-name">make-color-menu</span> ()
  `(<span class="org-keyword">easy-menu-define</span> djcb-menu global-map <span class="org-string">"Color Themes"</span>
     '(<span class="org-string">"Color Themes"</span>
       ,@(make-menu-rows))))

(make-color-menu)

<span class="org-comment-delimiter">;;;;; </span><span class="org-comment">Or copy and paste the following  block on IELM shell</span>

(<span class="org-keyword">progn</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">make-menu-rows</span> ()
              (mapcar
            (<span class="org-keyword">lambda</span> (sym) `[,(symbol-name sym) (load-theme (<span class="org-keyword">quote</span> ,sym))])
            (custom-available-themes)))


    (<span class="org-keyword">defmacro</span> <span class="org-function-name">make-color-menu</span> ()
      `(<span class="org-keyword">easy-menu-define</span> djcb-menu global-map <span class="org-string">"Color Themes"</span>
         '(<span class="org-string">"Color Themes"</span>
           ,@(make-menu-rows))))

    (make-color-menu)
)


<span class="org-comment-delimiter">;;;; </span><span class="org-comment">Testing the macro expansion</span>

ELISP&gt; (macroexpand '(make-color-menu))
(<span class="org-keyword">progn</span>
  (<span class="org-keyword">defvar</span> <span class="org-variable-name">djcb-menu</span> nil <span class="org-doc">"Color Themes"</span>)
  (easy-menu-do-define 'djcb-menu global-map <span class="org-string">"Color Themes"</span>
               '(<span class="org-string">"Color Themes"</span>
             [<span class="org-string">"adwaita"</span>
              (load-theme 'adwaita)]
             [<span class="org-string">"deeper-blue"</span>
              (load-theme 'deeper-blue)]
             [<span class="org-string">"dichromacy"</span>
              (load-theme 'dichromacy)]
             [<span class="org-string">"leuven"</span>
              (load-theme 'leuven)]
             [<span class="org-string">"light-blue"</span>
              (load-theme 'light-blue)]
            ...
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> IELM - Inferior Emacs Lisp Mode</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1"><span class="section-number-3">2.1</span> Change Prompt</h3>
<div class="outline-text-3" id="text-2-1">
<p>
Change the default IELM prompt "ELISP&gt; " to "&gt; ".
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">setq</span>  ielm-prompt <span class="org-string">"&gt; "</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2"><span class="section-number-3">2.2</span> Clear IELM shell</h3>
<div class="outline-text-3" id="text-2-2">
<p>
Clear IELM buffer. Usage: M-x ielm/clear
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">ielm/clear</span> ()
  <span class="org-doc">"Clear IELM buffer."</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">with-current-buffer</span> <span class="org-string">"*ielm*"</span>
      (<span class="org-keyword">let</span> ((inhibit-read-only t))
        (erase-buffer))))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3"><span class="section-number-3">2.3</span> Send Region to IELM</h3>
<div class="outline-text-3" id="text-2-3">
<p>
Send selected text (region) to IELM and print the output.
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">ielm/send-region</span> ()
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">let</span> ((text (buffer-substring-no-properties (region-beginning)
                                              (region-end))))
    (<span class="org-keyword">with-current-buffer</span> <span class="org-string">"*ielm*"</span>
      (insert text)
      (ielm-send-input))))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2-4" class="outline-3">
<h3 id="sec-2-4"><span class="section-number-3">2.4</span> Set other window's buffer as working buffer</h3>
<div class="outline-text-3" id="text-2-4">
<p>
Usage: <code>M-x ielm-select-buffer-other-window</code>
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">ielm-select-buffer-other-window</span> ()
  <span class="org-doc">"Select other window' buffer as IELM's working buffer."</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">let</span> ((buf (<span class="org-keyword">save-window-excursion</span>
               (other-window 1)
               (current-buffer))))
    (ielm-change-working-buffer buf)
    (ielm-print-working-buffer)))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2-5" class="outline-3">
<h3 id="sec-2-5"><span class="section-number-3">2.5</span> Start IELM in other window setting the working buffer to current buffer</h3>
<div class="outline-text-3" id="text-2-5">
<p>
This command starts IELM in other window setting the working buffer to
current buffer. It allows the user to manipulate the current buffer.
</p>

<p>
Usage: M-x ielm-this-buffer
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">ielm-this-buffer</span> ()
  <span class="org-doc">"Start IELM in other window with current buffer set to current windows' buffer."</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">let</span> ((buf (current-buffer)))
    (ielm-other-window)
    (ielm-change-working-buffer buf)
    (ielm-print-working-buffer)))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2-6" class="outline-3">
<h3 id="sec-2-6"><span class="section-number-3">2.6</span> Launch IELM in other frame</h3>
<div class="outline-text-3" id="text-2-6">
<p>
Usage: M-x ielm-other-frame
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">ielm-other-frame</span> ()
  <span class="org-doc">"Launch IELM in other frame."</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">with-selected-frame</span> (make-frame)
    (ielm)))
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> Emacs Server and Client</h2>
<div class="outline-text-2" id="text-3">
<p>
See also:
</p>

<ul class="org-ul">
<li><a href="https://www.emacswiki.org/emacs/EmacsClient">https://www.emacswiki.org/emacs/EmacsClient</a>
</li>
</ul>


<ul class="org-ul">
<li><a href="https://www.emacswiki.org/emacs/EmacsAsDaemon">https://www.emacswiki.org/emacs/EmacsAsDaemon</a>
</li>
</ul>


<ul class="org-ul">
<li><a href="http://mjwall.com/blog/2013/10/04/how-i-use-emacs/">How I Use Emacs - mjwall.com</a>
</li>
</ul>


<ul class="org-ul">
<li><a href="http://www.tychoish.com/posts/running-multiple-emacs-daemons-on-a-single-system/">Running Multiple Emacs Daemons on a Single System</a>
</li>
</ul>


<ul class="org-ul">
<li><a href="http://blog.refu.co/?p=1296">Running emacs as a daemon with systemd</a>
</li>
</ul>


<ul class="org-ul">
<li><a href="http://emacs-fu.blogspot.com.br/2009/02/emacs-daemon.html">http://emacs-fu.blogspot.com.br/2009/02/emacs-daemon.html</a>
</li>
</ul>


<ul class="org-ul">
<li><a href="https://wiki.archlinux.org/index.php/Emacs">https://wiki.archlinux.org/index.php/Emacs</a>
</li>
</ul>


<ul class="org-ul">
<li><a href="https://gist.github.com/nicferrier/1323512">Doing worker processing with EmacsLisp</a>
</li>

<li><a href="http://nic.ferrier.me.uk/blog/2012_07/emacs-packages-for-programmers">Packages for Emacs Programmers</a>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> Org-mode</h2>
<div class="outline-text-2" id="text-4">
</div><div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1"><span class="section-number-3">4.1</span> Code Block Templates</h3>
<div class="outline-text-3" id="text-4-1">
<p>
When the user writes '&lt;p'in org-mode and hits tab key it expands to a
python source code block like this:
</p>

<div class="org-src-container">

<pre class="src src-org"><span class="org-org-block-begin-line">#+BEGIN_SRC python :results value</span>

<span class="org-org-block-end-line">#+END_SRC</span>
</pre>
</div>


<p>
Elisp code:
</p>

<div class="org-src-container">

<pre class="src src-elisp">(add-to-list 'org-structure-template-alist
             '(<span class="org-string">"p"</span> <span class="org-string">"#+BEGIN_SRC python :results ?value\n\n#+END_SRC"</span>))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-2" class="outline-3">
<h3 id="sec-4-2"><span class="section-number-3">4.2</span> Custom Protocols</h3>
<div class="outline-text-3" id="text-4-2">
</div><div id="outline-container-sec-4-2-1" class="outline-4">
<h4 id="sec-4-2-1"><span class="section-number-4">4.2.1</span> Open directory with dired mode</h4>
<div class="outline-text-4" id="text-4-2-1">
<p>
Org-mode already provides the protocol <code>file:&lt;filename&gt;</code> to open a
directory or file. The motivation to implement this protocol is that it
is unambiguous like file protocol and easy to search.
</p>

<p>
Hyperlink syntax:  <code>dir:&lt;file-path&gt;</code>
</p>


<div class="org-src-container">

<pre class="src src-elisp">(add-hook 'org-mode-hook
          (<span class="org-keyword">lambda</span> ()
              (org-add-link-type <span class="org-string">"dir"</span> #'dired nil)
              ))
</pre>
</div>


<p>
Org-mode file example:
</p>

<pre class="example">
Log directory      -  dir:/var/log  -  [[dir:/var/log][Log directory]]

System cofiguration - dir:/etc
</pre>
</div>
</div>


<div id="outline-container-sec-4-2-2" class="outline-4">
<h4 id="sec-4-2-2"><span class="section-number-4">4.2.2</span> Open directory with system file manager</h4>
<div class="outline-text-4" id="text-4-2-2">
<p>
Hyperlink format: <code>dire:&lt;directory-path&gt;</code>
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defvar</span> <span class="org-variable-name">default-file-manager-app</span> <span class="org-string">"pcmanfm-qt"</span>)

(<span class="org-keyword">defun</span> <span class="org-function-name">org/protocol-dire</span> (input)
  (start-process  <span class="org-string">"proc"</span> <span class="org-comment-delimiter">;; </span><span class="org-comment">Process name</span>
                  nil    <span class="org-comment-delimiter">;; </span><span class="org-comment">Buffer name</span>

                  default-file-manager
                  input
                  ))

(add-hook 'org-mode-hook
          (<span class="org-keyword">lambda</span> ()
              (org-add-link-type <span class="org-string">"dire"</span> #'org/protocol-dire nil)
              ))
</pre>
</div>

<p>
Example:
</p>

<pre class="example">
To open the directory file:/var/log in the system file
manager click on the hyperlink bellow.


 - Hyperlink1:   dire:/var/log

 - Hyperlink2:   [[dire:/var/log][System Log directory]]
</pre>



<div class="figure">
<p><img src="images/org-mode-protocol-file-manager.png" alt="org-mode-protocol-file-manager.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-sec-4-2-3" class="outline-4">
<h4 id="sec-4-2-3"><span class="section-number-4">4.2.3</span> Man page</h4>
<div class="outline-text-4" id="text-4-2-3">
<p>
Provides a hyperlink that displays a man page when clicked.
</p>


<div class="org-src-container">

<pre class="src src-elisp">(add-hook 'org-mode-hook
          (<span class="org-keyword">lambda</span> ()
                 (org-add-link-type  <span class="org-string">"man"</span> #'woman nil)))
</pre>
</div>

<p>
Example:
</p>

<p>
file test.org
</p>

<pre class="example">
Click on the hyperlinks bellow to open the man pages:

Gcc Man Page:

 - man:gcc

C-function cbrt Man Page

 - man:cbrt

 - [[man:cbrt][C-function cbrt Man Page]]
</pre>
</div>
</div>

<div id="outline-container-sec-4-2-4" class="outline-4">
<h4 id="sec-4-2-4"><span class="section-number-4">4.2.4</span> Elisp Documentation</h4>
<div class="outline-text-4" id="text-4-2-4">
<p>
Provides clickable link that shows the the Elisp documentation.
</p>

<p>
A link of format <code>elisp-doc:add-hook</code> will show the <code>add-hook</code>
documentation when clicked.
</p>

<p>
Hyperlink format:  <code>elisp-doc:&lt;function-name&gt;</code> or <code>[elisp-doc:&lt;function-name&gt;]</code>
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">org/protocol-elisp-doc</span> (function-symbol)
  (princ function-symbol)
  (describe-function (intern-soft function-symbol))

  )


(<span class="org-keyword">defun</span> <span class="org-function-name">org/protocol-elisp-doc-html</span> (path desc backend)
   (<span class="org-keyword">cl-case</span> backend
     (html (format
            <span class="org-string">"&lt;a href='' title='%s'&gt;%s&lt;/a&gt;"</span>
            (documentation (intern-soft path))
            (<span class="org-keyword">or</span> desc path)))))


(add-hook 'org-mode-hook

          (<span class="org-keyword">lambda</span> ()

            (org-add-link-type <span class="org-string">"elisp-doc"</span> #'org/protocol-elisp-doc #'org/protocol-elisp-doc-html)
            ))
</pre>
</div>

<p>
Example:
</p>

<p>
file: <code>/tmp/test.org</code>
</p>

<div class="org-src-container">

<pre class="src src-org-mode">Elisp documentation protocol:

[[elisp-doc:add-hook][Function Add hook]]

The function elisp-doc:start-process is used to start an asynchronous process.
</pre>
</div>


<p>
This screenshot show what happens when the user clicks in the hyperlink.
</p>


<div class="figure">
<p><img src="images/elisp-doc-org-mode-protocol-click.png" alt="elisp-doc-org-mode-protocol-click.png" />
</p>
</div>

<p>
Exported to html with: <code>M-x org-html-export-to-html</code>
</p>


<div class="figure">
<p><img src="images/elisp-doc-org-mode-protocol.png" alt="elisp-doc-org-mode-protocol.png" />
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-4-3" class="outline-3">
<h3 id="sec-4-3"><span class="section-number-3">4.3</span> Settings</h3>
<div class="outline-text-3" id="text-4-3">
</div><div id="outline-container-sec-4-3-1" class="outline-4">
<h4 id="sec-4-3-1"><span class="section-number-4">4.3.1</span> General Settings</h4>
<div class="outline-text-4" id="text-4-3-1">
<p>
Syntax highlight for code blocks  <code>#+BEGIN_SRC .. #+END_SRC</code>
</p>

<div class="org-src-container">

<pre class="src src-elisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">Syntax highlight for code blocks  #+BEGIN_SRC .. #+END_SRC</span>
<span class="org-comment-delimiter">;;</span>
(<span class="org-keyword">setq</span> org-src-fontify-natively t)
</pre>
</div>

<p>
Syntax highlight for latex fragments
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">setq</span> org-highlight-latex-and-related '(latex script entities))
</pre>
</div>
</div>
</div>


<div id="outline-container-sec-4-3-2" class="outline-4">
<h4 id="sec-4-3-2"><span class="section-number-4">4.3.2</span> Code Block - Org-babel</h4>
<div class="outline-text-4" id="text-4-3-2">
<p>
Enable source code block in org files
</p>

<div class="org-src-container">

<pre class="src src-elisp">(org-babel-do-load-languages
 'org-babel-load-languages
 '((emacs-lisp . t)
   (sh . t)
   (python . t)
   (scheme . t)
   (lisp . t)
   (clojure . t)
   (R . t)
   (latex . t)
   (ruby . t)
   (C . t)
   <span class="org-comment-delimiter">;;; </span><span class="org-comment">(C++ . t)</span>
   (ditaa . t)
   (haskell . t)
 <span class="org-comment-delimiter">;;  </span><span class="org-comment">(fsharp . t)</span>
 <span class="org-comment-delimiter">;;  </span><span class="org-comment">(java . t)</span>
 <span class="org-comment-delimiter">;;  </span><span class="org-comment">(scala . t)</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">(javascript . t)</span>
   (maxima . t)
  ))
</pre>
</div>


<p>
Disable Security confirmation:
</p>

<div class="org-src-container">

<pre class="src src-elisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">Disable security confirmations</span>
<span class="org-comment-delimiter">;;</span>

(<span class="org-keyword">setq</span>   <span class="org-comment-delimiter">;; </span><span class="org-comment">Confirmation for running coide blocks</span>
        org-confirm-babel-evaluate      nil
        <span class="org-comment-delimiter">;; </span><span class="org-comment">Confirmation for elisp links</span>
        org-confirm-elisp-link-function nil
        <span class="org-comment-delimiter">;; </span><span class="org-comment">Confirmation for shell links</span>
        org-confirm-shell-link-function nil

        org-export-babel-evaluate       nil
        )
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> Selected Gists and Source Codes</h2>
<div class="outline-text-2" id="text-5">
</div><div id="outline-container-sec-5-1" class="outline-3">
<h3 id="sec-5-1"><span class="section-number-3">5.1</span> Gists</h3>
<div class="outline-text-3" id="text-5-1">
<ul class="org-ul">
<li><a href="https://gist.github.com/justinabrahms/1390864">extract archives from eshell</a>
</li>
</ul>


<ul class="org-ul">
<li><a href="https://gist.github.com/garaud/06b38554103aa7120337">garaud/pipe-to-emacs.py</a> - Pipe to Emacs: Insert a result from an
UNIX command into a new Emacs buffer
</li>
</ul>


<ul class="org-ul">
<li><a href="https://gist.github.com/dvnmk/c76105bf0eb5a73565ca">dvnmk/process</a> - Play youtube playlist using Emacs + mpv player.
</li>
</ul>


<ul class="org-ul">
<li><a href="https://gist.github.com/TikhonJelvis/b921933b437d6502c3ff">TikhonJelvis/epage</a> - "A little pager script I wrote that calls out to emacsclient."
</li>
</ul>


<ul class="org-ul">
<li><a href="https://gist.github.com/rosarinjroy/2417726">Elisp code to create
a rails console </a>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-5-2" class="outline-3">
<h3 id="sec-5-2"><span class="section-number-3">5.2</span> Source Codes</h3>
<div class="outline-text-3" id="text-5-2">
<ul class="org-ul">
<li><a href="https://www.emacswiki.org/emacs/download/install-elisp.el">https://www.emacswiki.org/emacs/download/install-elisp.el</a>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2017-01-20 sex 22:45</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 25.1.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
